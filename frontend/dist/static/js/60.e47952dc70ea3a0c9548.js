webpackJsonp([60],{1520:function(e,t,a){var i=a(1521);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(456)("027b11d9",i,!0,{})},1521:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroComdiario.vue",sourceRoot:""}])},1522:function(e,t,a){"use strict";function i(e){a(1523)}var o=a(973),r=a(1525),n=a(1),l=i,s=n(o.a,r.a,!1,l,"data-v-1db02c43",null);t.a=s.exports},1523:function(e,t,a){var i=a(1524);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(456)("7fa1018b",i,!0,{})},1524:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"CuentaAutocomplete.vue",sourceRoot:""}])},1525:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:e.isRequired?"":"required",expression:"isRequired ? '' : 'required'"}],attrs:{label:e.cuenta.item.id?e.titleLabel:"Buscar "+e.titleLabel,items:e.cuenta.items,"item-text":"nombre",hint:e.cuenta.item.id?"Código: "+e.cuenta.item.codigo:"","search-input":e.cuenta.search,"persistent-hint":"",name:e.titleLabel,required:!e.isRequired,"error-messages":e.errors.collect(e.titleLabel),filter:e.cuenta.filter,color:"primary",loading:e.cuenta.isLoading,placeholder:"Comience a escribir para buscar","no-data-text":"Busqueda por código o nombre","return-object":""},on:{"update:searchInput":function(t){return e.$set(e.cuenta,"search",t)},"update:search-input":function(t){return e.$set(e.cuenta,"search",t)}},scopedSlots:e._u([{key:"item",fn:function(t){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre?t.item.nombre:"")}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.codigo?t.item.codigo:"")}})],1)]]}}]),model:{value:e.cuenta.item,callback:function(t){e.$set(e.cuenta,"item",t)},expression:"cuenta.item"}})},o=[],r={render:i,staticRenderFns:o};t.a=r},1526:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-text",{staticClass:"title font-weight-light"},[e._v("¿Esta seguro que desea confirmar el comprobante?")]),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(t){return e.confirmarEstado()}}},[e._v("No")]),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return t.stopPropagation(),e.confirmarEstado("yesConfirmar")}}},[e._v("Si")])],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:e.dialog2,callback:function(t){e.dialog2=t},expression:"dialog2"}},[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3"},[a("span",{staticClass:"title"},[e._v("¿Qué desea hacer?")])]),e._v(" "),a("v-container",{attrs:{fluid:""}},[a("v-layout",{staticClass:"justify-center",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-checkbox",{staticClass:"shrink mr-2",attrs:{color:"teal","off-icon":"done","on-icon":"done_all",default:"",value:"Confirmado"==e.comDiario.estado,disabled:"Anulado"==e.comDiario.estado,label:"Anulado"!=e.comDiario.estado?"Confirmar":"Anulado","hide-details":""},model:{value:e.confirmar,callback:function(t){e.confirmar=t},expression:"confirmar"}})],1),e._v(" "),a("v-flex",{attrs:{xs4:""}},[null!=e.comDiario.id?a("v-checkbox",{staticClass:"shrink mr-2",attrs:{color:"black","off-icon":"far fa-file-pdf","on-icon":"far fa-file-pdf","hide-details":"",label:"Imprimir"},model:{value:e.imprime,callback:function(t){e.imprime=t},expression:"imprime"}}):e._e()],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return e.enviarCambio()}}},[e._v("Aceptar")])],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:e.dialog3,callback:function(t){e.dialog3=t},expression:"dialog3"}},[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3"},[a("v-card-text",{staticClass:"title"},[e._v("¿Por qué anula este comprobante?")])],1),e._v(" "),a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{outline:"",color:"primary",name:"Detalle de anulación"},model:{value:e.detalle_anulacion,callback:function(t){e.detalle_anulacion=t},expression:"detalle_anulacion"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v("\n                    Detalle de anulación\n                  ")])])],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return e.esAnulado(e.comDiario,e.detalle_anulacion)}}},[e._v("Enviar")])],1)],1)],1)],1),e._v(" "),a("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[a("v-toolbar-title",[e._v(" "+e._s(e.tapTitulo)+" ")]),e._v("  \n        "),e._v(" "),a("v-spacer"),e._v(" "),null!=e.comDiario.id?a("h2",{staticClass:"title"},[e._v("Comprobante de Diario")]):e._e(),e._v(" "),null!=e.comDiario.id?a("div",[a("v-chip",{attrs:{label:"",color:"white","text-color":"red",dark:"",absolute:"",right:"",top:""}},[a("span",{staticClass:"subheading"},[e._v("N°")]),e._v(" \n            "),a("span",{staticClass:"subheading",domProps:{textContent:e._s(null==e.comDiario.consecutivo?"00":e.comDiario.consecutivo)}})]),e._v(" "),a("v-chip",{attrs:{color:e.colorEstado,"text-color":"white"}},[a("v-avatar",[a("v-icon",{domProps:{textContent:e._s(e.iconoEstado)}})],1),e._v("\n            "+e._s(e.comDiario.estado)+"\n          ")],1)],1):e._e()],1),e._v(" "),a("v-container",{staticClass:"pt-2 pb-2",attrs:{fluid:"","grid-list-md":"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-card",[a("v-form",{attrs:{"data-vv-scope":"formPrincipal"}},[a("v-container",{attrs:{fluid:"","grid-list-md":"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md5:"",lg5:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Tipo de Comprobante",items:e.complementosFormComDiario.tipcomdiarios,"item-value":"id","item-text":"nombre",name:"tipo de comprobante",required:"","error-messages":e.errors.collect("tipo de comprobante"),autocomplete:"",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},scopedSlots:e._u([{key:"item",fn:function(t){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}})],1)]]}}]),model:{value:e.comDiario.nf_tipcomdiario_id,callback:function(t){e.$set(e.comDiario,"nf_tipcomdiario_id",t)},expression:"comDiario.nf_tipcomdiario_id"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md2:"",lg2:""}},[a("input-date",{directives:[{name:"validate",rawName:"v-validate",value:"required|fechaValida|date_format:YYYY-MM-DD",expression:"'required|fechaValida|date_format:YYYY-MM-DD'"}],key:"fecha",attrs:{label:"Fecha",placeholder:"YYYY-MM-DD",format:"YYYY-MM-DD",name:"fecha","error-messages":e.errors.collect("fecha"),readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},model:{value:e.comDiario.fecha,callback:function(t){e.$set(e.comDiario,"fecha",t)},expression:"comDiario.fecha"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md5:"",lg5:""}},[a("v-text-field",{attrs:{label:"Documento",name:"documento",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},model:{value:e.comDiario.documento,callback:function(t){e.$set(e.comDiario,"documento",t)},expression:"comDiario.documento"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-textarea",{attrs:{color:"primary",name:"observaciones","auto-grow":"",rows:"1",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},model:{value:e.comDiario.detalle,callback:function(t){e.$set(e.comDiario,"detalle",t)},expression:"comDiario.detalle"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v("\n                          Observaciones\n                        ")])])],1)],1)],1)],1),e._v(" "),a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"text-xs-right pt-0",attrs:{xs12:"",sm12:"",md12:"",lg12:""}},["Registrado"===e.comDiario.estado||null===e.comDiario.estado?a("v-btn",{staticClass:"mr-0",attrs:{small:"",color:"primary",dark:""},domProps:{textContent:e._s("Agregar Detalle")},on:{click:function(t){e.cardDialog=!e.cardDialog}}}):e._e(),e._v(" "),a("v-dialog",{attrs:{width:"1000px",persistent:""},model:{value:e.cardDialog,callback:function(t){e.cardDialog=t},expression:"cardDialog"}},[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3"},[a("span",{staticClass:"title"},[e._v(e._s(e.tituloDetalle)+" ")])]),e._v(" "),a("v-form",{attrs:{"data-vv-scope":"formDetalleComdiario"}},[a("v-container",{attrs:{fluid:"","grid-list-md":"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg6:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"cuenta auxiliar",ref:"buscarCuenta",attrs:{"no-data":"Busqueda por código o nombre.",hint:"codigo","item-text":"nombre","data-title":"codigo","data-subtitle":"nombre",scope:"formDetalleComdiario",label:(null===e.detalle.nf_niif_id?"c":"C")+"uenta auxiliar",entidad:"niifs","route-params":"nivel:auxiliar=1",preicon:"local_atm",required:"",name:"cuenta auxiliar","error-messages":e.errors.collect("cuenta auxiliar"),noBtnCreate:"","min-characters-search":2,clearable:"Registrado"===e.comDiario.estado||null===e.comDiario.estado,readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},on:{changeid:function(t){return e.detalle.nf_niif_id=t}},model:{value:e.detalle.niif,callback:function(t){e.$set(e.detalle,"niif",t)},expression:"detalle.niif"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg6:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:e.detalle.nf_niif_id&&e.detalle.niif.maneja_tercero?"required":"",expression:"detalle.nf_niif_id ? (detalle.niif.maneja_tercero ? 'required' : '') : ''"}],key:"tercero",ref:"postulaTercero",attrs:{"no-data":"Busqueda por nombre o número de documento.",hint:"identificacion","item-text":"nombre_completo","data-title":"identificacion","data-subtitle":"nombre_completo",scope:"formDetalleComdiario",label:(null===e.detalle.gn_tercero_id?"t":"T")+"ercero",entidad:"terceros",preicon:"person",disabled:e.detalle.nf_niif_id?!e.detalle.niif.maneja_tercero:!e.detalle.nf_niif_id,name:"tercero","error-messages":e.errors.collect("tercero"),noBtnCreate:"","min-characters-search":2,clearable:"Confirmado"!==e.comDiario.estado&&"Anulado"!==e.comDiario.estado,readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},on:{changeid:function(t){return e.detalle.gn_tercero_id=t}},model:{value:e.detalle.tercero,callback:function(t){e.$set(e.detalle,"tercero",t)},expression:"detalle.tercero"}})],1),e._v(" "),(e.detalle.niif?"Retencion"===e.detalle.niif.tipo:null)?a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-slide-y-transition",[(e.detalle.niif?"Retencion"===e.detalle.niif.tipo:null)?[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3 pt-2 pb-2"},[a("span",{staticClass:"subheading font-weight-medium"},[e._v("Concepto de Retención ")])]),e._v(" "),a("v-container",{staticClass:"pt-2",attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",xl12:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"concepto de retención",attrs:{label:"Concepto de Retención",items:e.complementosFormComDiario.conrtfs,"item-value":"id","item-text":"nombre",name:"concepto de retención",required:!!e.detalle.niif&&"Retencion"===e.detalle.niif.tipo,"return-object":"","error-messages":e.errors.collect("concepto de retención")},on:{input:e.calcularRetencion,change:function(t){return e.detalle.nf_conrtf_id=t?t.id:null}},scopedSlots:e._u([{key:"item",fn:function(t){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}})],1)]]}}],null,!1,3069282642),model:{value:e.detalle.conrtf,callback:function(t){e.$set(e.detalle,"conrtf",t)},expression:"detalle.conrtf"}})],1),e._v(" "),a("v-flex",{attrs:{xs6:"",sm6:"",md4:"",xl4:""}},[a("v-text-field",{attrs:{readonly:"",value:e.detalle.conrtf?e.detalle.conrtf.porcentaje:null,suffix:"%",label:"Porcentaje"}})],1),e._v(" "),a("v-flex",{attrs:{xs6:"",sm6:"",md4:"",lg4:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"valor base",attrs:{prefix:"$",type:"number","success-messages":e.porcentajeRTF>0&&null!=e.porcentajeRTF?"Se aplicara "+e.porcentajeRTF+"% de retención en la fuente":"","persistent-hint":"",hint:e.porcentajeRTF>0&&null!=e.porcentajeRTF?"Se aplica "+e.porcentajeRTF+"% de retención en la fuente":"",name:"valor base",required:e.detalle.nf_niif_id&&e.detalle.niif?"Retencion"==e.detalle.niif.tipo:null,"error-messages":e.errors.collect("campo valor base"),label:"Valor base",min:"0"},on:{keyup:e.calcularRetencion},model:{value:e.detalle.retencion,callback:function(t){e.$set(e.detalle,"retencion",e._n(t))},expression:"detalle.retencion"}})],1),e._v(" "),a("v-flex",{attrs:{xs6:"",sm6:"",md4:"",xl4:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"valor retención",attrs:{prefix:"$",label:"Valor retención",value:e._f("numberFormat")(e.valorRetencion,2),required:"",readonly:"",name:"valor retención","error-messages":e.errors.collect("valor retención")}})],1)],1)],1)],1)]:e._e()],2)],1):e._e(),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg6:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Centro de Costo",items:e.complementosFormComDiario.cencostos,"item-value":"id","item-text":"nombre",name:"centro de costo",required:"",disabled:e.detalle.niif?!e.detalle.niif.maneja_ccosto:"","error-messages":e.errors.collect("centro de costo"),"return-object":"",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado,clearable:"Confirmado"!==e.comDiario.estado&&"Anulado"!==e.comDiario.estado},on:{change:function(t){return e.detalle.nf_cencosto_id=t?t.id:null}},scopedSlots:e._u([{key:"item",fn:function(t){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}})],1)]]}}]),model:{value:e.detalle.cencosto,callback:function(t){e.$set(e.detalle,"cencosto",t)},expression:"detalle.cencosto"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md3:"",lg3:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"débito",attrs:{prefix:"$",type:"number",name:"débito",required:"",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado,disabled:!!(e.detalle.credito||e.detalle.niif&&"Retencion"==e.detalle.niif.tipo||null==e.detalle.nf_niif_id),"error-messages":e.errors.collect("débito"),label:"Débito",min:"0"},model:{value:e.detalle.debito,callback:function(t){e.$set(e.detalle,"debito",e._n(t))},expression:"detalle.debito"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md3:"",lg3:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"crédito",attrs:{prefix:"$",type:"number",name:"crédito",required:"",readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado,disabled:!!(e.detalle.debito||e.detalle.niif&&"Retencion"==e.detalle.niif.tipo||null==e.detalle.nf_niif_id),"error-messages":e.errors.collect("crédito"),label:"Crédito",min:"0"},model:{value:e.detalle.credito,callback:function(t){e.$set(e.detalle,"credito",e._n(t))},expression:"detalle.credito"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-textarea",{attrs:{color:"primary",name:"observaciones","auto-grow":"",rows:"1",disabled:!e.detalle.nf_niif_id,readonly:"Confirmado"===e.comDiario.estado||"Anulado"===e.comDiario.estado},model:{value:e.detalle.observacion,callback:function(t){e.$set(e.detalle,"observacion",t)},expression:"detalle.observacion"}},[a("div",{attrs:{slot:"label"},slot:"label"},[e._v("Observaciones")])])],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-divider"),e._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(t){return e.dialogDetalle()}}},[e._v("Cerrar")]),e._v(" "),"Registrado"===e.comDiario.estado||null===e.comDiario.estado?a("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:function(t){return e.agregarComdiaDetalle(e.detalle)}}},[e._v(" "+e._s(e.detalle.id?"Actualizar":"Agregar"))]):e._e()],1)],1)],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{"max-width":"400"},model:{value:e.dialogEliminar,callback:function(t){e.dialogEliminar=t},expression:"dialogEliminar"}},[a("v-card",[a("v-card-text",{staticClass:"title font-weight-light"},[e._v("¿Desea eliminar el detalle del comprobante?")]),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(t){e.dialogEliminar=!1}}},[e._v("No")]),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.eliminarDetalle(e.detalle)}}},[e._v("Si")])],1)],1)],1),e._v(" "),e.comDiario.detalles.length?a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-expand-transition",[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3"},[a("h3",[e._v("Detalles del Comprobante")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-data-table",{attrs:{headers:e.headers,items:e.comDiario.detalles,loading:e.tableLoading,pagination:e.pagination,"hide-actions":"","rows-per-page-text":"Registros por página","rows-per-page-items":[5,10,25,{text:"Todos",value:-1}]},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.niif.nombre))]),e._v(" "),a("td",[e._v(e._s(t.item.tercero?t.item.tercero.nombre_completo:""))]),e._v(" "),a("td",[e._v(e._s(t.item.cencosto?t.item.cencosto.nombre:""))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(e._f("numberFormat")(t.item.debito?t.item.debito:"0",2,"$")))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(e._f("numberFormat")(t.item.credito?t.item.credito:"0",2,"$")))]),e._v(" "),a("td",{staticClass:"text-xs-center"},[a("v-btn",{staticClass:"mx-0",attrs:{icon:"",fab:"",small:""},on:{click:function(a){return e.editarDetalle(t.item)}}},[a("v-icon",{attrs:{color:"accent"},domProps:{textContent:e._s("Registrado"===e.comDiario.estado||null===e.comDiario.estado?"edit":"remove_red_eye")}})],1),e._v(" "),"Registrado"===e.comDiario.estado||null===e.comDiario.estado?a("v-btn",{staticClass:"mx-0",attrs:{icon:"",fab:"",small:""},on:{click:function(a){return e.preguntarEliminarDetalle(t.item)}}},[a("v-icon",{attrs:{color:"accent"}},[e._v("delete")])],1):e._e()],1)]}},{key:"pageText",fn:function(t){return[e._v("\n                            "+e._s(t.pageStart)+" - "+e._s(t.pageStop)+" de "+e._s(t.itemsLength)+"\n                          ")]}}],null,!1,2971445361)},[e._v(" "),a("template",{slot:"footer"},[a("tr",{staticClass:"green accent-1",class:{"red lighten-2":0!==e.totalDetalles.sumasIguales}},[a("td"),e._v(" "),a("td"),e._v(" "),a("td",{staticClass:"text-xs-right"},[a("strong",[e._v("Totales $")])]),e._v(" "),a("td",{staticClass:"text-xs-right font-weight-regular"},[e._v("\n                                "+e._s(e._f("numberFormat")(e.totalDetalles.totalDebito,2))+"\n                              ")]),e._v(" "),a("td",{staticClass:"text-xs-right font-weight-regular"},[e._v("\n                                "+e._s(e._f("numberFormat")(e.totalDetalles.totalCredito,2))+"\n                              ")]),e._v(" "),a("td",{staticClass:"text-xs-center font-weight-regular",class:e.totalDetalles.clase},[e._v("\n                                "+e._s(e._f("numberFormat")(e.totalDetalles.sumasIguales,2))+"\n                              ")])])]),e._v(" "),a("template",{slot:"no-data"},[e.tableLoading?a("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n                              Lo sentimos, no tenemos registros para mostrar. "),a("v-icon",[e._v("sentiment_very_dissatisfied")])],1):a("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[e._v("\n                              Estamos cargando los registros. "),a("v-icon",[e._v("sentiment_satisfied_alt")])],1)],1)],2)],1)],1)],1):e._e()],1)],1)],1)],1)],1)],1),e._v(" "),a("v-card",[a("v-divider"),e._v(" "),a("v-card-actions",{staticClass:"grey lighten-4"},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"text-xs-left",attrs:{xs6:""}},[a("v-btn",{on:{click:function(t){return e.refresh(null)}}},[e._v("Limpiar")])],1),e._v(" "),a("v-flex",{staticClass:"text-xs-right",attrs:{xs6:""}},[a("v-btn",{on:{click:function(t){return e.close()}}},[e._v(e._s("Registrado"===e.comDiario.estado||null===e.comDiario.estado?"Cancelar":"Cerrar"))]),e._v(" "),"Registrado"===e.comDiario.estado||null===e.comDiario.estado?a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return t.preventDefault(),e.confirmarSave(t)}}},[e._v("Guardar")]):e._e()],1)],1)],1)],1)],1)},o=[],r={render:i,staticRenderFns:o};t.a=r},491:function(e,t,a){"use strict";function i(e){a(1520)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(972),r=a(1526),n=a(1),l=i,s=n(o.a,r.a,!1,l,"data-v-f0a375fe",null);t.default=s.exports},972:function(e,t,a){"use strict";var i=a(13),o=a.n(i),r=a(14),n=a.n(r),l=a(7),s=a.n(l),c=a(249),d=a.n(c),m=a(40),u=a(248),v=a(12),f=a(59),p=a(1522);t.a={name:"RegistroComdiario",components:{PostuladorV2:function(){return new Promise(function(e){e()}).then(a.bind(null,61))},InputDate:function(){return new Promise(function(e){e()}).then(a.bind(null,253))},Postulador:function(){return a.e(287).then(a.bind(null,747))},CuentaAutocomplete:p.a},props:["parametros"],data:function(){return{comDiario:{},comDiarioEdicion:{id:null,consecutivo:null,nf_tipcomdiario_id:null,fecha:null,detalle:null,estado:null,documento:null,detalles:[]},detalle_anulacion:null,valorRetencion:0,maxDate:this.moment().format("YYYY-MM-DD"),pagination:{},headers:[{text:"Cuenta",align:"left",sortable:!1,value:"nf_comdiario_id",width:"450px"},{text:"Tercero",align:"left",sortable:!1,value:"gn_tercero_id",width:"450px"},{text:"Centro de Costo",align:"left",sortable:!1,value:"nf_cencosto_id"},{text:"Débito",align:"center",sortable:!1,value:"debito",width:"150px"},{text:"Crédito",align:"center",sortable:!1,value:"credito",width:"150px"},{text:"Acciones/Sumatoria",align:"center",sortable:!1,value:"id"}],estados:["Registrado","Confirmado","Anulado"],detalle:{},menuDate:!1,date:null,cardDialog:!1,dialog:!1,dialog2:!1,dialog3:!1,dialogEliminar:!1,registrar:!1,confirmar:!1,imprime:!1,tableLoading:!1,descriptionLimit:60,porcentaje:"",porcentajeRTF:null,totalDetalles:{totalDebito:0,totalCredito:0,sumasIguales:0,clase:null},auxiliar:{}}},watch:{"detalle.niif":function(e){null===e&&(this.formReset(),this.$validator.reset())},"detalle.retencion":function(e){var t=this.detalle.conrtf?this.detalle.conrtf.porcentaje:null;this.valorRetencion=e?e*(t/100):0}},computed:{tituloDetalle:function(){return this.statusComdiario().tituloDetalle+(null!==this.detalle.niif?this.detalle.niif.codigo:"")},tapTitulo:function(){return this.statusComdiario().titulo},complementosFormComDiario:function(){return f.b.getters.complementosFormComDiario},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)},typeObject:function(){return void 0===this.object},computedDateFormatted:function(){return this.formDate(this.comDiario.fecha)},colorEstado:function(){return this.statusComdiario().color},iconoEstado:function(){return this.statusComdiario().icono}},beforeMount:function(){this.refresh(),this.formReset(),this.porcentajeRTF=null,this.sumatoriaDetalles()},mounted:function(){null!==this.parametros.entidad&&this.getRegisto(this.parametros.entidad.id)},methods:{statusComdiario:function(){var e=null,t=null,a=null,i=null;switch(this.comDiario.estado){case"Registrado":e="primary",t="stars",a="En Edición",i="En edición del detalle con cuenta N° ";break;case"Confirmado":e="teal",t="check_circle",a="Visualizando",i="Mostrando detalle con cuenta N° ";break;case"Anulado":e="red",t="remove_circle",a="Visualizando",i="Mostrando detalle con cuenta N° ";break;default:e="primary",t="stars",a="Nuevo Comprobante de Diario",i="Detalle de Comprobante"}return{color:e,icono:t,titulo:a,tituloDetalle:i}},formReset:function(){this.detalle={nf_niif_id:null,nf_comdiario_id:null,gn_tercero_id:null,nf_cencosto_id:null,nf_conrtf_id:null,debito:null,credito:null,retencion:null,conrtf:null,cencosto:null,tercero:null,observacion:null,niif:null}},getRegisto:function(e){var t=this;this.axios.get("comdiarios/"+e).then(function(e){""!==e.data&&(t.comDiario=e.data.data),t.sumatoriaDetalles()}).catch(function(e){t.$store.commit(v.b,{msg:"Hay un error al traer el comprobante de Diario. "+e.response,color:"danger"})})},formDate:function(e){if(!e)return null;var t=e.split("-"),a=d()(t,3);return a[0]+"/"+a[1]+"/"+a[2]},sumatoriaDetalles:function(){var e=0,t=0;this.totalDetalles.clase="green--text",this.comDiario.detalles.forEach(function(a){e+=a.credito,t+=a.debito}),this.totalDetalles.totalDebito=e,this.totalDetalles.totalCredito=t,this.totalDetalles.sumasIguales=e-t,0!==this.totalDetalles.sumasIguales&&(this.totalDetalles.clase="red--text")},editarDetalle:function(e){this.cardDialog=!0,this.detalle=JSON.parse(s()(e))},preguntarEliminarDetalle:function(e){this.dialogEliminar=!0,this.detalle=JSON.parse(s()(e))},eliminarDetalle:function(e){this.dialogEliminar=!1,this.comDiario.detalles.splice(this.comDiario.detalles.indexOf(e),1),this.formReset(),this.sumatoriaDetalles()},calcularRetencion:function(){this.detalle.credito=null,this.porcentajeRTF=null,this.detalle.conrtf&&this.detalle.retencion&&(this.porcentaje=this.obtenerPorcentajeRtf(),this.detalle.credito=this.detalle.retencion*(this.porcentaje/100),this.porcentajeRTF=this.porcentaje)},obtenerPorcentajeRtf:function(){var e=this.detalle.conrtf,t=this.detalle.retencion;return"Base"===e.manejo?e.base_minima<=t?e.porcentaje:0:"Variable"===e.manejo?e.base_minima<=t?e.porcentaje:0:this.ubicarDetalle(t).porcentaje},ubicarDetalle:function(e){var t="";return this.detalle.conrtf.detalles.forEach(function(a){a.activo=!1,e>=a.valor_inicial&&(t=a)}),t},dialogDetalle:function(e){"abrir"===e?this.cardDialog=!0:(this.formReset(),this.$validator.reset(),this.cardDialog=!1)},agregarComdiaDetalle:function(e){var t=this;return n()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.validador("formDetalleComdiario");case 2:if(!a.sent){a.next=8;break}e.id?(t.comDiario.detalles.splice(t.comDiario.detalles.findIndex(function(t){return t.id===e.id}),1),t.comDiario.detalles.push(e)):t.comDiario.detalles.push(e),t.sumatoriaDetalles(),t.formReset(),a.next=9;break;case 8:null===t.detalle.nf_niif_id?t.$store.commit(v.b,{msg:"No se ha seleccionado una cuenta.",color:"error"}):t.detalle.niif.maneja_tercero&&null==t.detalle.gn_tercero_id?t.$store.commit(v.b,{msg:"La cuenta seleccionada maneja tercero.",color:"error"}):t.detalle.niif.maneja_ccosto&&null==t.detalle.nf_cencosto_id?t.$store.commit(v.b,{msg:"La cuenta seleccionada maneja centro de costo.",color:"error"}):"Retencion"===t.detalle.niif.tipo&&null==t.detalle.nf_conrtf_id&&t.$store.commit(v.b,{msg:"La cuenta es de tipo retención.",color:"error"});case 9:case"end":return a.stop()}},a,t)}))()},close:function(){this.formReset(),this.$validator.reset(),this.$store.dispatch(m.c,{contexto:this,itemId:this.parametros.tabOrigin})},refresh:function(){this.$validator.reset(),this.comDiario=JSON.parse(s()(this.comDiarioEdicion))},confirmarSave:function(e){var t=this;return n()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.validador("formPrincipal");case 2:if(e.t1=e.sent,!e.t1){e.next=5;break}e.t1=t.comDiario.detalles>1;case 5:if(e.t0=e.t1,!e.t0){e.next=8;break}e.t0=0===t.totalDetalles.sumasIguales;case 8:if(!e.t0){e.next=12;break}t.dialog2=!0,e.next=13;break;case 12:t.comDiario.detalles.length<2?t.$store.commit(v.b,{msg:"Se debe agregar al menos una cuenta para acreditar y una para debitar",color:"error"}):0!==t.totalDetalles.sumasIguales?t.$store.commit(v.b,{msg:"El total de débito debe ser igual al total de crédito",color:"error"}):t.dialog2=!0;case 13:case"end":return e.stop()}},e,t)}))()},confirmarEstado:function(e){"yesConfirmar"===e?(this.confirmar&&this.imprime?(this.comDiario.estado="Confirmado",this.imprimirComprobante()):this.comDiario.estado="Confirmado",this.dialog=!1,this.dialog2=!1,this.save(),this.$store.commit(v.b,{msg:"El estado del comprobante ha sido Confirmado",color:"success"})):(this.imprime&&this.imprimirComprobante(),this.confirmar=!1,this.dialog=!1,this.dialog2=!1,this.comDiario.estado="Registrado",this.save(),this.$store.commit(v.b,{msg:"El estado del comprobante ha sido Registrado",color:"success"}))},enviarCambio:function(){this.confirmar?this.dialog=!0:this.confirmar&&this.imprime?this.dialog=!0:this.imprime?(this.comDiario.estado="Registrado",this.imprimirComprobante(),this.save()):"Anulado"===this.comDiario.estado?this.dialog3=!0:"Anulado"===this.comDiario.estado&&this.imprime?this.dialog3=!0:(this.comDiario.estado="Registrado",this.save(),this.$store.commit(v.b,{msg:"El estado del comprobante ha sido Registrado",color:"success"}))},esAnulado:function(e,t){this.dialog3=!1,this.dialog2=!1,e.detalle_anulacion=t,this.save()},imprimirComprobante:function(){var e=this;this.dialog2=!1;var t=this.comDiario.id;this.axios.get("reportecomdiarios?id="+t).then(function(e){var t=e.data;window.open(t,"_blank").focus()}).catch(function(t){e.$store.commit(v.b,{msg:"Error al Imprimir. "+t.response,color:"danger"})})},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},save:function(){var e=this;delete this.porcentajeRTF,this.$validator.validateAll().then(function(t){if(t){var a=e.comDiario.id?"editar":"crear";e.axios.post("comdiarios",e.comDiario).then(function(t){e.comDiario.id?e.$store.commit(v.b,{msg:"El comprobante de diario se actualizó correctamente",color:"success"}):e.$store.commit(v.b,{msg:"El comprobante de diario se creó correctamente",color:"success"}),e.$store.commit(u.p,{item:t.data.comdiario,estado:a,key:e.parametros.key}),e.$store.dispatch(m.c,{contexto:e,itemId:e.parametros.tabOrigin})}).catch(function(t){e.$store.commit(v.b,{msg:"Hay un error al guardar el registro. "+t.response.data.errors,color:"danger"})})}})}}}},973:function(e,t,a){"use strict";var i=a(13),o=a.n(i),r=a(14),n=a.n(r),l=a(12);t.a={name:"CuentaAutocomplete",props:["object","label","required","mode","scope"],data:function(){return{cuenta:{item:{id:null},items:[],isLoading:!1,search:null,filter:function(e,t){var a=function(e){return null!=e?e:""},i=a(e.codigo+" "+e.nombre),o=a(t);return i.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1}}}},watch:{"cuenta.item":function(e){e&&e&&this.$emit("change",this.typeObject?e.id:e)},"cuenta.search":function(e){e&&""!==e&&null!==e&&this.buscar()}},computed:{isRequired:function(){return void 0===this.required},titleLabel:function(){return void 0===this.label?"cuenta":this.label},typeObject:function(){return void 0===this.object}},methods:{reset:function(){this.$validator.reset(),this.cuenta.showContent=!1,this.cuenta.items=[],this.cuenta.search=null,this.cuenta.item={id:null}},assign:function(e){this.reset(),this.cuenta.item=e,this.cuenta.items.push(e)},buscar:window.lodash.debounce(function(){var e=this;this.cuenta.isLoading=!0,this.axios.get("niifs/auxiliares/search/"+this.cuenta.search).then(function(t){console.log(t.data),t.data.data.length>0&&(e.cuenta.items=t.data.data),e.cuenta.isLoading=!1}).catch(function(t){e.cuenta.isLoading=!1,e.$store.commit(l.b,{msg:"Hay un error al hacer la busqueda de cuentas. "+t.response,color:"danger"})})},500),validate:function(){var e=this;return n()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.$validator.validateAll(e.scope).then(function(e){return e}));case 1:case"end":return t.stop()}},t,e)}))()}}}}});
//# sourceMappingURL=60.e47952dc70ea3a0c9548.js.map