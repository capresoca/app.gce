webpackJsonp([49],{1362:function(t,a,o){"use strict";var e=o(59),i=o(12),r=o(40),n=o(743);a.a={name:"GestionAuditPrestacionEconomica",components:{Confirmar:n.a,InputFile:function(){return o.e(288).then(o.bind(null,748))}},props:["parametros"],data:function(){return{dialogA:{visible:!1,content:null,registroID:null},loadingSubmit:!1,payload:null,incapacidad:{},mostrarInput:!1,dialog2:!1,tableLoading:!1,arrayTutela:[],dataSoporte:{detalle:[]},causalesRechazo:{causal:[]},headersTipoSoporte:[{text:"Tipo Soporte",align:"left",sortable:!1,value:""},{text:"Obligatorio",align:"left",sortable:!1,value:""},{text:"Observación",align:"left",sortable:!1,value:""},{text:"Tipos de archivo",align:"left",sortable:!1,value:""},{text:"Acciones",align:"left",sortable:!1,value:""}],arrayRechazo:{},dataEliminar:[],archivo:[],descripcionSoporte:[],soportes:[],mostrar:!0,mostrarDocs:!0}},mounted:function(){null!==this.parametros.afiliado&&this.getRegistro(this.parametros.afiliado.id),console.log(this.parametros)},created:function(){this.reloadPage()},watch:{},computed:{complementos:function(){return e.b.getters.complementosTercerosFormComplementarios},isDisabled:function(){return!this.incapacidad.archivo}},methods:{reloadPage:function(){var t=this;this.tableLoading=!0,this.localLoading=!0,this.incapacidad.consecutivo_afiliado=this.parametros.afiliado.id,this.axios.get("soportesLicencia?id="+this.parametros.afiliado.solicitud).then(function(a){t.dataSoporte.detalle=a.data.data,t.tableLoading=!1,t.localLoading=!1}).catch(function(a){return t.tableLoading=!1,t.localLoading=!1,console.log(a.response),!1})},closeTable:function(){this.dialog=!1,this.dialog2=!1},getRegistro:function(t){},actualizar:function(){var t=this;this.loadingSubmit=!0,this.addFormData(),this.axios.post("updatesoportes",this.payload).then(function(a){t.loadingSubmit=!1,t.$store.commit(i.b,{msg:"Actualización realizada correctamente.",color:"success"}),t.reloadPage(),t.formReset()}).catch(function(a){return t.loadingSubmit=!1,console.log(a),t.$store.commit(i.b,{msg:"Hay un error al guardar el registro. "+a.response,color:"danger"}),!1})},close:function(){this.$validator.reset(),this.$store.dispatch(r.c,{contexto:this,itemId:this.parametros.tabOrigin})},formReset:function(){for(var t=0;t<this.descripcionSoporte.length;t++)if(this.descripcionSoporte[t]){console.log(this.descripcionSoporte[t]);var a=document.getElementById(t);a.setAttribute("style","display: none");var o="spanTexto"+t;document.getElementById(o).removeAttribute("style")}this.archivo=[],this.descripcionSoporte=[],this.soportes=[],this.incapacidad={}},descargar:function(t){var a=this;console.log(t),this.axios.get("descargasoporte?url="+t).then(function(a){var o=t,e=o.lastIndexOf("/"),i=o.substr(e+1,o.length),r=o.lastIndexOf("."),n=o.substr(r+1,o.length);console.log(n),console.log(a.data);var s=window.URL.createObjectURL(new Blob([a.data])),c=document.createElement("a");c.href=s,c.setAttribute("download",i),document.body.appendChild(c),c.click()}).catch(function(t){return a.$store.commit(i.b,{msg:"Hay un error al descargar el archvio.",color:"danger"}),!1})},gestionarArchivos:function(t,a,o,e){this.archivo[a]=t,this.descripcionSoporte[a]=o,this.soportes[a]=e,console.log(a),console.log("array archivos",this.archivo)},agregarArchivo:function(t){this.mostrarInput=!0,document.getElementById(t).removeAttribute("style");var a="spanTexto"+t;document.getElementById(a).setAttribute("style","display: none")},addFormData:function(){for(var t=new FormData,a=new File([""],"noArchivo.txt",{type:"text/plain",lastModified:Date.now()}),o=0;o<this.archivo.length;o++)t.append("nombresArchivos[]",this.soportes[o]);for(var e=0;e<this.archivo.length;e++)this.archivo[e]||(this.archivo[e]=a),t.append("archivos[]",this.archivo[e]);for(var i=0;i<this.archivo.length;i++)t.append("descripcionSoporte[]",this.descripcionSoporte[i]);t.append("consecutivo_licencia",this.parametros.afiliado.solicitud),this.payload=t},eliminar:function(t){this.dialogA.content="¿Está seguro de eliminar?",this.dialogA.registroID=this.parametros.afiliado.solicitud,this.dialogA.visible=!0,this.dialogA.soporte=t},cancelaAnulacion:function(){this.dialogA.visible=!1,this.dialogA.content=null,this.dialogA.registroID=null},confirmaAnulacion:function(){var t=this;this.localLoading=!0,this.axios.delete("auditoria/eliminar/"+this.dialogA.registroID+"/"+this.dialogA.soporte).then(function(a){t.$store.commit(i.b,{msg:"El soporte se eliminó correctamente",color:"success"}),t.reloadPage(),t.cancelaAnulacion(),t.localLoading=!1,t.$refs.confirmo.pararCarga()}).catch(function(a){t.localLoading=!1,t.$store.commit(i.b,{msg:"Hay un error al eliminar el registro. "+a.response,color:"danger"})})}},filters:{nombreArchivo:function(t){var a=t.lastIndexOf("/");return t.substr(a+1,t.length)},estado:function(t){return 1===t?"Radicada":2===t?"Aprobada":3===t?"Negado":4===t?"En progreso":5===t?"Anulada":6===t?"Rechazado":void 0}}}},2677:function(t,a,o){var e=o(2678);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);o(456)("f3e8a868",e,!0,{})},2678:function(t,a,o){a=t.exports=o(455)(!0),a.push([t.i,".tipo[data-v-645b01fe]{height:10px;padding:0}.no-padding[data-v-645b01fe]{padding:0}.trverde[data-v-645b01fe]{background-color:#6ccd29}","",{version:3,sources:["/home/capresoca/projects/Capresoca-Frontend/src/components/misional/atencionUsuario/auditorias_prestaciones_economicas/EdicionSoportesAuditoria.vue"],names:[],mappings:"AACA,uBACE,YAAa,AACb,SAAW,CACZ,AACD,6BACE,SAAW,CACZ,AACD,0BACE,wBAA0B,CAC3B",file:"EdicionSoportesAuditoria.vue",sourcesContent:["\n.tipo[data-v-645b01fe] {\n  height: 10px;\n  padding: 0;\n}\n.no-padding[data-v-645b01fe] {\n  padding: 0;\n}\n.trverde[data-v-645b01fe] {\n  background-color: #6ccd29;\n}\n"],sourceRoot:""}])},2679:function(t,a,o){"use strict";var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("v-dialog",{attrs:{width:"500px"},model:{value:t.dialog2,callback:function(a){t.dialog2=a},expression:"dialog2"}},[o("v-form",[o("v-card",[o("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[o("span",{staticClass:"title"},[t._v("Rechazo")])]),t._v(" "),o("v-container",{attrs:{fluid:"","grid-list-md":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{xs12:""}})],1)],1),t._v(" "),o("v-card-actions",{staticClass:"grey lighten-4"},[o("v-spacer"),t._v(" "),o("v-btn",{on:{click:t.closeTable}},[t._v("Cancelar")]),t._v(" "),o("v-btn",{attrs:{color:"primary",loading:t.loadingSubmitRechazo},on:{click:t.saveCausal}},[t._v("Guardar")])],1)],1)],1)],1),t._v(" "),o("v-card",{ref:"loaderRef"},[o("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[o("v-toolbar-title",[t._v(" "+t._s(t.ordenEdit?"Edicion":"Editar soporte")+" ")])],1),t._v(" "),"Radicada"!=t.parametros.afiliado.estado?o("h1",{staticStyle:{align:"center"}},[t._v("No se puede modificar los soportes a una licencia "+t._s(t.parametros.afiliado.estado)+".")]):o("v-card-text",{staticClass:"no-padding"},[o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[o("v-layout",[o("v-flex",[o("div",{staticClass:"text-xs-center"},[o("h4",[t._v("Afiliado: "+t._s(t.parametros.afiliado.afiliado))]),t._v(" "),o("h4",[t._v("Prestación: "+t._s(t.parametros.afiliado.solicitud))])])])],1),t._v(" "),o("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headersTipoSoporte,items:t.dataSoporte.detalle,loading:t.tableLoading,"total-items":t.dataSoporte.length,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(a){return[o("td",[t._v(t._s(a.item.descripcion))]),t._v(" "),o("td",[t._v(t._s(a.item.obligatorio))]),t._v(" "),o("td",[t._v(t._s(a.item.observacion)+" ")]),t._v(" "),o("td",[t._l(a.item.urls,function(e){return o("span",{key:e},[a.item.descripcion==e.soporte?o("span",{attrs:{id:"spanTexto"+a.index}},[t._v(t._s(t._f("nombreArchivo")(e.url)))]):t._e()])}),t._v(" "),o("input-file",{staticClass:"mb-3",staticStyle:{display:"none"},attrs:{id:a.index,label:"Adjuntar archivo","file-name":t.incapacidad.archivo?t.incapacidad.archivo.nombre:null,accept:"",hint:"","prepend-icon":"description"},nativeOn:{change:function(o){return t.gestionarArchivos(t.incapacidad.archivo,a.index,a.item.descripcion,a.item.urls)}},model:{value:t.incapacidad.archivo,callback:function(a){t.$set(t.incapacidad,"archivo",a)},expression:"incapacidad.archivo"}})],2),t._v(" "),o("td",[o("v-speed-dial",{attrs:{direction:"left","open-on-hover":"",transition:"slide-x-transition"},model:{value:a.item.show,callback:function(o){t.$set(a.item,"show",o)},expression:"props.item.show"}},[o("v-btn",{attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:"",small:""},slot:"activator",model:{value:a.item.show,callback:function(o){t.$set(a.item,"show",o)},expression:"props.item.show"}},[o("v-icon",[t._v("chevron_left")]),t._v(" "),o("v-icon",[t._v("close")])],1),t._v(" "),t._l(a.item.urls,function(e){return o("span",{key:e},[o("v-tooltip",{directives:[{name:"show",rawName:"v-show",value:"No"==a.item.obligatorio&&a.item.descripcion==e.soporte,expression:"props.item.obligatorio == 'No' && props.item.descripcion == url.soporte"}],attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"white"},on:{click:function(o){return t.eliminar(a.item.descripcion)}},slot:"activator"},[o("v-icon",{attrs:{color:"accent"}},[t._v("delete")])],1),t._v(" "),o("span",[t._v("Eliminar")])],1),t._v(" "),a.item.descripcion==e.soporte?o("v-tooltip",{attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"white",title:"Ver"},on:{click:function(a){return t.descargar(e.url)}},slot:"activator"},[o("v-icon",{attrs:{color:"accent"}},[t._v("image_search")])],1),t._v(" "),o("span",[t._v("Ver")])],1):t._e()],1)}),t._v(" "),o("v-tooltip",{attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"white",title:"Agregar o Modificar"},on:{click:function(o){return t.agregarArchivo(a.index)}},slot:"activator"},[o("v-icon",{attrs:{color:"accent"}},[t._v("mode_edit")])],1),t._v(" "),o("span",[t._v("Editar")])],1)],2)],1)]}}])},[t._v(" "),o("template",{slot:"no-data"},[t.tableLoading?o("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[t._v("\n              Estamos cargando los registros. "),o("v-icon",[t._v("sentiment_satisfied_alt")])],1):o("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[t._v("\n              No tenemos registros para mostrar. "),o("v-icon",[t._v("sentiment_very_dissatisfied")])],1)],1)],2)],1)],1),t._v(" "),o("v-divider"),t._v(" "),o("v-card-actions",{staticClass:"grey lighten-4"},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{staticClass:"text-xs-right",attrs:{xs12:""}},[o("v-btn",{on:{click:function(a){return t.close()}}},[t._v("Anterior")]),t._v(" "),o("v-btn",{directives:[{name:"show",rawName:"v-show",value:"Aprobado"!=t.parametros.afiliado.estado,expression:"parametros.afiliado.estado != 'Aprobado'"}],attrs:{disabled:t.isDisabled,color:"primary",loading:t.loadingSubmit},on:{click:function(a){return a.preventDefault(),t.actualizar()}}},[t._v("Actualizar")])],1)],1)],1)],1),t._v(" "),o("confirmar",{ref:"confirmo",attrs:{value:t.dialogA.visible,content:t.dialogA.content},on:{cancelar:t.cancelaAnulacion,aceptar:function(a){return t.confirmaAnulacion(a)}}})],1)},i=[],r={render:e,staticRenderFns:i};a.a=r},736:function(t,a,o){"use strict";function e(t){o(2677)}Object.defineProperty(a,"__esModule",{value:!0});var i=o(1362),r=o(2679),n=o(1),s=e,c=n(i.a,r.a,!1,s,"data-v-645b01fe",null);a.default=c.exports},742:function(t,a,o){"use strict";var e=o(13),i=o.n(e),r=o(14),n=o.n(r),s=o(58);a.a={name:"Confirmar",props:{value:{type:Boolean,default:!1},content:{type:String},requiereMotivo:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},components:{Loading:s.default},data:function(){return{loadingSubmit:!1,motivo:null}},watch:{value:function(t){t||(this.motivo=null,this.$validator.reset())}},methods:{submit:function(){var t=this;return n()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$validator.validateAll();case 2:if(!a.sent){a.next=5;break}t.loadingSubmit=!0,t.$emit("aceptar",t.motivo);case 5:case"end":return a.stop()}},a,t)}))()},pararCarga:function(){this.loadingSubmit=!1}}}},743:function(t,a,o){"use strict";function e(t){o(744)}var i=o(742),r=o(746),n=o(1),s=e,c=n(i.a,r.a,!1,s,"data-v-3773d9ac",null);a.a=c.exports},744:function(t,a,o){var e=o(745);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);o(456)("0e7a280b",e,!0,{})},745:function(t,a,o){a=t.exports=o(455)(!0),a.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Confirmar2.vue",sourceRoot:""}])},746:function(t,a,o){"use strict";var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("v-layout",{attrs:{row:"","justify-center":""}},[o("v-dialog",{key:"dialogConfirm",attrs:{persistent:"","max-width":"400"},model:{value:t.value,callback:function(a){t.value=a},expression:"value"}},[o("loading",{model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}}),t._v(" "),o("v-card",[o("v-card-text",{staticClass:"title font-weight-light text-xs-center",domProps:{innerHTML:t._s(t.content)}}),t._v(" "),o("v-divider"),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{flat:""},on:{click:function(a){return a.stopPropagation(),t.$emit("cancelar")}}},[t._v("Cancelar")]),t._v(" "),o("v-spacer"),t._v(" "),o("v-btn",{attrs:{color:"primary",loading:t.loadingSubmit},on:{click:function(a){return a.stopPropagation(),t.submit(a)}}},[t._v("Aceptar")])],1)],1)],1)],1)},i=[],r={render:e,staticRenderFns:i};a.a=r}});
//# sourceMappingURL=49.48717873ac1b5aad85ea.js.map