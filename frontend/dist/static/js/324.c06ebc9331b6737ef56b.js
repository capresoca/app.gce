webpackJsonp([324],{1214:function(e,t,r){"use strict";var i=r(13),o=r.n(i),a=r(14),s=r.n(a),n=r(8),l=r.n(n),c=r(59);t.a={name:"RegistroGrupoIPS",props:{icon:{type:String,default:""}},data:function(){return{dialog:!1,loading:!1,grupo:null,makeGrupo:{id:null,municipio_id:null,departamento_id:null,descrip:null,portable:0,prestadores:[]},serviciosPrimarios:[],prestadoresASeleccionar:[],loadingPrestadores:!1,prestadorSeleccionado:null,servicio_id:null,headersPrestadores:[{text:"Primaria",align:"left",sortable:!1},{text:"Entidad",align:"left",sortable:!1},{text:"",align:"center",sortable:!1}],filterIPSs:function(e,t){var r=function(e){return null!=e?e:""},i=r(e.cod_habilitacion+" "+e.nombre),o=r(t);return i.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1},filterMunicipios:function(e,t){var r=function(e){return null!=e?e:""},i=r(e.nombre),o=r(t);return i.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1},errorButton:null}},watch:{dialog:function(e){!e&&this&&this.closer()},"grupo.municipio_id":{handler:function(e){e&&this.getPrestadores()},immediate:!0}},computed:{complementos:function(){return c.b.getters.complementosGruposIPS}},created:function(){this.grupo=l()({},this.makeGrupo),this.getServiciosPrimarios()},methods:{submit:function(){var e=this;return s()(o.a.mark(function t(){var r,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validate();case 2:if(!t.sent){t.next=8;break}e.loading=!0,r=l()({},e.grupo),r.prestadores=r.prestadores.map(function(e){return{entidad_id:e.entidad.id,primaria:e.primaria}}),i=r.id?e.axios.put("rs_servicios/grupos_ips/"+r.id,r):e.axios.post("rs_servicios/grupos_ips",r),i.then(function(){e.$store.commit("reloadTable","tableGruposIPS"),e.$store.commit("SNACK_SHOW",{msg:"El grupo de IPS se registró correctamente.",color:"success"}),e.dialog=!1,e.loading=!1}).catch(function(t){e.loading=!1,e.$store.commit("SNACK_ERROR_LIST",{expression:"al registrar el grupo de IPS.",error:t})});case 8:case"end":return t.stop()}},t,e)}))()},validate:function(){var e=this;return s()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validator.validateAll();case 2:if(t.sent){t.next=6;break}e.errorButton="Hay campos por diligenciar en el formulario.",t.next=7;break;case 6:e.grupo.prestadores.length?e.grupo.prestadores.length&&!e.grupo.prestadores.find(function(e){return e.primaria})&&(e.errorButton="Se debe seleccionar un prestador como IPS primaria."):e.errorButton="Se debe seleccionar al menos un prestador.";case 7:if(!e.errorButton){t.next=10;break}return setTimeout(function(){e.errorButton=null},8e3),t.abrupt("return",!1);case 10:return t.abrupt("return",!0);case 11:case"end":return t.stop()}},t,e)}))()},pushPrestador:function(){var e=this;this.grupo.prestadores.find(function(t){return t.entidad.id===e.prestadorSeleccionado.id})||this.grupo.prestadores.push({id:null,primaria:0,entidad:l()({},this.prestadorSeleccionado)}),setTimeout(function(){e.prestadorSeleccionado=null},20)},reloadPrimaria:function(e){e.item.primaria&&this.grupo.prestadores.forEach(function(t,r){r!==e.index&&(t.primaria=0)})},getGrupo:function(e){var t=this;this.loading=!0,this.axios.get("rs_servicios/grupos_ips/"+e.id).then(function(e){t.grupo=e.data.data,t.loading=!1}).catch(function(e){t.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:"al traer el registro del grupo",error:e})})},getPrestadores:function(){var e=this;this.loadingPrestadores=!0,this.axios.get("rs_servicios/prestadores/"+this.grupo.municipio_id).then(function(t){e.prestadoresASeleccionar=t.data.data,e.loadingPrestadores=!1}).catch(function(t){e.loadingPrestadores=!1,e.$store.commit("SNACK_ERROR_LIST",{expression:"al traer los prestadores",error:t})})},getServiciosPrimarios:function(){var e=this;this.axios.get("servicios/primarios").then(function(t){e.serviciosPrimarios=t.data.data}).catch(function(t){e.$store.commit("SNACK_ERROR_LIST",{expression:" al traer los servicios primarios. ",error:t})})},closer:function(){var e=this;setTimeout(function(){e.resetModel()},300)},open:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.getGrupo(e):this.resetModel(),this.dialog=!0},resetModel:function(){this.makeGrupo.prestadores=[],this.grupo=l()({},this.makeGrupo),this.$validator.reset(),this.prestadoresASeleccionar=[],this.errorButton=null,this.prestadorSeleccionado=null}}}},2181:function(e,t,r){"use strict";function i(e){r(2182)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1214),a=r(2184),s=r(1),n=i,l=s(o.a,a.a,!1,n,"data-v-586712bb",null);t.default=l.exports},2182:function(e,t,r){var i=r(2183);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);r(456)("76f33e86",i,!0,{})},2183:function(e,t,r){t=e.exports=r(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroGrupoIPS.vue",sourceRoot:""}])},2184:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{persistent:"","max-width":"920"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("loading",{model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),e._v(" "),r("v-toolbar",{attrs:{dense:""}},[r("v-toolbar-title",[r("v-avatar",{attrs:{color:"primary",size:"38"}},[r("v-icon",{staticClass:"white--text"},[e._v(e._s(e.icon))])],1),e._v("\n        "+e._s(e.grupo&&e.grupo.id?"Nuevo ":"Edición de ")+"Grupo de IPS\n      ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{attrs:{flat:"",icon:""},on:{click:function(t){t.stopPropagation(),e.dialog=!1}}},[r("v-icon",[e._v("close")])],1)],1),e._v(" "),r("v-container",{attrs:{fluid:"","grid-list-md":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[r("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Departamento",items:e.complementos.departamentos,"item-value":"id","item-text":"nombre",name:"departamento",required:"","error-messages":e.errors.collect("departamento"),filter:e.filterMunicipios},model:{value:e.grupo.departamento_id,callback:function(t){e.$set(e.grupo,"departamento_id",t)},expression:"grupo.departamento_id"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[r("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:!e.grupo.departamento_id,label:"Municipio",items:e.grupo.departamento_id?e.complementos.municipios.filter(function(t){return t.gn_departamento_id===e.grupo.departamento_id}):[],"item-value":"id","item-text":"nombre",name:"municipio",required:"","error-messages":e.errors.collect("municipio"),filter:e.filterMunicipios},model:{value:e.grupo.municipio_id,callback:function(t){e.$set(e.grupo,"municipio_id",t)},expression:"grupo.municipio_id"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm8:""}},[r("v-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Descripción",name:"descripción","error-messages":e.errors.collect("descripción"),rows:"1","auto-grow":""},model:{value:e.grupo.descrip,callback:function(t){e.$set(e.grupo,"descrip",t)},expression:"grupo.descrip"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:"",sm4:""}},[r("v-switch",{attrs:{label:"Portabilidad","true-value":1,"false-value":0,primary:"","hide-details":""},on:{change:e.getPrestadores},model:{value:e.grupo.portable,callback:function(t){e.$set(e.grupo,"portable",t)},expression:"grupo.portable"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-card",[r("v-toolbar",{attrs:{dense:""}},[r("v-toolbar-title",[e._v("Prestadores asignados")])],1),e._v(" "),r("v-card-text",[r("v-data-table",{attrs:{headers:e.headersPrestadores,items:e.grupo.prestadores,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[r("tr",{attrs:{active:t.item.primaria}},[r("td",[r("v-checkbox",{attrs:{"true-value":1,"false-value":0,primary:"","hide-details":""},on:{change:function(r){return e.reloadPrimaria(t)}},model:{value:t.item.primaria,callback:function(r){e.$set(t.item,"primaria",r)},expression:"props.item.primaria"}})],1),e._v(" "),r("td",[r("v-list-tile-content",{staticStyle:{width:"100%"}},[r("v-list-tile-title",[e._v(e._s(t.item.entidad.nombre))]),e._v(" "),r("v-list-tile-sub-title",{staticClass:"caption"},[r("v-icon",{attrs:{size:"small"}},[e._v("fas fa-phone-alt")]),e._v(" "+e._s(t.item.entidad.telefono_sede)+" "),r("v-icon",{attrs:{size:"small"}},[e._v("fas fa-map-signs")]),e._v(" "+e._s(t.item.entidad.direccion_sede))],1)],1)],1),e._v(" "),r("td",{staticClass:"text-xs-center"},[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",color:"danger",flat:"",icon:""},on:{click:function(r){return r.stopPropagation(),e.grupo.prestadores.splice(t.index,1)}},slot:"activator"},[r("v-icon",[e._v("delete")])],1),e._v(" "),r("span",[e._v("Borrar Registro")])],1)],1)])]}}])})],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",[r("v-autocomplete",{attrs:{label:"Seleccionar Prestador",items:e.prestadoresASeleccionar,"item-value":"id","item-text":"nombre","return-object":"",filter:e.filterIPSs,"no-data-text":"No hay prestadores para seleccionar",loading:e.loadingPrestadores,"prepend-icon":"search"},on:{input:e.pushPrestador},scopedSlots:e._u([{key:"item",fn:function(t){return[[r("v-list-tile-content",[r("v-list-tile-title",[e._v(e._s(t.item.nombre))]),e._v(" "),r("v-list-tile-sub-title",{staticClass:"caption"},[r("v-icon",{attrs:{size:"small"}},[e._v("fas fa-phone-alt")]),e._v(" "+e._s(t.item.telefono_sede)+" "),r("v-icon",{attrs:{size:"small"}},[e._v("fas fa-map-signs")]),e._v(" "+e._s(t.item.direccion_sede))],1)],1)]]}}]),model:{value:e.prestadorSeleccionado,callback:function(t){e.prestadorSeleccionado=t},expression:"prestadorSeleccionado"}})],1)],1)],1)],1)],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",[r("v-btn",{attrs:{flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancelar")]),e._v(" "),r("v-spacer"),e._v(" "),r("span",{staticClass:"caption error--text mr-3"},[r("strong",[e._v(e._s(e.errorButton))])]),e._v(" "),r("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:e.submit}},[e._v("Guardar")])],1)],1)],1)},o=[],a={render:i,staticRenderFns:o};t.a=a}});
//# sourceMappingURL=324.c06ebc9331b6737ef56b.js.map