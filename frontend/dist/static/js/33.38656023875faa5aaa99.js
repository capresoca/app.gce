webpackJsonp([33],{1474:function(e,i,a){var t=a(1475);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);a(456)("441bef35",t,!0,{})},1475:function(e,i,a){i=e.exports=a(455)(!0),i.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroAfiliado.vue",sourceRoot:""}])},1476:function(e,i,a){"use strict";var t=function(){var e=this,i=e.$createElement,a=e._self._c||i;return a("div",[a("v-toolbar",{attrs:{dense:""}},[a("v-icon",[e._v(e._s(e.afiliado.id?"person":"person_add"))]),e._v(" "),a("v-toolbar-title",[e._v(e._s(e.afiliado.id?"Edición de afiliado":"Nuevo afiliado"))])],1),e._v(" "),a("v-stepper",{model:{value:e.stepActual,callback:function(i){e.stepActual=i},expression:"stepActual"}},[a("loading",{model:{value:e.loadingSubmit,callback:function(i){e.loadingSubmit=i},expression:"loadingSubmit"}}),e._v(" "),a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:e.stepActual>1,step:"1",editable:"",rules:[function(){return!e.errorsStep1}]}},[e._v("Datos básicos "),e.errorsStep1?a("small",[e._v("Hay datos por diligenciar.")]):e._e()]),e._v(" "),a("v-divider"),e._v(" "),a("v-stepper-step",{attrs:{complete:e.stepActual>2,step:"2",editable:"",rules:[function(){return!e.errorsStep2}]}},[e._v("Datos complementarios "),e.errorsStep2?a("small",[e._v("Hay datos por diligenciar.")]):e._e()]),e._v(" "),a("v-divider"),e._v(" "),a("v-stepper-step",{attrs:{complete:e.stepActual>3,step:"3",editable:"",rules:[function(){return!e.errorsStep3}]}},[e._v("Información adicional "),e.errorsStep3?a("small",[e._v("Hay datos por diligenciar.")]):e._e()])],1),e._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-card",{staticClass:"mb-1"},[a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("form-basicos",{ref:"fBasicos",attrs:{manager:"Afiliado","edicion-total":e.edicionTotal,verified:e.estadoTercero},on:{errors:function(i){return e.validStepBasicos=i},verified:function(i){return e.estadoTercero=i},update:function(i){return e.complementar(i)}}}),e._v(" "),a("v-form",{attrs:{"data-vv-scope":"formAfiliadoStep1"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("input-date",{directives:[{name:"validate",rawName:"v-validate",value:"required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY"+(e.edicionTotal?"":"|date_between:"+e.minDateI+","+e.maxDateI+",true"),expression:"'required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY' + (edicionTotal ? '' : '|date_between:' + minDateI + ',' + maxDateI + ',true')"}],attrs:{label:"Fecha nacimiento (Día/Mes/Año)",format:"DD/MM/YYYY",name:"Fecha nacimiento",min:e.minDate,max:e.maxDate,"error-messages":e.errors.collect("Fecha nacimiento"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.fecha_nacimiento,callback:function(i){e.$set(e.afiliado,"fecha_nacimiento",i)},expression:"afiliado.fecha_nacimiento"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Sexo",items:e.complementos.sexos,"item-value":"id","item-text":"nombre",name:"Sexo",required:"","error-messages":e.errors.collect("Sexo"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.gn_sexo_id,callback:function(i){e.$set(e.afiliado,"gn_sexo_id",i)},expression:"afiliado.gn_sexo_id"}})],1),e._v(" "),e.afiliado.id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Régimen",items:e.complementos.regimenes,"item-value":"id","item-text":"nombre",name:"régimen",required:"","error-messages":e.errors.collect("régimen"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.as_regimene_id,callback:function(i){e.$set(e.afiliado,"as_regimene_id",i)},expression:"afiliado.as_regimene_id"}})],1):e._e(),e._v(" "),e.afiliado.id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[e.requiereRolLider?a("v-text-field",{attrs:{label:"Estado",value:e.afiliado.estado_afiliado.nombre,disabled:""}}):a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Estado",items:e.complementos.estadosAfiliado,"item-value":"id","item-text":"nombre",name:"estado",required:"","error-messages":e.errors.collect("estado"),disabled:!e.estadoTercero},model:{value:e.afiliado.estado,callback:function(i){e.$set(e.afiliado,"estado",i)},expression:"afiliado.estado"}})],1):e._e(),e._v(" "),[a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("input-date",{directives:[{name:"validate",rawName:"v-validate",value:"required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY|date_between:"+e.minDateAfiliacionI+","+e.maxFechaActualI+",true",expression:"'required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY' + (false ? '' : '|date_between:' + minDateAfiliacionI + ',' + maxFechaActualI + ',true')"}],attrs:{label:"Fecha afiliación (Día/Mes/Año)",format:"DD/MM/YYYY",min:e.minDateAfiliacion2,max:e.maxFechaActual,name:"fecha afiliación","error-messages":e.errors.collect("fecha afiliación"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.fecha_afiliacion,callback:function(i){e.$set(e.afiliado,"fecha_afiliacion",i)},expression:"afiliado.fecha_afiliacion"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Tipo afiliado",items:e.complementos.tipafiliados,"item-value":"id","item-text":"nombre",name:"tipo afiliado",required:"","error-messages":e.errors.collect("tipo afiliado"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.as_tipafiliado_id,callback:function(i){e.$set(e.afiliado,"as_tipafiliado_id",i)},expression:"afiliado.as_tipafiliado_id"}})],1)]],2)],1)],1)],1)],1),e._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",{staticClass:"mb-1"},[a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("form-complementarios",{ref:"fComplementarios",attrs:{manager:"Afiliado","edicion-total":e.edicionTotal,verified:e.estadoTercero},on:{errors:function(i){return e.validStepComplementarios=i}}}),e._v(" "),a("v-form",{attrs:{"data-vv-scope":"formAfiliadoStep2"}},[a("v-layout",{attrs:{row:"",wrap:""}},[2===e.afiliado.gn_zona_id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"autocomple-vereda",attrs:{label:"Vereda",items:e.veredas,"item-value":"id","item-text":"nombre",name:"Vereda",required:"","error-messages":e.errors.collect("Vereda"),disabled:!e.estadoTercero},model:{value:e.afiliado.gn_vereda_id,callback:function(i){e.$set(e.afiliado,"gn_vereda_id",i)},expression:"afiliado.gn_vereda_id"}})],1):e._e(),e._v(" "),1===e.afiliado.gn_zona_id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"autocomple-barrio",attrs:{label:"Barrio",items:e.barrios,"item-value":"id","item-text":"nombre",name:"Barrio",required:"","error-messages":e.errors.collect("Barrio"),disabled:!e.estadoTercero},model:{value:e.afiliado.gn_barrio_id,callback:function(i){e.$set(e.afiliado,"gn_barrio_id",i)},expression:"afiliado.gn_barrio_id"}})],1):e._e(),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-select",{attrs:{label:"Etnia",items:e.complementos.etnias,"item-value":"id","item-text":"nombre",disabled:!e.estadoTercero,clearable:""},model:{value:e.afiliado.as_etnia_id,callback:function(i){e.$set(e.afiliado,"as_etnia_id",i)},expression:"afiliado.as_etnia_id"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Pais procedencia",items:e.complementos.paises,"item-value":"id","item-text":"nombre",name:"Pais procedencia",required:"","error-messages":e.errors.collect("Pais procedencia"),disabled:!e.estadoTercero},scopedSlots:e._u([{key:"item",fn:function(i){return[[a("v-list-tile-action",[a("flag",{attrs:{iso:i.item.iso_dos}})],1),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(i.item.nombre)}})],1)]]}},{key:"selection",fn:function(i){return[a("flag",{attrs:{iso:i.item.iso_dos}}),e._v("   "+e._s(i.item.nombre)+"\n                    ")]}}]),model:{value:e.afiliado.gn_paise_id,callback:function(i){e.$set(e.afiliado,"gn_paise_id",i)},expression:"afiliado.gn_paise_id"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("v-card",{staticClass:"mb-1"},[a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("v-form",{attrs:{"data-vv-scope":"formAfiliadoStep3"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-select",{attrs:{label:"Condición de Discapacidad",items:e.complementos.condicionesdiscapacidad,"item-value":"id","item-text":"nombre",disabled:!e.estadoTercero||e.requiereNovedad,clearable:""},model:{value:e.afiliado.as_condicion_discapacidades_id,callback:function(i){e.$set(e.afiliado,"as_condicion_discapacidades_id",i)},expression:"afiliado.as_condicion_discapacidades_id"}})],1),e._v(" "),e.afiliado&&2===e.afiliado.as_regimene_id?a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"autocompletePoblacionEspecial",attrs:{label:"Población Especial",items:e.complementos.pobespeciales,"item-value":"id","item-text":"nombre",disabled:!e.estadoTercero||e.requiereNovedad,name:"Población Especial","error-messages":e.errors.collect("Población Especial")},model:{value:e.afiliado.as_pobespeciale_id,callback:function(i){e.$set(e.afiliado,"as_pobespeciale_id",i)},expression:"afiliado.as_pobespeciale_id"}})],1):e._e(),e._v(" "),e.afiliado&&2===e.afiliado.as_regimene_id&&4===e.afiliado.as_pobespeciale_id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"selectZonaDNP",attrs:{label:"Zona DNP",items:e.complementos.zonas,"item-value":"id","item-text":"nombre",name:"Zona DNP","error-messages":e.errors.collect("Zona DNP"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.zona_dnp,callback:function(i){e.$set(e.afiliado,"zona_dnp",i)},expression:"afiliado.zona_dnp"}})],1):e._e(),e._v(" "),e.afiliado&&2===e.afiliado.as_regimene_id&&4===e.afiliado.as_pobespeciale_id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:e.afiliado&&4===e.afiliado.as_pobespeciale_id?"required|max:8":"",expression:"(afiliado && afiliado.as_pobespeciale_id === 4) ? 'required|max:8' : ''"}],key:"textFichaSISBEN",attrs:{label:"Ficha SISBEN",name:"Ficha SISBEN",maxlength:"8",required:"","error-messages":e.errors.collect("Ficha SISBEN"),disabled:!e.estadoTercero||e.requiereNovedad},model:{value:e.afiliado.ficha_sisben,callback:function(i){e.$set(e.afiliado,"ficha_sisben",i)},expression:"afiliado.ficha_sisben"}})],1):e._e(),e._v(" "),e.afiliado&&2===e.afiliado.as_regimene_id&&4===e.afiliado.as_pobespeciale_id?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"puntajeSisben:"+e.afiliado.zona_dnp+"decimal:2|max_value:"+(e.zonaDNP?e.zonaDNP.rn2.fin:0)+"|min_value:"+(e.zonaDNP?e.zonaDNP.rn1.ini:0)+"|required",expression:"'puntajeSisben:' + afiliado.zona_dnp + 'decimal:2|max_value:' + (zonaDNP ? zonaDNP.rn2.fin : 0) + '|min_value:' + (zonaDNP ? zonaDNP.rn1.ini : 0) + '|required'"}],key:"textPuntajeSISBEN",attrs:{label:"Puntaje Sisben",type:"number",step:.01,min:e.zonaDNP?e.zonaDNP.rn1.ini:0,max:e.zonaDNP?e.zonaDNP.rn2.fin:0,name:"Puntaje Sisben","data-vv-validate-on":"input|change|custom|blur","error-messages":e.errors.collect("Puntaje Sisben"),disabled:!e.estadoTercero||e.afiliado&&!e.afiliado.zona_dnp||e.requiereNovedad},model:{value:e.afiliado.puntaje_sisben,callback:function(i){e.$set(e.afiliado,"puntaje_sisben",i)},expression:"afiliado.puntaje_sisben"}})],1):e._e(),e._v(" "),a("v-slide-x-reverse-transition",{attrs:{mode:"out-in"}},[e.estadoTercero&&e.afiliado&&2===e.afiliado.as_regimene_id&&4===e.afiliado.as_pobespeciale_id&&null!==e.afiliado.puntaje_sisben&&""!==e.afiliado.puntaje_sisben&&e.afiliado.puntaje_sisben>-1?a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{attrs:{label:"Nivel SISBEN",value:e.afiliado.nivel_sisben,readonly:"",disabled:!e.estadoTercero||e.afiliado&&4!==e.afiliado.as_pobespeciale_id||e.requiereNovedad},model:{value:e.afiliado.nivel_sisben,callback:function(i){e.$set(e.afiliado,"nivel_sisben",i)},expression:"afiliado.nivel_sisben"}})],1):e._e()],1),e._v(" "),1===e.afiliado.as_regimene_id?a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{key:"autocompleteCajaCompensacion",attrs:{label:"Caja de compensación",items:e.complementos.ccfs,"item-value":"id","item-text":"nombre",disabled:!e.estadoTercero,clearable:""},model:{value:e.afiliado.as_ccf_id,callback:function(i){e.$set(e.afiliado,"as_ccf_id",i)},expression:"afiliado.as_ccf_id"}})],1):e._e(),e._v(" "),1===e.afiliado.as_regimene_id?a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{key:"autocompleteAFP",attrs:{label:"AFP",items:e.complementos.afps,"item-value":"id","item-text":"nombre",disabled:!e.estadoTercero,clearable:""},model:{value:e.afiliado.as_afp_id,callback:function(i){e.$set(e.afiliado,"as_afp_id",i)},expression:"afiliado.as_afp_id"}})],1):e._e(),e._v(" "),1===e.afiliado.as_regimene_id?a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"autocompleteActividadEconomica",attrs:{label:"Actividad económica",items:e.complementos.ciius,"item-value":"id","item-text":"nombre",name:"Actividad económica",required:"","error-messages":e.errors.collect("Actividad económica"),disabled:!e.estadoTercero,filter:e.filterCiius},scopedSlots:e._u([{key:"item",fn:function(i){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(i.item.codigo)}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(i.item.nombre)}})],1)]]}}],null,!1,3402687621),model:{value:e.afiliado.nf_ciiu_id,callback:function(i){e.$set(e.afiliado,"nf_ciiu_id",i)},expression:"afiliado.nf_ciiu_id"}})],1):e._e()],1)],1)],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"text-xs-center text-sm-left",attrs:{xs12:"",sm4:""}},[e.stepActual>1?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",fab:"",small:"",color:"primary"},nativeOn:{click:function(i){e.stepActual--}},slot:"activator"},[a("v-icon",[e._v("arrow_back_ios")])],1),e._v(" "),a("span",[e._v("Anterior")])],1):e._e(),e._v(" "),e.stepActual<3?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",fab:"",small:"",color:"primary"},nativeOn:{click:function(i){e.stepActual++}},slot:"activator"},[a("v-icon",[e._v("arrow_forward_ios")])],1),e._v(" "),a("span",[e._v("Siguiente")])],1):e._e()],1)],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"text-xs-left",attrs:{xs6:""}},[a("v-btn",{attrs:{loading:e.loadingSubmit},on:{click:function(i){return e.refresh(null)}}},[e._v("Limpiar")])],1),e._v(" "),a("v-flex",{staticClass:"text-xs-right",attrs:{xs6:""}},[a("v-btn",{attrs:{color:"primary",loading:e.loadingSubmit},on:{click:e.submit}},[e._v("Guardar")])],1)],1)],1)},r=[],o={render:t,staticRenderFns:r};i.a=o},482:function(e,i,a){"use strict";function t(e){a(1474)}Object.defineProperty(i,"__esModule",{value:!0});var r=a(957),o=a(1476),n=a(1),s=t,d=n(r.a,o.a,!1,s,"data-v-7d628f5c",null);i.default=d.exports},756:function(e,i,a){"use strict";var t=a(13),r=a.n(t),o=a(14),n=a.n(o),s=a(7),d=a.n(s),l=a(59),c=a(253);i.a={name:"FormBasicos",props:["manager","verified","edicionTotal"],inject:["$validator"],components:{InputDate:c.default,InputDetailFlex:function(){return new Promise(function(e){e()}).then(a.bind(null,250))}},data:function(){return{menuDatex:!1,tercero:{},maxDateI:this.moment().format("YYYY-MM-DD"),maxDate:this.moment().format("DD/MM/YYYY"),minDate:"01/01/1900",filterMunicipiosExpedicion:function(e,i){var a=function(e){return null!=e?e:""},t=a(e.nombre+" "+e.nombre_departamento),r=a(i);return t.toString().toLowerCase().indexOf(r.toString().toLowerCase())>-1},filterTiposIdentidad:function(e,i){var a=function(e){return null!=e?e:""},t=a(e.abreviatura+" "+e.nombre),r=a(i);return t.toString().toLowerCase().indexOf(r.toString().toLowerCase())>-1}}},watch:{verified:function(e){e||this.$validator.reset()},"tercero.id":function(e){e&&this.$emit("verified",!0)},"tercero.gn_tipdocidentidad_id":function(e){e&&(12===e?(this.tercero.nombre1="",this.tercero.nombre2="",this.tercero.apellido1="",this.tercero.apellido2=""):this.tercero.razon_social="")},"errors.items":function(e){this.$emit("errors",!(e.filter(function(e){return"formBasicos"===e.scope}).length>0))}},computed:{requiereNovedad:function(){return!1},complementos:function(){var e=JSON.parse(d()(l.b.getters.complementosTercerosFormBasicos));return"Afiliado"===this.manager&&e.tipdocidentidades&&(e.tipdocidentidades=e.tipdocidentidades.filter(function(e){return 12!==e.id})),e},tipo_identidad:function(){return!this.tercero||1!==this.tercero.gn_tipdocidentidad_id&&12!==this.tercero.gn_tipdocidentidad_id?"text":"number"},esEmpresa:function(){return 12===this.tercero.gn_tipdocidentidad_id},longitudDocumento:function(){var e=this;if(this.complementos.tipdocidentidades&&this.complementos.tipdocidentidades.length&&this.tercero.gn_tipdocidentidad_id)return this.complementos.tipdocidentidades.find(function(i){return i.id===e.tercero.gn_tipdocidentidad_id}).longitud}},methods:{verificaId:function(){var e=this;return n()(r.a.mark(function i(){return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e.tercero.identificacion){i.next=9;break}if(e.$validator.errors.items.find(function(e){return"Identificación"===e.field})){i.next=9;break}if("Afiliado"!==e.manager){i.next=7;break}return i.next=5,e.axios.get("afiliados?id="+e.tercero.id+"&identificacion="+e.tercero.identificacion).then(function(i){200===i.status&&i.data&&i.data.data&&i.data.data.length&&(e.tercero=i.data.data[0]),e.$emit("update",e.tercero),e.$emit("verified",!0)}).catch(function(i){var a=e.$validator.fields.items.find(function(e){return"Identificación"===e.name});e.$validator.errors.items.push({id:a.id,field:a.name,msg:"Error al intentar verificar la identificación: "+i,rule:"required",scope:a.scope})});case 5:i.next=9;break;case 7:return i.next=9,e.axios.post("exists-tercero",{id:e.tercero.id,identificacion:e.tercero.identificacion}).then(function(i){var a=!0;e.tercero.digito_verificacion=i.data.dv,i.data.exists&&(a=!0,e.tercero=i.data.tercero),a&&(e.$emit("update",e.tercero),e.$emit("verified",!0))}).catch(function(i){var a=e.$validator.fields.items.find(function(e){return"Identificación"===e.name});e.$validator.errors.items.push({id:a.id,field:a.name,msg:"Error al intentar verificar la identificación: "+i,rule:"required",scope:a.scope})});case 9:case"end":return i.stop()}},i,e)}))()},validate:function(){return this.$validator.validateAll("formBasicos").then(function(e){return e})},assign:function(e){this.tercero=e,this.$emit("verified",null!==this.tercero.id),this.$emit("update",this.tercero)}}}},757:function(e,i,a){"use strict";var t=a(59);i.a={name:"FormComplementarios",props:["manager","verified","edicionTotal"],data:function(){return{tercero:{},filterMunicipios:function(e,i){var a=function(e){return null!=e?e:""},t=a(e.nombre+" "+e.nombre_departamento),r=a(i);return t.toString().toLowerCase().indexOf(r.toString().toLowerCase())>-1},ciudadanias:["Nacional","Extranjero"]}},watch:{verified:function(e){e||this.$validator.reset()},"errors.items":function(e){this.$emit("errors",!(e.filter(function(e){return"formComplementarios"===e.scope}).length>0))}},computed:{requiereNovedad:function(){return this.tercero&&this.tercero.id&&"Afiliado"===this.manager&&11!==this.tercero.estado&&!this.edicionTotal},complementos2:function(){return t.b.getters.complementosFormAfiliados},complementosnomenclaturas:function(){return t.b.getters.complementosNomenclaturas},complementos:function(){return t.b.getters.complementosTercerosFormComplementarios}},methods:{validate:function(){return this.$validator.validateAll("formComplementarios").then(function(e){return e})},assign:function(e){this.tercero=e}},mounted:function(){this.$validator.extend("verify_direccion",{getMessage:function(e){return"El campo dirección no debe contener carácteres especiales."},validate:function(e){return new RegExp("^[a-zA-Z0-9_ ]*$").test(e)}})}}},782:function(e,i,a){"use strict";function t(e){a(783)}var r=a(756),o=a(785),n=a(1),s=t,d=n(r.a,o.a,!1,s,"data-v-3bd0c2d7",null);i.a=d.exports},783:function(e,i,a){var t=a(784);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);a(456)("7eec8188",t,!0,{})},784:function(e,i,a){i=e.exports=a(455)(!0),i.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"FormBasicos.vue",sourceRoot:""}])},785:function(e,i,a){"use strict";var t=function(){var e=this,i=e.$createElement,a=e._self._c||i;return a("v-form",{attrs:{"data-vv-scope":"formBasicos"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Tipo identificación",items:e.complementos.tipdocidentidades,"item-value":"id","item-text":"nombre",name:"gn_tipocidentidad_id","data-vv-as":"Tipo identificación",required:"","error-messages":e.errors.collect("gn_tipocidentidad_id"),disabled:e.verified&&(e.requiereNovedad||!e.tercero.id),filter:e.filterTiposIdentidad,"prepend-icon":"person_pin"},scopedSlots:e._u([{key:"item",fn:function(i){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(i.item.abreviatura)}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(i.item.nombre)}})],1)]]}}]),model:{value:e.tercero.gn_tipdocidentidad_id,callback:function(i){e.$set(e.tercero,"gn_tipdocidentidad_id",i)},expression:"tercero.gn_tipdocidentidad_id"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[a("v-layout",{staticClass:"pt-2 px-2",attrs:{"align-center":""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.identificacion",expression:"'tercero.identificacion'"},{name:"validate",rawName:"v-validate",value:"max:"+e.longitudDocumento+("text"===e.tipo_identidad?"|alpha_num":"|numeric")+"|required",expression:"'max:' + longitudDocumento + (tipo_identidad === 'text' ? '|alpha_num' : '|numeric') + '|required'"}],attrs:{label:"Identificación",name:"Identificación",required:"",type:e.tipo_identidad,"error-messages":e.errors.collect("Identificación"),disabled:(!e.tercero.gn_tipdocidentidad_id||e.verified)&&(e.requiereNovedad||!e.tercero.id),maxlength:e.longitudDocumento,counter:e.longitudDocumento,suffix:!e.tercero.digito_verificacion||null===e.tercero.digito_verificacion||12!==e.tercero.gn_tipdocidentidad_id&&1!==e.tercero.gn_tipdocidentidad_id?"":"DV","prepend-icon":"subtitles"},on:{keyup:function(i){if(!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter"))return null;e.tercero.gn_tipdocidentidad_id&&!e.verified&&e.verificaId()}},model:{value:e.tercero.identificacion,callback:function(i){e.$set(e.tercero,"identificacion",i)},expression:"tercero.identificacion"}},["Afiliado"===e.manager||null===e.tercero.digito_verificacion||12!==e.tercero.gn_tipdocidentidad_id&&1!==e.tercero.gn_tipdocidentidad_id?e._e():a("v-avatar",{attrs:{slot:"append",color:"primary",size:"26"},slot:"append"},[a("span",{staticClass:"white--text subheading"},[e._v(e._s(e.tercero.digito_verificacion))])])],1),e._v(" "),e.tercero.gn_tipdocidentidad_id?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",disabled:e.verified||!e.tercero.identificacion,flat:"",icon:"",color:"accent"},on:{click:e.verificaId},slot:"activator"},[a("v-icon",[e._v(e._s(e.verified?"done_all":"done"))])],1),e._v(" "),a("span",[e._v(e._s(e.verified?"Identificación verificada":"Verificar identificación"))])],1):e._e()],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},["Afiliado"!==e.manager?a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Municipio expedición",items:e.complementos.municipios,"item-value":"id","item-text":"nombre",name:"Municipio expedición",required:"","error-messages":e.errors.collect("Municipio expedición"),disabled:!e.verified,filter:e.filterMunicipiosExpedicion,"prepend-icon":"location_city"},scopedSlots:e._u([{key:"item",fn:function(i){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(i.item.nombre)}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(i.item.nombre_departamento)}})],1)]]}}],null,!1,817490016),model:{value:e.tercero.gn_munexpedicion_id,callback:function(i){e.$set(e.tercero,"gn_munexpedicion_id",i)},expression:"tercero.gn_munexpedicion_id"}}):e._e(),e._v(" "),"Afiliado"===e.manager?[a("input-date",{directives:[{name:"validate",rawName:"v-validate",value:"required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY"+(e.verified?"|date_between:"+e.minDate+","+e.maxDate+",true":""),expression:"'required|fechaValida:DD/MM/YYYY|date_format:DD/MM/YYYY' + (!verified ? '' : '|date_between:' + minDate + ',' + maxDate + ',true')"}],attrs:{label:"Fecha expedicion (Día/Mes/Año)",format:"DD/MM/YYYY",name:"Fecha expedición",max:e.maxDateI,"error-messages":e.errors.collect("Fecha expedición"),disabled:!e.verified},model:{value:e.tercero.fecha_expedicion,callback:function(i){e.$set(e.tercero,"fecha_expedicion",i)},expression:"tercero.fecha_expedicion"}})]:e._e()],2)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[e.esEmpresa?a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.razon_social",expression:"'tercero.razon_social'"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"Razón social",attrs:{label:"Razón social",name:"Razón social",required:"","error-messages":e.errors.collect("Razón social"),disabled:!e.verified||e.requiereNovedad,"prepend-icon":"assignment"},model:{value:e.tercero.razon_social,callback:function(i){e.$set(e.tercero,"razon_social",i)},expression:"tercero.razon_social"}})],1):[a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.apellido1",expression:"'tercero.apellido1'"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Primer apellido",name:"Primer apellido",required:"","error-messages":e.errors.collect("Primer apellido"),disabled:!e.verified||e.requiereNovedad,"prepend-icon":"person"},model:{value:e.tercero.apellido1,callback:function(i){e.$set(e.tercero,"apellido1",i)},expression:"tercero.apellido1"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.apellido2",expression:"'tercero.apellido2'"}],attrs:{label:"Segundo apellido",disabled:!e.verified||e.requiereNovedad,"prepend-icon":"person"},model:{value:e.tercero.apellido2,callback:function(i){e.$set(e.tercero,"apellido2",i)},expression:"tercero.apellido2"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.nombre1",expression:"'tercero.nombre1'"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Primer nombre",name:"Primer nombre",required:"","error-messages":e.errors.collect("Primer nombre"),disabled:!e.verified||e.requiereNovedad,"prepend-icon":"person"},model:{value:e.tercero.nombre1,callback:function(i){e.$set(e.tercero,"nombre1",i)},expression:"tercero.nombre1"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.nombre2",expression:"'tercero.nombre2'"}],attrs:{label:"Segundo nombre",disabled:!e.verified||e.requiereNovedad,"prepend-icon":"person"},model:{value:e.tercero.nombre2,callback:function(i){e.$set(e.tercero,"nombre2",i)},expression:"tercero.nombre2"}})],1)]],2)],1)},r=[],o={render:t,staticRenderFns:r};i.a=o},786:function(e,i,a){"use strict";function t(e){a(787)}var r=a(757),o=a(789),n=a(1),s=t,d=n(r.a,o.a,!1,s,"data-v-f4efcafe",null);i.a=d.exports},787:function(e,i,a){var t=a(788);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);a(456)("dcc7709a",t,!0,{})},788:function(e,i,a){i=e.exports=a(455)(!0),i.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"FormComplementarios.vue",sourceRoot:""}])},789:function(e,i,a){"use strict";var t=function(){var e=this,i=e.$createElement,a=e._self._c||i;return a("v-form",{attrs:{"data-vv-scope":"formComplementarios"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.telefono_fijo",expression:"'tercero.telefono_fijo'"},{name:"number",rawName:"v-number",value:"tercero.telefono_fijo",expression:"'tercero.telefono_fijo'"},{name:"validate",rawName:"v-validate",value:"numeric|max:10",expression:"'numeric|max:10'"}],attrs:{label:"Teléfono fijo",name:"Telefono fijo","data-vv-validate-on":"input|change|custom|focus|blur","error-messages":e.errors.collect("Telefono fijo"),disabled:!e.verified,"prepend-icon":"local_phone"},model:{value:e.tercero.telefono_fijo,callback:function(i){e.$set(e.tercero,"telefono_fijo",i)},expression:"tercero.telefono_fijo"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-text-field",{directives:[{name:"number",rawName:"v-number",value:"tercero.celular",expression:"'tercero.celular'"},{name:"validate",rawName:"v-validate",value:"numeric|max:10|required",expression:"'numeric|max:10|required'"}],attrs:{label:"Celular",name:"Celular","data-vv-validate-on":"input|change|custom|focus|blur","error-messages":e.errors.collect("Celular"),disabled:!e.verified,"prepend-icon":"phone_android"},model:{value:e.tercero.celular,callback:function(i){e.$set(e.tercero,"celular",i)},expression:"tercero.celular"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md6:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"email",expression:"'email'"}],attrs:{label:"Correo electrónico",name:"Correo electrónico","data-vv-validate-on":"input|change|custom|blur","error-messages":e.errors.collect("Correo electrónico"),disabled:!e.verified,"prepend-icon":"email"},model:{value:e.tercero.correo_electronico,callback:function(i){e.$set(e.tercero,"correo_electronico",i)},expression:"tercero.correo_electronico"}})],1),e._v(" "),"Afiliado"!==e.manager?a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Ciudadanía",items:e.ciudadanias,name:"ciudadanía",required:"","error-messages":e.errors.collect("ciudadanía"),disabled:!e.verified||e.requiereNovedad,"prepend-icon":"assignment_ind"},model:{value:e.tercero.ciudadania,callback:function(i){e.$set(e.tercero,"ciudadania",i)},expression:"tercero.ciudadania"}})],1):e._e(),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Municipio residencia",items:e.complementos.municipios,"item-value":"id","item-text":"nombre",name:"Municipio residencia",required:"","error-messages":e.errors.collect("Municipio residencia"),disabled:!e.verified||e.requiereNovedad,filter:e.filterMunicipios,"prepend-icon":"location_city"},scopedSlots:e._u([{key:"item",fn:function(i){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(i.item.nombre)}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(i.item.nombre_departamento)}})],1)]]}}]),model:{value:e.tercero.gn_municipio_id,callback:function(i){e.$set(e.tercero,"gn_municipio_id",i)},expression:"tercero.gn_municipio_id"}})],1),e._v(" "),"Afiliado"===e.manager?a("v-flex",{attrs:{xs12:"",sm6:"",md2:""}},[a("v-select",{attrs:{label:"Zona",items:e.complementos2.zonas,"item-value":"id","item-text":"nombre",name:"Zona","error-messages":e.errors.collect("Zona"),disabled:!e.verified||!e.tercero.gn_municipio_id||e.requiereNovedad},model:{value:e.tercero.gn_zona_id,callback:function(i){e.$set(e.tercero,"gn_zona_id",i)},expression:"tercero.gn_zona_id"}})],1):e._e(),e._v(" "),"Afiliado"===e.manager?a("v-flex",{attrs:{xs12:"",sm6:"",md2:""}},[a("v-select",{attrs:{label:"Nomenclaturas",items:1==e.tercero.gn_zona_id?e.complementos.nomenclaturasUrbano:e.complementos.nomenclaturasRural,"item-value":"nomenclatura","item-text":"abreviatura",name:"nomenclatura","error-messages":e.errors.collect("nomenclatura"),disabled:!e.verified||!e.tercero.gn_zona_id||e.requiereNovedad},model:{value:e.tercero.nomenclatura,callback:function(i){e.$set(e.tercero,"nomenclatura",i)},expression:"tercero.nomenclatura"}})],1):e._e(),e._v(" "),a("v-flex",{attrs:{xs12:"",md4:""}},[a("v-text-field",{directives:[{name:"upper",rawName:"v-upper",value:"tercero.direccion",expression:"'tercero.direccion'"},{name:"validate",rawName:"v-validate",value:"required|verify_direccion",expression:"'required|verify_direccion'"}],attrs:{label:"Dirección",name:"Dirección",required:"","error-messages":e.errors.collect("Dirección"),disabled:!e.verified,"prepend-icon":"home"},model:{value:e.tercero.direccion,callback:function(i){e.$set(e.tercero,"direccion",i)},expression:"tercero.direccion"}})],1)],1)],1)},r=[],o={render:t,staticRenderFns:r};i.a=o},957:function(e,i,a){"use strict";var t=a(13),r=a.n(t),o=a(14),n=a.n(o),s=a(249),d=a.n(s),l=a(7),c=a.n(l),m=a(23),u=a.n(m),f=a(8),p=a.n(f),v=a(58),_=a(253),b=a(59),x=a(782),h=a(786),g=a(12),D=a(40),Y=a(248),N=a(251),q=a(6);i.a={name:"RegistroAfiliado",props:["parametros"],components:{Loading:v.default,InputDate:_.default,FormComplementarios:h.a,formBasicos:x.a},data:function(){return{flagMounted:!1,validStepBasicos:!0,validStepComplementarios:!0,estadoTercero:!1,afiliado:{},loadingSubmit:!1,edad_minima_valida:null,makeAfiliado:{id:null,nomenclatura:null,tipo_identificacion:null,as_etnia_id:null,ficha_sisben:null,puntaje_sisben:null,nivel_sisben:null,as_pobespeciale_id:null,as_regimene_id:2,as_condicion_discapacidades_id:null,as_afp_id:null,as_ccf_id:null,gn_zona_id:null,gn_vereda_id:null,gn_barrio_id:null,fecha_nacimiento:null,estado:1,gn_sexo_id:null,zona_dnp:null,apellido1:null,apellido2:null,celular:null,gn_paise_id:45,fecha_expedicion:null,correo_electronico:null,direccion:null,gn_municipio_id:null,gn_tipdocentidad_id:null,identificacion:null,nf_ciiu_id:null,nombre1:null,nombre2:null,telefono_fijo:null,nombre_completo:null,fecha_afiliacion:null,as_tipafiliado_id:null},stepActual:1,veredas:[],barrios:[],menuDate:!1,minDate:"01/01/1900",minDateI:"1900-01-01",maxDateI:"",maxDate:"",maxFechaActual:this.moment().format("YYYY-MM-DD"),maxDateAfiliacion:"",minDateAfiliacion:"01/01/1910",minDateAfiliacion2:"01/01/1910",maxFechaActualI:this.moment().format("DD/MM/YYYY"),minDateAfiliacionI:"01/01/1910",filterMunicipios:function(e,i){var a=function(e){return null!=e?e:""},t=a(e.nombre+" "+e.nombre_departamento),r=a(i);return t.toString().toLowerCase().indexOf(r.toString().toLowerCase())>-1},filterCiius:function(e,i){var a=function(e){return null!=e?e:""},t=a(e.codigo+" "+e.nombre),r=a(i);return t.toString().toLowerCase().indexOf(r.toString().toLowerCase())>-1}}},watch:{"afiliado.as_pobespeciale_id":function(e){void 0===e&&(this.afiliado.as_pobespeciale_id=null)},menuDate:function(e){var i=this;e&&this.$nextTick(function(){return i.$refs.picker.activePicker="YEAR"})},tipo_id:function(e){e&&(this.edad_minima_valida=e.edad_minima,console.log(e.edad_minima),this.afiliado.fecha_expedicion||void 0!==this.afiliado.fecha_expedicion||"0000-00-00"!==this.afiliado.fecha_expedicion||null!==this.afiliado.fecha_expedicion||(this.maxDate=this.moment().subtract(e.edad_minima,"months").format("YYYY-MM-DD")),this.minDate=this.moment().subtract(e.edad_maxima,"months").subtract(e.plazo_cambio,"days").format("YYYY-MM-DD"),this.minDateI=this.moment().subtract(e.edad_maxima,"months").subtract(e.plazo_cambio,"days").format("DD/MM/YYYY"),this.afiliado.tipo_identificacion=e.abreviatura)},"afiliado.fecha_nacimiento":function(e){if(null!==e&&void 0!==e){var i=e,a=i.split("/");this.minDateAfiliacionI=e,this.minDateAfiliacion2=a[2]+"-"+a[1]+"-"+a[0]}},"afiliado.fecha_expedicion":function(e){if(void 0!==e&&null!==e){console.log(this.edad_minima_valida);var i=e,a=i.split("/");this.maxDate=a[2]+"-"+a[1]+"-"+a[0];var t=this.maxDate;this.maxDate=this.moment(t).subtract(this.edad_minima_valida,"months").format("YYYY-MM-DD"),this.maxDateI=this.moment(t).subtract(this.edad_minima_valida,"months").format("DD/MM/YYYY")}},"afiliado.gn_municipio_id":function(e){e&&(this.afiliado.gn_zona_id&&2===this.afiliado.gn_zona_id?this.getVeredas():this.getBarrios(),this.flagMounted&&(this.afiliado.gn_barrio_id=null,this.afiliado.gn_vereda_id=null))},"afiliado.gn_zona_id":function(e){e&&(this.afiliado.gn_municipio_id&&2===e?this.getVeredas():this.getBarrios(),this.flagMounted&&(this.afiliado.gn_barrio_id=null,this.afiliado.gn_vereda_id=null))}},created:function(){this.maxDate=this.formDate((new Date).toISOString().substr(0,10)),this.maxDateAfiliacion=this.formDate((new Date).toISOString().substr(0,10))},computed:p()({},Object(q.b)(["getProfile"]),{edicionTotal:function(){return this.getProfile&&this.getProfile.roles&&this.getProfile.roles.find(function(e){return 13===e.id})},requiereRolLider:function(){return this.afiliado&&this.afiliado.id&&!this.edicionTotal},requiereNovedad:function(){return!1},errorsStep1:function(){return!this.validStepBasicos||this.errors.items.filter(function(e){return"formAfiliadoStep1"===e.scope}).length>0},errorsStep2:function(){return!this.validStepComplementarios||this.errors.items.filter(function(e){return"formAfiliadoStep2"===e.scope}).length>0},errorsStep3:function(){return this.errors.items.filter(function(e){return"formAfiliadoStep3"===e.scope}).length>0},complementos:function(){return b.b.getters.complementosFormAfiliados},tipo_id:function(){var e=this;return this.complementos.tipdocidentidades&&this.complementos.tipdocidentidades.length&&this.afiliado.gn_tipdocidentidad_id?this.complementos.tipdocidentidades.find(function(i){return i.id===e.afiliado.gn_tipdocidentidad_id}):null},zonaDNP:function(){var e=this;if(this.complementos.zonas&&this.afiliado&&this.afiliado.zona_dnp){return{zona:this.complementos.zonas.find(function(i){return i.id===(null===e.afiliado.zona_dnp.id||void 0===e.afiliado.zona_dnp.id?e.afiliado.zona_dnp:e.afiliado.zona_dnp.id)}),rn1:{ini:parseFloat(0),fin:parseFloat(44.79)},rn2:{ini:parseFloat(44.8),fin:parseFloat(51.57)}}}return null}}),beforeMount:function(){var e=this;N.a.extend("puntajeSisben",{validate:function(i,a){return new u.a(function(a){if(null!==i&&void 0!==i&&""!==i&&e.complementos.zonas){var t=i>=parseFloat(0)&&i<=parseFloat(44.79)?{valido:!0,nivel:1,mensaje:null}:i>=parseFloat(44.8)&&i<=parseFloat(51.57)?{valido:!0,nivel:2,mensaje:null}:{valido:!1,nivel:"NO APLICA",mensaje:"el puntaje no aplica para los niveles de SISBEN permitidos."};return e.afiliado.nivel_sisben=t.nivel,a({valid:t.valido,data:{message:t.mensaje}})}})},getMessage:function(e,i,a){return a.message}})},mounted:function(){if(this.refresh(),null!==this.parametros.entidad&&null!==this.parametros.entidad.id)if(void 0!==this.parametros.entidad.prop_dato&&this.parametros.entidad.prop_dato){var e=this.parametros.entidad.prop_dato,i=this.clone(this.afiliado);void 0!==this.afiliado.cabfamilia_id&&this.afiliado.cabfamilia_id&&(this.afiliado.cabfamilianterior_id=this.afiliado.cabfamilia_id),this.afiliado.cabfamilia_id=e.id,this.afiliado.telefono_fijo=e.telefono_fijo,this.afiliado.celular=e.celular,this.afiliado.direccion=this.clone(e.direccion),this.afiliado.correo_electronico=e.correo_electronico,this.afiliado.gn_municipio_id=e.gn_municipio_id,this.afiliado.municipio=e.municipio,this.afiliado.gn_zona_id=e.gn_zona_id,this.afiliado.gn_barrio_id=e.gn_barrio_id,this.afiliado.as_etnia_id=e.as_etnia_id,i.gn_paise_id=e.gn_paise_id,this.afiliado.as_pobespeciale_id=e.as_pobespeciale_id,this.afiliado.ficha_sisben=e.ficha_sisben,this.afiliado.puntaje_sisben=e.puntaje_sisben,this.afiliado.nivel_sisben=e.nivel_sisben,this.afiliado.zona_dnp=e.zona_dnp,this.afiliado.as_etnia_id=e.as_etnia_id;var a=this.afiliado.direccion.indexOf(" "),t=this.afiliado.direccion.substr(0,a);console.log(t);var r="CR"===t?1:"";r="CL"===t?2:r,r="CORREGIMIENTO"===t?3:r,r="VEREDA"===t?4:r,r="TRANSVERSAL"===t?5:r,this.afiliado.direccion=this.afiliado.direccion.substr(a+1),this.afiliado.nomenclatura=r,this.nomenclatura=r}else this.getRegistro(this.parametros.entidad.id);else this.flagMounted=!0},methods:{getRegistro:function(e){var i=this;this.loadingSubmit=!0,this.axios.get("afiliados/"+e).then(function(e){""!==e.data&&(i.afiliado=e.data.data,i.afiliado.fecha_nacimiento=i.moment(i.afiliado.fecha_nacimiento).format("DD/MM/YYYY"),i.afiliado.fecha_afiliacion=i.moment(i.afiliado.fecha_afiliacion).format("DD/MM/YYYY"),console.log(i.afiliado.fecha_afiliacion),i.afiliado.fecha_expedicion=i.moment(i.afiliado.fecha_expedicion).format("DD/MM/YYYY"),i.$refs.fBasicos.assign(i.afiliado),i.afiliado.gn_zona_id&&2===i.afiliado.gn_zona_id?i.getVeredas():i.getBarrios(),i.loadingSubmit=!1,setTimeout(function(){i.flagMounted=!0},500))}).catch(function(e){i.$store.commit(g.a,{expression:" al traer el afiliado. ",error:e})})},complementar:function(e){var i=this;this.flagMounted=!1,this.afiliado=e,this.$refs.fComplementarios.assign(this.afiliado),setTimeout(function(){i.flagMounted=!0},500)},refresh:function(){this.stepActual=1,this.afiliado=JSON.parse(c()(this.makeAfiliado)),this.$refs.fBasicos.assign(this.afiliado),this.$validator.reset()},getVeredas:function(){var e=this;this.afiliado.gn_municipio_id&&2===this.afiliado.gn_zona_id&&(this.veredas.length&&this.afiliado.gn_municipio_id===this.veredas[0].gn_municipio_id||this.axios.get("complementos/veredas/"+this.afiliado.gn_municipio_id).then(function(i){e.veredas=i.data.data}).catch(function(i){e.$store.commit(g.a,{expression:" al traer las veredas. ",error:i})}))},formDate:function(e){if(!e)return null;var i=e.split("-"),a=d()(i,3),t=a[0],r=a[1];return a[2]+"/"+r+"/"+t},getBarrios:function(){var e=this;this.afiliado.gn_municipio_id&&1===this.afiliado.gn_zona_id&&(this.barrios.length&&this.afiliado.gn_municipio_id===this.barrios[0].gn_municipio_id||this.axios.get("complementos/barrios/"+this.afiliado.gn_municipio_id).then(function(i){e.barrios=i.data.data}).catch(function(i){e.$store.commit(g.a,{expression:" al traer los barrios. ",error:i})}))},submit:function(){var e=this;return n()(r.a.mark(function i(){var a,t,o;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.$refs.fBasicos.validate();case 2:if(i.t0=i.sent,!i.t0){i.next=7;break}return i.next=6,e.$validator.validateAll("formAfiliadoStep1");case 6:i.t0=i.sent;case 7:if(!i.t0){i.next=36;break}return i.next=10,e.$refs.fComplementarios.validate();case 10:if(i.t1=i.sent,!i.t1){i.next=15;break}return i.next=14,e.$validator.validateAll("formAfiliadoStep2");case 14:i.t1=i.sent;case 15:if(!i.t1){i.next=33;break}return i.next=18,e.$validator.validateAll("formAfiliadoStep3");case 18:if(!i.sent){i.next=30;break}e.loadingSubmit=!0,a=JSON.parse(c()(e.afiliado)),4===a.as_pobespeciale_id&&1!==a.as_regimene_id||(a.ficha_sisben=null,a.puntaje_sisben=null,a.nivel_sisben="N",a.zona_dnp=null,4===a.as_pobespeciale_id&&(a.as_pobespeciale_id=null)),a.fecha_expedicion=e.afiliado.fecha_expedicion,t=a.id?"editar":"crear",a.zona_dnp=null!==a.zona_dnp&&void 0!==a.zona_dnp&&null!==a.zona_dnp.id&&void 0!==a.zona_dnp.id?a.zona_dnp.id:a.zona_dnp,console.log("copia afiliado ",a),o="crear"===t?e.axios.post("afiliados",a):e.axios.put("afiliados/"+a.id,a),o.then(function(i){e.$store.commit(g.b,{msg:"El afiliado fue "+("editar"===t?"editado":"creado")+" correctamente.",color:"success"}),e.$store.commit(Y.b,{item:i.data,estado:t,key:e.parametros.key}),e.$store.dispatch(D.c,{contexto:e,itemId:e.parametros.tabOrigin}),e.$store.commit("reloadTable","tableItemAffiliate")}).catch(function(i){e.loadingSubmit=!1,e.$store.commit(g.a,{expression:" al intentar guardar el registro. ",error:i})}),i.next=31;break;case 30:e.stepActual=3;case 31:i.next=34;break;case 33:e.stepActual=2;case 34:i.next=37;break;case 36:e.stepActual=1;case 37:case"end":return i.stop()}},i,e)}))()}}}}});
//# sourceMappingURL=33.38656023875faa5aaa99.js.map