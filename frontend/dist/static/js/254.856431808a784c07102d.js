webpackJsonp([254],{1180:function(e,t,o){"use strict";var r=o(13),n=o.n(r),i=o(14),a=o.n(i),d=o(59),s=o(40),c=o(248),l=o(12);t.a={name:"RegistroDependencia",props:["parametros"],components:{Postulador:function(){return o.e(287).then(o.bind(null,747))}},data:function(){return{buscandoCodigo:!1,dialogCodigo:!1,ordenEdit:!1,dependencia:{},abrir:!1}},computed:{complementosFormCxc:function(){return d.b.getters.complementosFormComDiario},tapTitulo:function(){return(this.dependencia.id?"Edicion":"Registro")+" de Dependencia"}},methods:{findByCodigo:function(){var e=this;this.dependencia.codigo&&(this.buscandoCodigo=!0,this.axios.get("pr_dependencias/codigo/"+this.dependencia.codigo).then(function(t){t.data.exists&&(e.$store.commit(l.b,{msg:"El codigo de la dependencia existe",color:"success"}),e.formReset(),e.dependencia=t.data.data,e.dialogCodigo=!0),e.buscandoCodigo=!1}).catch(function(t){console.log(t),e.buscandoCodigo=!1,e.$store.commit(l.b,{msg:"Hay un error al consultar el codigo. "+t.response,color:"danger"})}))},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},submit:function(){var e=this;return a()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validador("formRegistroDependencia");case 2:if(!t.sent){t.next=6;break}e.dependencia.id?e.axios.put("pr_dependencias/"+e.dependencia.id,e.dependencia).then(function(t){e.$store.commit(l.b,{msg:"El registro de la dependencia se actualizo correctamente",color:"success"}),e.formReset(),e.$store.dispatch(s.c,{contexto:e,itemId:e.parametros.tabOrigin}),e.$store.commit(c.E,{item:t.data.data,estado:"editar",key:e.parametros.key})}).catch(function(t){console.log(t),e.$store.commit(l.b,{msg:"Hay un error al guardar el registro. "+t.response,color:"danger"})}):e.axios.post("pr_dependencias",e.dependencia).then(function(t){e.$store.commit(l.b,{msg:"El registro de la dependencia se creó correctamente",color:"success"}),e.formReset(),e.$store.dispatch(s.c,{contexto:e,itemId:e.parametros.tabOrigin}),e.$store.commit(c.E,{item:t.data.data,estado:"crear",key:e.parametros.key})}).catch(function(t){console.log(t),e.$store.commit(l.b,{msg:"Hay un error al guardar el registro. "+t.response,color:"danger"})}),t.next=7;break;case 6:e.$store.commit(l.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 7:case"end":return t.stop()}},t,e)}))()},editarByCodigo:function(){this.dialogCodigo=!1,this.ordenEdit=!0},cerrarByCodigo:function(){this.formReset(),this.ordenEdit=!1,this.dialogCodigo=!1},formReset:function(){this.dependencia={id:null,tercero:null},this.buscandoCodigo=!1,this.dialogCodigo=!1,this.ordenEdit=!1},seleccionTercero:function(e){var t=this;null!==e&&null!==e.id&&""!==e.id&&void 0!==e.id&&e.id!==this.dependencia.tercero.id&&this.axios.get("empleado/tercero/"+e.id).then(function(e){e.data.exists?t.procesarTercero(e.data.tercero):t.$store.commit(l.b,{msg:"No podemos recuperar los datos del tercero. Intente de nuevo",color:"danger"})}).catch(function(e){t.$store.commit(l.a,{expression:" Al intentar consultar codigo. ",error:e})})},procesarTercero:function(e){null===e.municipio&&(e.municipio={nombre:"",nombre_departamento:""}),this.dependencia.tercero=e,this.dependencia.gn_tercero_id=e.id},getRegistro:function(e){var t=this;this.axios.get("pr_dependencias/"+e).then(function(e){e.data.exists&&t.edit(e.data.data)}).catch(function(e){t.$store.commit(l.a,{expression:" al traer el subgrupo. ",error:e})})},edit:function(e){this.ordenEdit=!0,this.dependencia=e}},mounted:function(){null!==this.parametros.entidad&&this.getRegistro(this.parametros.entidad.id),this.$validator.localize("es")}}},2103:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("v-card",[o("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[o("v-toolbar-title",[e._v(" "+e._s(e.tapTitulo)+" ")])],1),e._v(" "),o("v-card-text",[o("v-form",{attrs:{"data-vv-scope":"formRegistroDependencia"}},[o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{xs12:"",sm12:"",md4:"",lg4:""}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:16",expression:"'required|max:16'"}],key:"codigo",attrs:{label:"Codigo",name:"codigo","error-messages":e.errors.collect("codigo"),disabled:e.ordenEdit,"persistent-hint":"",hint:e.buscandoCodigo?"Estamos buscando el codigo":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findByCodigo(t)},blur:e.findByCodigo},model:{value:e.dependencia.codigo,callback:function(t){e.$set(e.dependencia,"codigo",t)},expression:"dependencia.codigo"}})],1),e._v(" "),o("v-flex",{attrs:{xs12:"",sm12:"",md8:"",lg8:""}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombre",attrs:{label:"Nombre",name:"nombre","error-messages":e.errors.collect("nombre"),required:""},model:{value:e.dependencia.nombre,callback:function(t){e.$set(e.dependencia,"nombre",t)},expression:"dependencia.nombre"}})],1),e._v(" "),e.abrir?o("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[o("v-autocomplete",{attrs:{label:"Centro de Costo","persistent-hint":"",items:e.complementosFormCxc.cencostos,"item-value":"id","item-text":"nombre",name:"centro de costo",required:"",clearable:""},on:{change:function(t){return e.dependencia.nf_cencosto_id=t}},scopedSlots:e._u([{key:"item",fn:function(t){return[[o("v-list-tile-content",[o("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}}),e._v(" "),o("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.codigo)}})],1)]]}}],null,!1,3181165253),model:{value:e.dependencia.nf_cencosto_id,callback:function(t){e.$set(e.dependencia,"nf_cencosto_id",t)},expression:"dependencia.nf_cencosto_id"}})],1):e._e(),e._v(" "),e.abrir?o("v-flex",{attrs:{xs12:"",sm12:"",md112:"",lg12:""}},[o("postulador",{ref:"postulaTercero",attrs:{nodata:"Busqueda por nombre o número de documento.",itemtext:"identificacion",datatitle:"identificacion_completa",datasubtitle:"nombre_completo",filter:"identificacion_completa,nombre_completo",label:"NIT",scope:"formRegistroDependencia",entidad:"terceros",preicon:"person",value:e.dependencia.tercero,clearable:""},on:{change:function(t){return e.dependencia.gn_tercero_id=t},objectReturn:function(t){return e.seleccionTercero(t)}}})],1):e._e(),e._v(" "),e.abrir?o("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[o("v-text-field",{attrs:{label:"Representante",value:e.dependencia.tercero?e.dependencia.tercero.nombre_completo:null,readonly:""}})],1):e._e(),e._v(" "),e.abrir?o("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[o("v-text-field",{attrs:{label:"Ciudad",value:e.dependencia.tercero?e.dependencia.tercero.municipio.nombre+" - "+e.dependencia.tercero.municipio.nombre_departamento:null,readonly:""}})],1):e._e()],1)],1)],1)],1),e._v(" "),o("v-card-actions",[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{staticClass:"text-xs-right",attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[o("v-btn",{attrs:{color:"primary"},on:{click:e.submit}},[e._v("\n            Guardar\n          ")])],1)],1)],1)],1),e._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.dialogCodigo,callback:function(t){e.dialogCodigo=t},expression:"dialogCodigo"}},[o("v-card",[o("v-card-title",{staticClass:"subheading text-xs-center grey lighten-3 font-weight-bold",domProps:{textContent:e._s("CÓDIGO DE LA DEPENDENCIA")}}),e._v(" "),o("v-card-text",{staticClass:"text-xs-justify"},[e._v("El código de la dependencia ya esta siendo utilizado ¿Desea cargar los datos para su actualización o utilizar otro código?")]),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"primary darken-1",flat:""},on:{click:e.editarByCodigo}},[e._v("Cargar datos")]),e._v(" "),o("v-btn",{attrs:{color:"grey darken-1",flat:""},on:{click:e.cerrarByCodigo}},[e._v("Cerrar")])],1)],1)],1)],1)},n=[],i={render:r,staticRenderFns:n};t.a=i},635:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(1180),n=o(2103),i=o(1),a=i(r.a,n.a,!1,null,null,null);t.default=a.exports}});
//# sourceMappingURL=254.856431808a784c07102d.js.map