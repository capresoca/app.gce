webpackJsonp([349],{1415:function(i,e,a){"use strict";function t(i){a(1416)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(942),o=a(1418),r=a(1),l=t,s=r(n.a,o.a,!1,l,"data-v-6e9ac108",null);e.default=s.exports},1416:function(i,e,a){var t=a(1417);"string"==typeof t&&(t=[[i.i,t,""]]),t.locals&&(i.exports=t.locals);a(456)("74767b9d",t,!0,{})},1417:function(i,e,a){e=i.exports=a(455)(!0),e.push([i.i,"","",{version:3,sources:[],names:[],mappings:"",file:"DetalleGeneralNucleoFamiliar.vue",sourceRoot:""}])},1418:function(i,e,a){"use strict";var t=function(){var i=this,e=i.$createElement,a=i._self._c||e;return a("v-container",{staticClass:"pa-0",attrs:{fluid:"","grid-list-xl":""}},[a("loading",{model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}}),i._v(" "),"Cotizante"===i.item.tipo_afiliado.nombre||"Cabeza de familia"===i.item.tipo_afiliado.nombre?a("v-flex",{staticClass:"text-xs-right pr-0 pt-0 pb-1"},[i.item?a("v-btn",{staticClass:"mr-0",attrs:{small:"",color:"primary",dark:""},on:{click:function(e){i.cardDialog=!i.cardDialog}}},[i._v("Agregar Beneficiario")]):i._e()],1):i._e(),i._v(" "),a("v-slide-y-transition",[a("v-card",{directives:[{name:"show",rawName:"v-show",value:i.cardDialog,expression:"cardDialog"}],key:"seccion1_03"},[a("v-form",{attrs:{"data-vv-scope":"formFamiliar"}},[a("v-card-title",{staticClass:"grey lighten-3"},[a("span",{staticClass:"title",domProps:{textContent:i._s("Beneficiario")}})]),i._v(" "),a("v-container",{staticClass:"pa-3"},[a("v-layout",{key:"seccion1_04",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm8:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required|afiliadoPermitido",expression:"'required|afiliadoPermitido'"}],ref:"buscarAfiliado",attrs:{"no-data":"Busqueda por nombre o número de documento.",hint:"identificacion_completa","item-text":"nombre_completo","data-title":"identificacion_completa","data-subtitle":"nombre_completo",label:"Afiliado",entidad:"afiliados",preicon:"person",name:"Afiliado",rules:"required|afiliadoPermitido","error-messages":i.errors.collect("Afiliado"),"no-btn-edit":"",clearable:""},on:{changeid:function(e){return i.idBeneficiario=e}},model:{value:i.beneficiario,callback:function(e){i.beneficiario=e},expression:"beneficiario"}})],1),i._v(" "),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"parentesco",attrs:{items:i.complementosFormBeneficiario.parentescos,"item-text":"nombre","prepend-icon":"supervised_user_circle",label:"Parentesco",name:"parentesco","return-object":"","error-messages":i.errors.collect("parentesco")},on:{change:function(e){return i.familiar.as_parentesco_id=e?e.id:null}},model:{value:i.parentesco,callback:function(e){i.parentesco=e},expression:"parentesco"}})],1)],1)],1)],1),i._v(" "),a("v-card-actions",{staticClass:"grey lighten-4"},[a("v-spacer"),i._v(" "),a("v-btn",{attrs:{flat:"",small:"",color:"primary",dark:""},domProps:{textContent:i._s("Cancelar")},on:{click:function(e){return e.preventDefault(),i.close(e)}}}),i._v(" "),a("v-btn",{attrs:{flat:"",small:"",color:"primary",dark:""},domProps:{textContent:i._s("Registrar")},on:{click:function(e){return e.preventDefault(),i.agregar()}}})],1)],1)],1),i._v(" "),a("v-slide-y-transition",{attrs:{group:""}},[i.item&&i.nucleo?a("v-layout",{key:"seccion1_1",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[a("v-subheader",[i._v("Miembros")]),i._v(" "),a("v-expansion-panel",{staticClass:"v-expansion-panel-pi",attrs:{focusable:""}},i._l(i.nucleo,function(e,t){return a("v-expansion-panel-content",{key:t},[a("v-list-tile",{attrs:{slot:"header"},on:{click:function(i){}},slot:"header"},[a("v-list-tile-action",[a("span",{staticStyle:{"font-size":"25px !important"},domProps:{textContent:i._s(e.afiliado.emoticon)}})]),i._v(" "),a("v-list-tile-content",{staticClass:"truncate-content"},[a("v-list-tile-title",[i._v(i._s(e.afiliado.nombre_completo))]),i._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:i._s("<v-chip label small class='teal lighten-2 white--text pa-1 caption' style='border-radius: 4px'>"+e.tipo+"</v-chip>\n                - "+e.parentesco)}})],1),i._v(" "),a("v-list-tile-action"),i._v(" "),a("v-list-tile-action",[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"info"},on:{click:function(a){a.stopPropagation(),i.$store.commit("NAV_ADD_ITEM",{ruta:"detalleGeneralAfiliado",titulo:"Detalle afiliado",parametros:{entidad:e.afiliado,tabOrigin:i.$store.state.nav.currentItem.split("tab-")[1]}})}},slot:"activator"},[a("v-icon",{domProps:{textContent:i._s("info")}})],1),i._v(" "),a("span",[i._v("Más información")])],1)],1),i._v(" "),"xxx"===e.afiliado.as_tipafiliado_id?a("v-list-tile-action",[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"accent"},on:{click:function(a){return a.preventDefault(),i.deleteBeneficiario(e)}},slot:"activator"},[a("v-icon",{domProps:{textContent:i._s("delete")}})],1),i._v(" "),a("span",[i._v("Eliminar")])],1)],1):i._e()],1),i._v(" "),a("v-container",{attrs:{fluid:"","grid-list-xl":""}},[a("v-layout",{attrs:{"align-center":""}},[a("v-flex",{attrs:{xs12:""}},[a("detalle-general-basico",{attrs:{afiliado:e.afiliado,"afiliado-id":e.afiliado.id}})],1)],1)],1)],1)}),1)],1)],1):a("v-layout",{key:"seccion1_2"},[a("v-subheader",[i._v("No hay miembros en el núcleo familiar ")])],1)],1)],1)},n=[],o={render:t,staticRenderFns:n};e.a=o},942:function(i,e,a){"use strict";var t=a(13),n=a.n(t),o=a(14),r=a.n(o),l=a(23),s=a.n(l),c=a(59),d=a(58),f=a(12),u=a(251);e.a={name:"DetalleGeneralNucleoFamiliar",props:{afiliado:{type:Object,default:null},afiliadoId:{type:Number,default:0}},data:function(){return{cardDialog:!1,loading:!1,item:null,nucleo:[],familiar:{padre:null},parentesco:null,beneficiario:null,idBeneficiario:null}},components:{Loading:d.default,PostuladorV2:function(){return new Promise(function(i){i()}).then(a.bind(null,61))},InputDetailFlex:function(){return new Promise(function(i){i()}).then(a.bind(null,250))},DetalleEntidad:function(){return a.e(294).then(a.bind(null,823))},DetalleGeneralBasico:function(){return a.e(299).then(a.bind(null,937))}},filters:{dateDMA:function(i){if(i){var e=i.split("-");return e[2]+"-"+e[1]+"-"+e[0]}return""}},created:function(){var i=this;this.formReset(),this.afiliado&&this.afiliado.id?this.item=this.afiliado:this.getData(),u.a.extend("afiliadoPermitido",{validate:function(e){return new s.a(function(a){if(null!==e&&void 0!==e&&""!==e){var t=i.item.id===e.id?{valido:!1,mensaje:"El afiliado seleccionado debe ser diferente al afiliado Cabeza de familia."}:i.item.beneficiarios.find(function(i){return i.id===e.id})?{valido:!1,mensaje:"El afiliado seleccionado ya se encuentra en el listado de beneficiarios."}:{valido:!0,mensaje:null};return a({valid:t.valido,data:{message:t.mensaje}})}})},getMessage:function(i,e,a){return a.message}})},computed:{complementosFormBeneficiario:function(){return c.b.getters.complementosFormBeneficiario}},watch:{item:function(i){var e=this;this.nucleo=[],i&&(i.cabeza&&this.nucleo.push({tipo:"Cabeza de familia",parentesco:null!==i.cabeza.as_parentesco_id&&3!==i.cabeza.as_parentesco_id||1!==i.cabeza.as_regimene_id?"":(1===i.cabeza.gn_sexo_id?"M":"P")+"adre",afiliado:i.cabeza}),i.beneficiarios.length&&i.beneficiarios.forEach(function(i){e.nucleo.push({tipo:"Beneficiario",parentesco:i.parentesco?i.parentesco.nombre:"",afiliado:i})}))},beneficiario:function(i){if(console.log("value 1",i),i){var e=i.cabfamilia_id;this.familiar.id=i.id,this.familiar.cabfamilianterior_id=i.cabfamilia_id?e:null,this.familiar.cabfamilia_id=this.item?this.item.id:null,this.familiar.cabeza=this.item}else this.familiar.cabfamilianterior_id=null,this.familiar.cabfamilia_id=null,this.familiar.cabeza=null},cardDialog:function(i){!1===i&&this.close()}},methods:{formReset:function(){this.parentesco=null,this.beneficiario=null,this.idBeneficiario=null,this.familiar={id:null,cabeza:null,cabfamilia_id:null,cabfamilianterior_id:null,as_parentesco_id:null}},close:function(){this.$refs.buscarAfiliado.reset(),this.$validator.reset(),this.formReset(),this.cardDialog=!1},validador:function(i){return this.$validator.validateAll(i).then(function(i){return i})},agregar:function(){var i=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.validador("formFamiliar");case 2:if(!e.sent){e.next=5;break}i.loading=!0,i.axios.post("afiliados/beneficiario/"+i.familiar.id,i.familiar).then(function(e){""!==e.data&&(i.$store.commit(f.b,{msg:"El beneficiario se agrego correctamente. ",color:"success"}),console.log("sss",e.data),i.nucleo.push({tipo:"Beneficiario",parentesco:e.data.data.parentesco?e.data.data.parentesco.nombre:"",afiliado:e.data.data}),i.close(),i.loading=!1)}).catch(function(e){i.loading=!1,i.$store.commit(f.a,{expression:" al guardar datos del núcleo familiar. ",error:e})});case 5:case"end":return e.stop()}},e,i)}))()},deleteBeneficiario:function(i){var e=i.afiliado.cabfamilianterior_id;this.familiar.id=i.afiliado.id,this.familiar.cabfamilia_id=e,this.familiar.cabfamilianterior_id=null,this.nucleo.splice(this.item.beneficiarios.indexOf(i),1),console.log("delet",i)},getData:function(){var i=this;this.loading=!0,this.axios.get("afiliados/"+this.afiliadoId).then(function(e){""!==e.data&&(i.item=e.data.data,i.loading=!1)}).catch(function(e){i.loading=!1,i.$store.commit(f.a,{expression:" al traer los datos del núcleo familiar. ",error:e})})}}}}});
//# sourceMappingURL=349.6e64076b54c6295afdc1.js.map