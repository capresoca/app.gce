webpackJsonp([313,292],{1117:function(t,e,a){"use strict";var i=a(13),n=a.n(i),o=a(14),r=a.n(o),s=a(58),l=a(764);e.a={name:"RegistroPerfeccionamiento",props:["value","parent"],components:{Loading:s.default,InputFileV2:l.default,Confirmar:function(){return a.e(289).then(a.bind(null,749))}},data:function(){return{dialogA:{loading:!1,visible:!1,content:null},loading:!1}},created:function(){},watch:{},methods:{enviominuta:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("archivo_minuta",t.archivo_minuta),a.append("minuta_firmada",t.minuta_firmada),this.axios.post("minuta-firmada/"+t.id,a).then(function(t){e.$store.commit("CONTRATO_RELOAD_ITEM",{item:{},estado:"reload",key:null}),e.$store.commit("SNACK_SHOW",{msg:"La minuta del contrato se ha cargado correctamente. ",color:"success"}),e.loading=!1}).catch(function(a){e.loading=!1,e.$nextTick(function(){t.archivo_minuta=null}),e.$store.commit("SNACK_ERROR_LIST",{expression:" al guardar la minuta del contrato. ",error:a})})},envioGarantia:function(t){var e=this;this.loading=!0;var a=new FormData;a.append("archivo",t.archivo),a.append("gn_archivo",t.gn_archivo),this.axios.post("estpregarantias/"+t.id,a).then(function(t){e.$store.commit("CONTRATO_RELOAD_ITEM",{item:{},estado:"reload",key:null}),e.$store.commit("SNACK_SHOW",{msg:"La garantía se ha cargado correctamente. ",color:"success"}),e.loading=!1}).catch(function(a){console.log("entra"),e.loading=!1,e.$nextTick(function(){t.archivo=null}),e.$store.commit("SNACK_ERROR_LIST",{expression:" al guardar la garantía. ",error:a})})},confirm:function(){var t=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$validator.validateAll();case 2:if(!e.sent){e.next=5;break}t.dialogA.content="El contrato será perfeccionado, si decide continuar, los datos no se podran editar nuevamente.<br/> <strong>¿Está seguro de confirmar los datos?</strong>",t.dialogA.visible=!0;case 5:case"end":return e.stop()}},e,t)}))()},cancelaConfirmacion:function(){this.dialogA.loading=!1,this.dialogA.visible=!1,this.dialogA.content=null},aceptaConfirmacion:function(){this.dialogA.loading=!0,this.value.estado="Legalizado",this.submit()},submit:function(){var t=this;this.loading=!0,this.axios.put("minutas/"+this.value.id,this.value).then(function(e){t.$store.commit("CONTRATO_RELOAD_ITEM",{item:e.data.data,estado:"reload",key:null}),t.$store.commit("SNACK_SHOW",{msg:"El contrato se ha perfeccionado correctamente. ",color:"success"}),t.$emit("input",e.data.data),t.loading=!1,t.cancelaConfirmacion()}).catch(function(e){t.loading=!1,t.dialogA.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:" al perfeccionar el contrato. ",error:e})})}}}},1959:function(t,e,a){"use strict";function i(t){a(1960)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1117),o=a(1962),r=a(1),s=i,l=r(n.a,o.a,!1,s,"data-v-df99dbbc",null);e.default=l.exports},1960:function(t,e,a){var i=a(1961);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(456)("6059f798",i,!0,{})},1961:function(t,e,a){e=t.exports=a(455)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroPerfeccionamiento.vue",sourceRoot:""}])},1962:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",{staticClass:"pa-0"},[a("loading",{model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}}),t._v(" "),a("v-card-text",[t.value&&t.value.rp?[a("v-list",{attrs:{"three-line":""}},[a("v-list-tile",[a("v-list-tile-avatar",{staticClass:"white--text",attrs:{color:"purple"}},[t._v("RP")]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("Registro presupuestal No. "+t._s(t.value.rp.consecutivo)+" de "+t._s(t.value.rp.fecha))]),t._v(" "),a("v-list-tile-sub-title",[t._v("valor: "+t._s(t.currency(t.value.rp.valor_compromiso)))]),t._v(" "),a("v-list-tile-sub-title",[t._v(t._s(t.value.rp.observaciones))])],1),t._v(" "),a("v-list-tile-action",[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",icon:"",color:"green"},on:{click:function(e){return e.stopPropagation(),t.filePrint("reporte-pr-rp&id="+t.value.rp.id)}},slot:"activator"},[a("v-icon",[t._v("far fa-file-pdf")])],1),t._v(" "),a("span",[t._v("Vista documento")])],1)],1)],1)],1),t._v(" "),a("v-card",{staticClass:"mb-2"},[a("v-card-title",[a("strong",[t._v("Minuta del contrato")])]),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{items:[t.value],"hide-actions":"","hide-headers":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",[a("v-avatar",{staticClass:"white--text",attrs:{color:"primary",size:"40"}},[a("v-icon",{attrs:{color:"white"}},[t._v("receipt")])],1)],1),t._v(" "),a("td",[a("strong",[t._v("Minuta contrato No. "+t._s(e.item.numero_contrato))])]),t._v(" "),a("td",{attrs:{width:"50%"}},[a("input-file-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mb-2",attrs:{name:"minuta"+e.index,"error-messages":t.errors.collect("minuta"+e.index),"data-vv-as":"Minuta",label:"Archivo","file-name":e.item.archivo_minuta?e.item.archivo_minuta.nombre:null,required:"",accept:"application/pdf",hint:"Extenciones aceptadas: pdf","prepend-icon":"description"},on:{input:function(a){return t.enviominuta(e.item)}},model:{value:e.item.archivo_minuta,callback:function(a){t.$set(e.item,"archivo_minuta",a)},expression:"props.item.archivo_minuta"}})],1)]}}],null,!1,3474191324)})],1),t._v(" "),a("v-card",[a("v-card-title",[a("strong",[t._v("Garantías")])]),t._v(" "),t.value&&t.value.proceso_contractual&&t.value.proceso_contractual.estudios_previos&&t.value.proceso_contractual.estudios_previos.garantias&&t.value.proceso_contractual.estudios_previos.garantias.length?a("v-data-table",{staticClass:"elevation-1",attrs:{items:t.value.proceso_contractual.estudios_previos.garantias,"hide-actions":"","hide-headers":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",[a("v-avatar",{staticClass:"white--text",attrs:{color:"teal",size:"30"}},[t._v("\n                  "+t._s(e.index+1)+"\n                ")])],1),t._v(" "),a("td",[a("strong",[t._v(t._s(e.item.garantia.nombre))])]),t._v(" "),a("td",{attrs:{width:"50%"}},[a("input-file-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mb-2",attrs:{name:"garantia"+e.index,"error-messages":t.errors.collect("garantia"+e.index),"data-vv-as":"garantía",label:"Archivo","file-name":e.item.archivo?e.item.archivo.nombre:null,required:"",accept:"application/pdf",hint:"Extenciones aceptadas: pdf","prepend-icon":"description"},on:{input:function(a){return t.envioGarantia(e.item)}},model:{value:e.item.archivo,callback:function(a){t.$set(e.item,"archivo",a)},expression:"props.item.archivo"}})],1)]}}],null,!1,367428172)}):a("div",{staticClass:"title grey--text text-xs-center font-weight-light pa-2"},[t._v("\n            El proceso contractual no registra requerimientos de garantias.\n          ")])],1)]:a("div",{staticClass:"title grey--text text-xs-center font-weight-light pa-2"},[t._v("\n        El contrato no tiene registro presupuestal. "),a("v-icon",[t._v("sentiment_very_dissatisfied")])],1)],2),t._v(" "),a("v-divider"),t._v(" "),"Confirmado"===t.value.estado?a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"orange",loading:t.loading},on:{click:function(e){return e.preventDefault(),t.confirm(e)}}},[t._v("Perfeccionar contrato")])],1):t._e()],1),t._v(" "),a("confirmar",{attrs:{loading:t.dialogA.loading,value:t.dialogA.visible,content:t.dialogA.content,"requiere-motivo":!1},on:{cancelar:t.cancelaConfirmacion,aceptar:t.aceptaConfirmacion}})],1)},n=[],o={render:i,staticRenderFns:n};e.a=o},764:function(t,e,a){"use strict";function i(t){a(870)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(830),o=a(872),r=a(1),s=i,l=r(n.a,o.a,!1,s,"data-v-6aeb743a",null);e.default=l.exports},830:function(t,e,a){"use strict";e.a={name:"InputFileV2",inject:["$validator"],$_veeValidate:{name:function(){return this.name},value:function(){return this.namesArchivos}},props:{name:{type:String,default:null},label:{type:String,default:null},prependIcon:{type:String,default:"attach_file"},accept:{type:String,default:null},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},hint:{type:String,default:""},value:{type:[Object,File,String],default:null},errorMessages:Array},data:function(){return{namesArchivos:null,forceEmpty:!1}},watch:{value:function(t){var e=this;"string"==typeof t&&(this.namesArchivos=t),t||(this.namesArchivos=null,this.forceEmpty=!0,setTimeout(function(){e.forceEmpty=!1},100))},namesArchivos:function(t){null===t&&(this.$emit("input",null),this.$emit("stringFile",null))}},created:function(){"string"==typeof this.value&&(this.namesArchivos=this.value)},computed:{rules:function(){var t=[],e=this.required?"required":"";e.length&&t.push(e);var a=this.accept?"mimes:"+this.accept:"";return a.length&&t.push(a),t.join("|")}},methods:{validate:function(t){return!!this.namesArchivos||this.$validator.validateAll(t)},reset:function(){this.$validator.reset()},onFilePicked:function(t){var e=this,a=t.target.files;if(a.length){for(var i=[],n=0;n<a.length;n++)i.push(a[n].name);this.namesArchivos=i.join(" || "),this.$emit("input",this.multiple?a:a[0]),this.$emit("stringFile",this.namesArchivos)}else this.forceEmpty=!0,setTimeout(function(){e.forceEmpty=!1},100)}}}},870:function(t,e,a){var i=a(871);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(456)("65f7d417",i,!0,{})},871:function(t,e,a){e=t.exports=a(455)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"InputFileV2.vue",sourceRoot:""}])},872:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.disabled||t.forceEmpty?t._e():a("input",{ref:"inputAnexo",attrs:{accept:t.accept,type:"file",multiple:t.multiple,hidden:""},on:{change:function(e){return t.onFilePicked(e)}}}),t._v(" "),a("v-textarea",{attrs:{rows:"1","auto-grow":"",label:t.label,"prepend-icon":t.prependIcon,readonly:"","error-messages":t.errorMessages&&t.errorMessages.length?t.errorMessages+(t.hint?"... "+t.hint:""):"",hint:t.hint,"persistent-hint":"",clearable:t.clearable,disabled:t.disabled,loading:t.loading},nativeOn:{click:function(e){return t.$refs.inputAnexo.click()}},model:{value:t.namesArchivos,callback:function(e){t.namesArchivos=e},expression:"namesArchivos"}})],1)},n=[],o={render:i,staticRenderFns:n};e.a=o}});
//# sourceMappingURL=313.1124703c7c49804d9a4f.js.map