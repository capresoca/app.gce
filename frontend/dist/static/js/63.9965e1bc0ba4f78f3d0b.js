webpackJsonp([63,371],{1119:function(t,a,n){"use strict";var i=n(13),e=n.n(i),o=n(14),r=n.n(o),c=n(58),s=n(922);a.a={name:"MinutaContrato",props:["parametros"],components:{Loading:c.default,RegistroMinuta:s.default},data:function(){return{loading:!1,loadingPrint:!1,contrato:null}},created:function(){this.getRegistro()},methods:{cancelar:function(){this.$store.dispatch("NAV_RESPONSE_CONTENT_ITEM",{contexto:this,itemId:this.parametros.tabOrigin})},imprimirMinuta:function(){var t=this;return r()(e.a.mark(function a(){return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.loadingPrint=!0,a.next=3,t.$refs.registroMinuta.save(!1);case 3:if(!a.sent){a.next=5;break}t.filePrint("minuta-pdf&id="+t.contrato.id);case 5:t.loadingPrint=!1;case 6:case"end":return a.stop()}},a,t)}))()},getRegistro:function(){var t=this;this.parametros.entidad&&this.parametros.entidad.id?(this.loading=!0,this.axios.get("minutas/"+this.parametros.entidad.id).then(function(a){""!==a.data&&(a.data.data.fecha_contrato=a.data.data.fecha_contrato?t.moment(a.data.data.fecha_contrato).format("YYYY-MM-DD"):null,a.data.data.fecha_acta_inicio=a.data.data.fecha_acta_inicio?t.moment(a.data.data.fecha_acta_inicio).format("YYYY-MM-DD"):null,t.contrato=a.data.data,t.loading=!1)}).catch(function(a){t.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:" al traer el contrato. ",error:a})})):(this.$store.commit("SNACK_ERROR_LIST",{expression:" Ésta petición no viene de un contrato valido."}),this.$store.dispatch("NAV_RESPONSE_CONTENT_ITEM",{contexto:this,itemId:this.parametros.tabOrigin}))}}}},1968:function(t,a,n){var i=n(1969);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(456)("78b5be04",i,!0,{})},1969:function(t,a,n){a=t.exports=n(455)(!0),a.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"MinutaContrato.vue",sourceRoot:""}])},1970:function(t,a,n){"use strict";var i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[n("v-card",[n("loading",{model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}}),t._v(" "),n("v-toolbar",{staticClass:"elevation-0",attrs:{dense:""}},[n("v-icon",[t._v("receipt")]),t._v(" "),n("v-toolbar-title",[t._v("Minuta contrato "+t._s(t.contrato&&t.contrato.numero_contrato?"No. "+t.contrato.numero_contrato:"No definido"))]),t._v(" "),n("v-spacer"),t._v(" "),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",icon:"",large:"",loading:t.loadingPrint},on:{click:t.imprimirMinuta},slot:"activator"},[n("v-icon",{attrs:{medium:"",color:"success"}},[t._v("\n            far fa-file-pdf\n          ")])],1),t._v(" "),n("span",[t._v("Vista previa")])],1)],1),t._v(" "),t.contrato?n("registro-minuta",{ref:"registroMinuta",on:{cancelar:t.cancelar},model:{value:t.contrato,callback:function(a){t.contrato=a},expression:"contrato"}}):t._e()],1)],1)},e=[],o={render:i,staticRenderFns:e};a.a=o},585:function(t,a,n){"use strict";function i(t){n(1968)}Object.defineProperty(a,"__esModule",{value:!0});var e=n(1119),o=n(1970),r=n(1),c=i,s=r(e.a,o.a,!1,c,"data-v-75e75c84",null);a.default=s.exports},856:function(t,a,n){"use strict";var i=n(13),e=n.n(i),o=n(23),r=n.n(o),c=n(14),s=n.n(c),l=n(7),u=n.n(l),d=n(58);a.a={name:"RegistroMinuta",props:["value","parent"],components:{CkeditorDocument:function(){return n.e(318).then(n.bind(null,1115))},Loading:d.default,Confirmar:function(){return n.e(289).then(n.bind(null,749))}},data:function(){return{dialogCancelar:{loading:!1,visible:!1,content:null},loading:!1,minutaOriginal:null,minuta:null,otro:""}},created:function(){this.minuta=JSON.parse(u()(this.value.minuta)),this.minutaOriginal=JSON.parse(u()(this.value.minuta))},watch:{value:function(t){t&&(this.minuta=JSON.parse(u()(t.minuta)),this.minutaOriginal=JSON.parse(u()(t.minuta)))}},methods:{cancel:function(){u()(this.minutaOriginal)===u()(this.minuta)?this.aceptaCancelacion():(this.dialogCancelar.content="<strong>la Minuta del contrato No. "+this.value.numero_contrato+" perderá los cambios realizados recientemente.</strong><br/> ¿Está seguro de continuar?",this.dialogCancelar.visible=!0)},aceptaCancelacion:function(){var t=this;this.dialogCancelar.loading=!0,this.minuta=JSON.parse(u()(this.minutaOriginal)),this.value.minuta=this.minuta,this.axios.put("minutas/"+this.value.id,this.value).then(function(a){t.$emit("cancelar"),t.dialogCancelar.loading=!1,t.dialogCancelar.visible=!1}).catch(function(a){t.dialogCancelar.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:" al restaurar el contenido de la minuta. ",error:a})})},save:function(){var t=this,a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return s()(e.a.mark(function n(){return e.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new r.a(function(n){t.minuta?(t.loading=!0,t.value.minuta=t.minuta,t.axios.put("minutas/"+t.value.id,t.value).then(function(i){t.$store.commit("CONTRATO_RELOAD_ITEM",{item:i.data.data,estado:"reload",key:null}),a&&t.$store.commit("SNACK_SHOW",{msg:"El contenido de la minuta de ha guardado correctamente. ",color:"success"}),t.loading=!1,n(!0)}).catch(function(a){t.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:" al guardar el contenido de la minuta. ",error:a}),n(!1)})):(t.$store.commit("SNACK_SHOW",{msg:"El contenido de la minuta es invalido. ",color:"warning"}),n(!1))}));case 1:case"end":return n.stop()}},n,t)}))()}}}},922:function(t,a,n){"use strict";function i(t){n(923)}Object.defineProperty(a,"__esModule",{value:!0});var e=n(856),o=n(925),r=n(1),c=i,s=r(e.a,o.a,!1,c,"data-v-63170f29",null);a.default=s.exports},923:function(t,a,n){var i=n(924);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(456)("41fc88b7",i,!0,{})},924:function(t,a,n){a=t.exports=n(455)(!0),a.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroMinuta.vue",sourceRoot:""}])},925:function(t,a,n){"use strict";var i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[n("v-card",{class:"primary"===t.parent?"pa-0":""},[n("loading",{model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}}),t._v(" "),n("v-card-text",[n("ckeditor-document",{model:{value:t.minuta,callback:function(a){t.minuta=a},expression:"minuta"}})],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-btn",{attrs:{flat:"",loading:t.loading},on:{click:function(a){return a.preventDefault(),t.cancel(a)}}},[t._v("Cancelar")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{flat:"",color:"primary",loading:t.loading},on:{click:function(a){return a.preventDefault(),t.save(a)}}},[t._v("Guardar")])],1)],1),t._v(" "),n("confirmar",{attrs:{loading:t.dialogCancelar.loading,value:t.dialogCancelar.visible,content:t.dialogCancelar.content,"requiere-motivo":!1},on:{cancelar:function(a){t.dialogCancelar.visible=!1},aceptar:t.aceptaCancelacion}})],1)},e=[],o={render:i,staticRenderFns:e};a.a=o}});
//# sourceMappingURL=63.9965e1bc0ba4f78f3d0b.js.map