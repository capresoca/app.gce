webpackJsonp([386],{1270:function(e,t,o){"use strict";var a=o(13),n=o.n(a),i=o(14),s=o.n(i),r=o(249),c=o.n(r),l=o(7),v=o.n(l),d=o(12),u=o(58);t.a={name:"Eventos",components:{Loading:u.default,InputFile:function(){return o.e(288).then(o.bind(null,748))}},props:{concurrenciaId:{type:Number,default:0},concurrenciaObj:{type:Object,defatul:{}}},data:function(){return{evento:{},eventos:[],eventosAdversosEps:[],eventosAdversosIps:[],glosas:[],dialogEvento:!1,menuDateEvento:!1,menuTimeEvento:!1,fechaRecepcionEvento:null,horaRecepcionEvento:null,loading:!1,loadingSubmit:!1,causa:null,tiposEvento:["Evento Adverso - Incidente","Falla","Fuga"],payload:null,headers:[{text:"id",align:"left",sortable:!1,value:"id"},{text:"Fecha",align:"left",sortable:!1,value:"fecha"},{text:"Tipo",align:"left",sortable:!1,value:"tipo"},{text:"Salud pública",align:"left",sortable:!1,value:"salud_publica"},{text:"Opciones",align:"left",sortable:!1,value:"id"}]}},beforeMount:function(){this.resetDialogEvento()},mounted:function(){this.getRegistro(),this.getEventosAdversosEps(),this.getEventosAdversosIps(),this.getGlosas()},computed:{computedDateFormattedEvento:function(){return this.formDate(this.fechaRecepcionEvento)}},methods:{getRegistro:function(){var e=this,t=this.$loading.show({container:this.$refs.loaderRef.$el});this.axios.get("cuentasmedicas/concurrencia/eventos/"+this.concurrenciaId).then(function(o){""!==o.data&&(e.eventos=o.data.data),t.hide()}).catch(function(o){t.hide(),e.$store.commit(d.b,{msg:"Hay un error al traer el ingreso. "+o,color:"danger"})})},getEventosAdversosEps:function(){var e=this;this.axios.get("cuentasmedicas/eventosadversoeps").then(function(t){""!==t.data&&(e.eventosAdversosEps=t.data.data)}).catch(function(t){e.$store.commit(d.a,{expression:" al traer los registros. ",error:t})})},getEventosAdversosIps:function(){var e=this;this.axios.get("cuentasmedicas/eventosadversoips").then(function(t){""!==t.data&&(e.eventosAdversosIps=t.data.data)}).catch(function(t){e.$store.commit(d.a,{expression:" al traer los registros. ",error:t})})},getGlosas:function(){var e=this;this.axios.get("manglosas").then(function(t){""!==t.data&&(e.glosas=t.data.data.glosas)}).catch(function(t){e.$store.commit(d.b,{msg:"Hay un error al traer las glosas. "+t,color:"danger"})})},resetDialogEvento:function(){this.evento={id:"",cm_convisita_id:null,tipo:null,fecha:null,descripcion:null,salud_publica:0,cm_eventoadeversoeps_id:null,cm_eventoadeversoips_id:null,cm_manglosa_id:null},this.fechaRecepcionEvento=null,this.horaRecepcionEvento=null},edit:function(e){this.openDialogEvento(),this.evento=JSON.parse(v()(e)),console.log("xxedit",this.evento),this.evento.cm_eventoadversoips_id&&(this.causa="ips"),this.evento.cm_eventoadversoeps_id&&(this.causa="eps")},openDialogEvento:function(){this.dialogEvento=!0,this.evento.cm_concurrencia_id=this.concurrenciaId;var e=this.moment().format("YYYY-MM-DD HH:mm").split(" ");this.fechaRecepcionEvento=e[0],this.horaRecepcionEvento=e[1]},closeEvento:function(){this.dialogEvento=!1,this.resetDialogEvento()},filterGlosas:function(e,t){var o=function(e){return null!=e?e:""},a=o(e.tipo+" "+e.glosa+" "+e.descripcion),n=o(t);return a.toString().toLowerCase().indexOf(n.toString().toLowerCase())>-1},formDate:function(e){if(!e)return null;var t=e.split("-"),o=c()(t,3);return o[0]+"/"+o[1]+"/"+o[2]},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},addFormData:function(){var e=new FormData;e.append("id",this.evento.id),e.append("cm_concurrencia_id",this.evento.cm_concurrencia_id),e.append("tipo",this.evento.tipo),e.append("fecha",this.evento.fecha),e.append("descripcion",this.evento.descripcion),e.append("salud_publica",this.evento.salud_publica),"Evento Adverso - Incidente"!==this.evento.tipo&&"Falla"!==this.evento.tipo||e.append("cm_manglosa_id",this.evento.cm_manglosa_id),this.evento.cm_eventoadversoeps_id&&e.append("cm_eventoadversoeps_id",this.evento.cm_eventoadversoeps_id),this.evento.cm_eventoadversoips_id&&e.append("cm_eventoadversoips_id",this.evento.cm_eventoadversoips_id),e.append("file",void 0===this.evento.file?"":this.evento.file),this.payload=e},guardarEvento:function(){var e=this;return s()(n.a.mark(function t(){var o;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validador("formEvento");case 2:if(!t.sent){t.next=10;break}e.loadingSubmit=!0,e.evento.fecha=e.fechaRecepcionEvento+" "+e.horaRecepcionEvento,e.addFormData(),o=e.evento.id?e.axios.post("cuentasmedicas/concurrencia/eventos/"+e.evento.id,e.payload):e.axios.post("cuentasmedicas/concurrencia/eventos",e.payload),o.then(function(t){e.evento.id?(e.loadingSubmit=!1,e.$store.commit(d.b,{msg:"Item actualizado satisfactoriamente",color:"success"}),e.eventos.splice(e.eventos.findIndex(function(e){return e.id===t.data.data.id}),1,t.data.data)):(e.loadingSubmit=!1,e.$store.commit(d.b,{msg:"Item creado satisfactoriamente",color:"success"}),e.eventos.unshift(t.data.data)),e.closeEvento()}).catch(function(t){e.loadingSubmit=!1,e.$store.commit(d.a,{expression:" al guardar el registro. ",error:t})}),t.next=11;break;case 10:e.$store.commit(d.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 11:case"end":return t.stop()}},t,e)}))()}}}},2377:function(e,t,o){"use strict";function a(e){o(2378)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1270),i=o(2380),s=o(1),r=a,c=s(n.a,i.a,!1,r,"data-v-454cafc6",null);t.default=c.exports},2378:function(e,t,o){var a=o(2379);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o(456)("3e2c9a72",a,!0,{})},2379:function(e,t,o){t=e.exports=o(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Eventos.vue",sourceRoot:""}])},2380:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"loaderRef"},[o("v-dialog",{attrs:{width:"720px"},model:{value:e.dialogEvento,callback:function(t){e.dialogEvento=t},expression:"dialogEvento"}},[o("v-form",{attrs:{"data-vv-scope":"formEvento"}},[o("v-card",[o("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[o("span",{staticClass:"title"},[e._v("Evento")])]),e._v(" "),o("v-container",{attrs:{fluid:"","grid-list-md":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{xs12:"",md6:""}},[o("v-menu",{ref:"menuDateEvento",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:e.menuDateEvento,callback:function(t){e.menuDateEvento=t},expression:"menuDateEvento"}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],attrs:{slot:"activator",label:"Fecha","prepend-icon":"event",readonly:"",name:"fecha",required:"","data-vv-delay":"1000","error-messages":e.errors.collect("fecha")},slot:"activator",model:{value:e.computedDateFormattedEvento,callback:function(t){e.computedDateFormattedEvento=t},expression:"computedDateFormattedEvento"}}),e._v(" "),o("v-date-picker",{attrs:{locale:"es","no-title":""},on:{input:function(t){e.menuDateEvento=!1}},model:{value:e.fechaRecepcionEvento,callback:function(t){e.fechaRecepcionEvento=t},expression:"fechaRecepcionEvento"}})],1)],1),e._v(" "),o("v-flex",{attrs:{xs12:"",md6:""}},[o("v-menu",{ref:"menuTimeEvento",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.horaRecepcionEvento,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){e.horaRecepcionEvento=t},"update:return-value":function(t){e.horaRecepcionEvento=t}},model:{value:e.menuTimeEvento,callback:function(t){e.menuTimeEvento=t},expression:"menuTimeEvento"}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{slot:"activator",label:"Hora de recepción","prepend-icon":"access_time",readonly:"",required:"",name:"hora recepcion","error-messages":e.errors.collect("hora recepcion")},slot:"activator",model:{value:e.horaRecepcionEvento,callback:function(t){e.horaRecepcionEvento=t},expression:"horaRecepcionEvento"}}),e._v(" "),e.menuTimeEvento?o("v-time-picker",{attrs:{"full-width":""},on:{change:function(t){return e.$refs.menuTimeEvento.save(e.horaRecepcionEvento)}},model:{value:e.horaRecepcionEvento,callback:function(t){e.horaRecepcionEvento=t},expression:"horaRecepcionEvento"}}):e._e()],1)],1),e._v(" "),o("v-flex",{attrs:{xs12:""}},[o("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.tiposEvento,label:"Tipo",name:"tipo","prepend-icon":"assignment","error-messages":e.errors.collect("tipo"),required:""},model:{value:e.evento.tipo,callback:function(t){e.$set(e.evento,"tipo",t)},expression:"evento.tipo"}})],1),e._v(" "),"Evento Adverso - Incidente"===e.evento.tipo?o("v-flex",{attrs:{xs12:""}},[o("v-radio-group",{attrs:{row:""},model:{value:e.causa,callback:function(t){e.causa=t},expression:"causa"}},[o("v-radio",{attrs:{label:"Causa IPS",value:"ips"}}),e._v(" "),o("v-radio",{attrs:{label:"Causa EPS",value:"eps"}})],1)],1):e._e(),e._v(" "),o("v-flex",{attrs:{xs12:""}},["Evento Adverso - Incidente"===e.evento.tipo&&"ips"===e.causa?o("v-autocomplete",{attrs:{items:e.eventosAdversosIps,"item-text":"nombre","item-value":"id",label:"Seleccionar...","no-data-text":"No hay datos disponibles",name:"evento adeverso ips","error-messages":e.errors.collect("evento adeverso ips"),"prepend-icon":"contacts"},scopedSlots:e._u([{key:"item",fn:function(t){return[[o("v-list-tile-content",[o("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}}),e._v(" "),o("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.codigo)}})],1)]]}}],null,!1,3181165253),model:{value:e.evento.cm_eventoadversoips_id,callback:function(t){e.$set(e.evento,"cm_eventoadversoips_id",t)},expression:"evento.cm_eventoadversoips_id"}}):e._e()],1),e._v(" "),o("v-flex",{attrs:{xs12:""}},["Evento Adverso - Incidente"===e.evento.tipo&&"eps"===e.causa?o("v-autocomplete",{attrs:{items:e.eventosAdversosEps,"item-text":"nombre","item-value":"id",label:"Seleccionar...","no-data-text":"No hay datos disponibles",name:"evento adeverso eps","error-messages":e.errors.collect("evento adeverso eps"),"prepend-icon":"contacts"},scopedSlots:e._u([{key:"item",fn:function(t){return[[o("v-list-tile-content",[o("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.nombre)}}),e._v(" "),o("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.codigo)}})],1)]]}}],null,!1,3181165253),model:{value:e.evento.cm_eventoadversoeps_id,callback:function(t){e.$set(e.evento,"cm_eventoadversoeps_id",t)},expression:"evento.cm_eventoadversoeps_id"}}):e._e()],1),e._v(" "),"Evento Adverso - Incidente"===e.evento.tipo||"Falla"===e.evento.tipo?o("v-flex",[o("v-flex",{attrs:{xs12:""}},[o("v-autocomplete",{attrs:{label:"Seleccionar glosa",items:e.glosas,"item-value":"id","item-text":"descripcion",filter:e.filterGlosas,name:"glosa","prepend-icon":"security","error-messages":e.errors.collect("glosa")},scopedSlots:e._u([{key:"selection",fn:function(t){return[o("div",{staticStyle:{width:"100% !important"}},[o("v-list-tile",{staticClass:"content-v-list-tile-p0"},[o("v-list-tile-content",{staticClass:"truncate-content"},[o("span",{staticClass:"ma-0 body-2"},[e._v(e._s(t.item.glosa)+": "+e._s(t.item.descripcion))]),e._v(" "),o("span",{staticClass:"ma-0 body-2"},[e._v("Tipo: "+e._s(t.item.tipo))])])],1),e._v(" "),o("v-divider")],1)]}},{key:"item",fn:function(t){return[o("div",{staticStyle:{width:"100% !important"}},[o("v-list-tile",{staticClass:"content-v-list-tile-p0"},[o("v-list-tile-content",{staticClass:"truncate-content"},[o("span",{staticClass:"ma-0 body-1"},[e._v(e._s(t.item.glosa)+": "+e._s(t.item.descripcion))]),e._v(" "),o("span",{staticClass:"ma-0 body-1"},[e._v("Tipo: "+e._s(t.item.tipo))])])],1)],1)]}}],null,!1,155676883),model:{value:e.evento.cm_manglosa_id,callback:function(t){e.$set(e.evento,"cm_manglosa_id",t)},expression:"evento.cm_manglosa_id"}})],1)],1):e._e(),e._v(" "),o("v-flex",{attrs:{xs12:""}},[o("v-textarea",{attrs:{outline:"",name:"descripcion",label:"Descripción"},model:{value:e.evento.descripcion,callback:function(t){e.$set(e.evento,"descripcion",t)},expression:"evento.descripcion"}})],1),e._v(" "),o("v-flex",{attrs:{xs12:"",md6:""}},[o("v-layout",{attrs:{"align-center":"","fill-height":""}},[o("v-flex",{attrs:{"d-flex":"",xs10:"",sm8:""}},[o("input-file",{ref:"archivoAdjunto",staticClass:"mb-3",attrs:{label:"Historia clínica","file-name":e.evento.historia_clinica?e.evento.historia_clinica.nombre:null,accept:"application/pdf",hint:"Extenciones aceptadas: pdf","prepend-icon":"attach_file"},model:{value:e.evento.file,callback:function(t){e.$set(e.evento,"file",t)},expression:"evento.file"}})],1),e._v(" "),e.evento.historia_clinica&&e.evento.historia_clinica.url_signed?o("v-flex",{attrs:{"d-flex":"",xs2:"",sm4:""}},[o("v-tooltip",{attrs:{bottom:""}},[o("v-btn",{attrs:{slot:"activator",fab:"",color:"success",small:"",href:e.evento.historia_clinica?e.evento.historia_clinica.url_signed:"",target:"_blank"},slot:"activator"},[o("v-icon",[e._v("remove_red_eye")])],1),e._v(" "),o("span",[e._v("Ver archivo")])],1)],1):e._e()],1)],1),e._v(" "),o("v-flex",{attrs:{xs12:""}},[o("v-subheader",{staticClass:"pa-0 ma-0"},[e._v("Salud Pública")]),e._v(" "),o("v-switch",{staticClass:"ma-0 pa-0",attrs:{color:"accent","true-value":1,"false-value":0},model:{value:e.evento.salud_publica,callback:function(t){e.$set(e.evento,"salud_publica",t)},expression:"evento.salud_publica"}})],1)],1)],1),e._v(" "),o("v-card-actions",{staticClass:"grey lighten-4"},[o("v-spacer"),e._v(" "),o("v-btn",{on:{click:e.closeEvento}},[e._v("Cancelar")]),e._v(" "),o("v-btn",{attrs:{color:"primary",loading:e.loadingSubmit},on:{click:e.guardarEvento}},[e._v("Guardar")])],1)],1)],1)],1),e._v(" "),o("v-card",[o("v-toolbar",{staticClass:"elevation-0",attrs:{dense:""}},[o("v-toolbar-title",[e._v("Eventos")]),e._v(" "),o("small",{staticClass:"mt-2 ml-1"},[e._v(" Registro y gestión")]),e._v(" "),o("v-spacer"),e._v(" "),o("v-tooltip",{attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",fab:"",color:"accent",small:"",disabled:"Cerrada"===e.concurrenciaObj.estado},on:{click:function(t){return e.openDialogEvento()}},slot:"activator"},[o("v-icon",[e._v("add")])],1),e._v(" "),o("span",[e._v("Crear registro")])],1)],1),e._v(" "),o("loading",{model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),e._v(" "),o("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.eventos,loading:e.loading,"rows-per-page-text":"Registros por página"},scopedSlots:e._u([{key:"items",fn:function(t){return[o("td",[e._v(e._s(t.item.id))]),e._v(" "),o("td",[e._v(e._s(t.item.fecha))]),e._v(" "),o("td",[e._v(e._s(t.item.tipo))]),e._v(" "),o("td",[e._v(e._s(t.item.salud_publica))]),e._v(" "),o("td",[o("v-tooltip",{attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",icon:"",disabled:"Cerrada"===e.concurrenciaObj.estado},on:{click:function(o){return e.edit(t.item)}},slot:"activator"},[o("v-icon",{attrs:{color:"accent"}},[e._v("edit")])],1),e._v(" "),o("span",[e._v("Ver detalle")])],1)],1)]}}])},[e._v(" "),o("template",{slot:"no-data"},[e.loading?o("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[e._v("\n          Estamos cargando los registros. "),o("v-icon",[e._v("sentiment_satisfied_alt")])],1):o("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n          Lo sentimos, no tenemos registros para mostrar. "),o("v-icon",[e._v("sentiment_very_dissatisfied")])],1)],1)],2)],1)],1)},n=[],i={render:a,staticRenderFns:n};t.a=i}});
//# sourceMappingURL=386.c177dd9846376ba1add4.js.map