webpackJsonp([89],{1194:function(e,t,a){"use strict";var r=a(13),n=a.n(r),i=a(14),s=a.n(i),o=a(7),l=a.n(o),c=a(12),u=a(58);t.a={name:"Estadisticas4505",components:{ToolbarList:function(){return new Promise(function(e){e()}).then(a.bind(null,247))},Loading:u.default},data:function(){return{loading:!0,loadingPrueba:!1,reportesBase:[],panel:[],openAll:!1,search:"",selected:null,sentenciaGo:"",urlReporte:null,minDate:"1900-01-01",maxDate:(new Date).toISOString().substr(0,10)}},created:function(){this.getData()},computed:{infoComponent:function(){return this.$store.getters.getInfoComponent("reportes")},items:function(){var e=this;return this.search||(this.search=""),this.reportesBase.filter(function(t){return-1!==t.nombre.toLowerCase().search(e.search.toLowerCase())||-1!==t.modulo.nombre.toLowerCase().search(e.search.toLowerCase())}).reduce(function(e,t){return(e[t.modulo.nombre]=e[t.modulo.nombre]||[]).push(t),e},{})}},methods:{assign:function(e){this.selected=JSON.parse(l()(e)),this.$vuetify.goTo("#flag-form-reporte",{selector:"#flag-form-reporte",duration:300,offset:-120,easing:"easeInOutQuad"})},refresh:function(){var e=this;this.selected.variables.forEach(function(t){e.$nextTick(function(){t[t.ref]=null})}),this.$validator.reset()},getData:function(){var e=this;return s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.loading=!0,e.axios.get("reportes-disponibles").then(function(t){""!==t.data&&(t.data.data.forEach(function(t){e.reportesBase=window.lodash.uniqBy(e.reportesBase.concat(t.reportes),"id")}),e.reportesBase.forEach(function(t){return t.variables.forEach(function(t){"date"!==t.type&&"period"!==t.type||e.$set(t,"menu",!1)})}),e.loading=!1)}).catch(function(t){e.loading=!1,e.$store.commit(c.a,{expression:" al traer los reportes disponibles. ",error:t})});case 2:case"end":return t.stop()}},t,e)}))()},ejecutarReporte:function(){var e=this;this.$validator.validateAll("formPrueba").then(function(t){if(t){e.loadingPrueba=!0;var a=JSON.parse(l()(e.selected.sentencia));e.selected.variables.forEach(function(e){a=a.replace(new RegExp(e.ref,"g"),"number"!==e.type?'"'+e[e.ref]+'"':e[e.ref])}),e.sentenciaGo=a,e.axios.get("firmar-ruta?nombre_ruta=ejecutarReporte").then(function(t){""!==t.data&&(e.urlReporte=t.data,setTimeout(function(){document.getElementById("formReporte").submit(),e.$store.commit(c.b,{msg:"El reporte se ha ejecutado para descargar.",color:"success"}),e.loadingPrueba=!1},500))}).catch(function(t){e.loadingPrueba=!1,e.$store.commit(c.a,{expression:" al ejecutar el reporte. ",error:t})})}})}}}},2121:function(e,t,a){var r=a(2122);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(456)("317550fc",r,!0,{})},2122:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Estadisticas4505.vue",sourceRoot:""}])},2123:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("loading",{model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),e._v(" "),a("toolbar-list",{attrs:{info:e.infoComponent,title:"Reportes",subtitle:"Generaci√≥n"}}),e._v(" "),a("v-layout",{attrs:{"justify-space-between":""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[a("v-text-field",{staticClass:"pa-2",attrs:{"append-icon":"search",solo:"",clearable:"",label:"Filtrar reportes...",type:"text","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),Object.entries(e.items).length?a("v-expansion-panel",{attrs:{expand:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},e._l(e.items,function(t,r){return a("v-expansion-panel-content",{key:r},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n            "+e._s(r)+"\n            "),a("v-chip",{attrs:{label:"",small:"",color:"primary","text-color":"white"}},[e._v("\n              "+e._s(t.length)+" reporte"+e._s(1===t.length?"":"s")+"\n            ")])],1),e._v(" "),a("v-card",[a("v-list",[e._l(t,function(r,n){return[a("v-list-tile",{key:n,class:e.selected&&r.id===e.selected.id?"grey lighten-2":"",attrs:{avatar:""},on:{click:function(t){return e.assign(r)}}},[a("v-list-tile-avatar",[a("v-icon",{class:r.modulo.color+" white--text"},[e._v("assignment")])],1),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[e._v(e._s(r.nombre))]),e._v(" "),a("v-list-tile-sub-title",[e._v("Actualizado: "+e._s(r.updated_at?e.moment(r.updated_at).format("DD/MM/YYYY [a las ] HH:mm"):""))])],1)],1),e._v(" "),n<t.length-1?a("v-divider",{attrs:{inset:""}}):e._e()]})],2)],1)],1)}),1):a("div",{staticClass:"title grey--text text-xs-center font-weight-light pa-2"},[e._v("\n        No hay coincidencias de busqueda. "),a("v-icon",[e._v("sentiment_very_dissatisfied")])],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md8:"","text-xs-center":""}},[a("div",{attrs:{id:"flag-form-reporte"}}),e._v(" "),a("v-scroll-y-transition",{attrs:{mode:"out-in"}},[e.selected?a("v-card",{key:e.selected.id,staticClass:"pt-4 mx-auto",attrs:{flat:""}},[a("v-card-text",[a("v-avatar",{staticStyle:{height:"0px !important"},attrs:{size:"large"}},[a("v-icon",{attrs:{large:"",color:e.selected.modulo.color}},[e._v("\n                assignment\n              ")])],1),e._v(" "),a("h3",{staticClass:"headline mb-2"},[e._v("\n              "+e._s(e.selected.nombre)+"\n            ")]),e._v(" "),a("div",{staticClass:"blue-grey--text mb-2"},[e._v("Actualizado: "+e._s(e.selected.updated_at?e.moment(e.selected.updated_at).format("DD/MM/YYYY [a las ] HH:mm"):""))]),e._v(" "),a("p",{staticClass:"blue-grey--text subheading font-weight-bold"},[e._v(e._s(e.selected.descripcion))])],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",[a("loading",{model:{value:e.loadingPrueba,callback:function(t){e.loadingPrueba=t},expression:"loadingPrueba"}}),e._v(" "),a("v-form",{attrs:{"data-vv-scope":"formPrueba"},on:{submit:function(t){return t.preventDefault(),e.ejecutarReporte(t)}}},[e.selected&&e.selected.variables&&e.selected.variables.length?a("v-container",{staticClass:"pa-0",attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},e._l(e.selected.variables,function(t,r){return a("v-flex",{key:"input"+r,attrs:{xs12:"",sm6:"",md6:1!==e.selected.variables.length,md12:1===e.selected.variables.length}},[t.type&&t.label?["text"===t.type?a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"input-text"+r,attrs:{name:"input-text"+r,label:t.label,"data-vv-as":t.label,"error-messages":e.errors.collect("input-text"+r)},model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,a)},expression:"input[input.ref]"}}):e._e(),e._v(" "),"number"===t.type?a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"decimal|required",expression:"'decimal|required'"}],key:"input-number"+r,attrs:{name:"input-number"+r,label:t.label,type:"number","data-vv-as":t.label,"error-messages":e.errors.collect("input-number"+r)},model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,e._n(a))},expression:"input[input.ref]"}}):e._e(),e._v(" "),"date"===t.type?a("v-menu",{key:"menu-date"+r,ref:"menuDate"+r,refInFor:!0,attrs:{"return-value":t[t.ref],"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(a){return e.$set(t,t.ref,a)},"update:return-value":function(a){return e.$set(t,t.ref,a)}},model:{value:t.menu,callback:function(a){e.$set(t,"menu",a)},expression:"input.menu"}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY-MM-DD|date_between:"+e.minDate+","+e.maxDate+",true",expression:"'required|date_format:YYYY-MM-DD|date_between:' + minDate + ',' + maxDate + ',true'"}],attrs:{slot:"activator",label:t.label,"prepend-icon":"event",name:"input-menuDate"+r,"data-vv-as":t.label,"error-messages":e.errors.collect("input-menuDate"+r),readonly:""},slot:"activator",model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,a)},expression:"input[input.ref]"}}),e._v(" "),a("v-date-picker",{attrs:{locale:"es-co",max:e.maxDate,min:e.minDate},on:{input:function(a){e.$refs["menuDate"+r][0].save(t[t.ref])},change:function(){var t=e.$validator.errors.items.findIndex(function(e){return e.field==="input-menuDate"+r});e.$validator.errors.items.splice(-1!==t?t:0,-1!==t?1:0)}},model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,a)},expression:"input[input.ref]"}})],1):e._e(),e._v(" "),"dateTime"===t.type?a("v-datetime-picker",{key:"dateTime"+r,attrs:{label:t.label,datetime:e.moment().format("YYYY-MM-DD HH:mm"),timeData:t[t.ref]},on:{input:function(e){t[t.ref]=e}}}):e._e(),e._v(" "),"period"===t.type?a("v-menu",{key:"menu-period"+r,ref:"menuPeriod"+r,refInFor:!0,attrs:{"return-value":t[t.ref],"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(a){return e.$set(t,t.ref,a)},"update:return-value":function(a){return e.$set(t,t.ref,a)}},model:{value:t.menu,callback:function(a){e.$set(t,"menu",a)},expression:"input.menu"}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY-MM|date_between:"+e.moment(e.minDate).format("YYYY-MM")+","+e.moment(e.maxDate).format("YYYY-MM")+",true",expression:"'required|date_format:YYYY-MM|date_between:' + moment(minDate).format('YYYY-MM') + ',' + moment(maxDate).format('YYYY-MM') + ',true'"}],attrs:{slot:"activator",label:t.label,"prepend-icon":"event",name:"input-menuPeriod"+r,"data-vv-as":t.label,"error-messages":e.errors.collect("input-menuPeriod"+r),readonly:""},slot:"activator",model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,a)},expression:"input[input.ref]"}}),e._v(" "),a("v-date-picker",{attrs:{locale:"es-co",max:e.maxDate,min:e.minDate,type:"month"},on:{input:function(a){e.$refs["menuPeriod"+r][0].save(t[t.ref])},change:function(){var t=e.$validator.errors.items.findIndex(function(e){return e.field==="input-menuPeriod"+r});e.$validator.errors.items.splice(-1!==t?t:0,-1!==t?1:0)}},model:{value:t[t.ref],callback:function(a){e.$set(t,t.ref,a)},expression:"input[input.ref]"}})],1):e._e()]:e._e()],2)}),1)],1):e._e()],1)],1),e._v(" "),a("form",{attrs:{method:"post",action:e.urlReporte,id:"formReporte",target:"_blank",hidden:""}},[a("textarea",{staticStyle:{width:"1000px !important"},attrs:{name:"sentencia"}},[e._v("              "+e._s(e.selected&&e.sentenciaGo?e.sentenciaGo:"")+"\n            ")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-btn",{on:{click:e.refresh}},[e._v("Limpiar")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.ejecutarReporte}},[a("v-icon",[e._v("flash_on")]),e._v("\n              Ejecutar reporte\n            ")],1)],1)],1):a("div",{staticClass:"title grey--text text--lighten-1 font-weight-light pt-4",staticStyle:{"align-self":"center"}},[e._v("\n          Seleccione un reporte\n        ")])],1)],1)],1)],1)},n=[],i={render:r,staticRenderFns:n};t.a=i},649:function(e,t,a){"use strict";function r(e){a(2121)}Object.defineProperty(t,"__esModule",{value:!0});var n=a(1194),i=a(2123),s=a(1),o=r,l=s(n.a,i.a,!1,o,"data-v-3387d531",null);t.default=l.exports}});
//# sourceMappingURL=89.8645a371c6f6cb9f62e3.js.map