webpackJsonp([95],{1221:function(t,a,i){"use strict";var o=i(7),e=i.n(o),n=i(13),r=i.n(n),s=i(258),l=i.n(s),c=i(257),d=i.n(c),v=i(14),u=i.n(v),h=i(58),p=i(248),m=i(12),f=i(40);a.a={name:"RegistroEntidad",props:["parametros"],components:{Loading:h.default,InputFile:function(){return i.e(288).then(i.bind(null,748))}},data:function(){return{floatMenu:!1,fabMenu:!1,fab:!1,loading:!1,entidad:null,nitActual:null,idActual:null,itemsEntidades:null,idNuevo:null,nitNuevo:null,dialog:!1,makeEntidad:{id:null,gn_tercero_id:null,replegal:null,gerente:null,nombre:null,rs_tipentidade_id:null,tipo_locacion:null,naturaleza:null,complejidad:null,res_habilitacion:null,codigo:null,cod_habilitacion:null,codHabilitacionValido:null,telefono_sede:null,correo_electronico_sede:null,gn_municipiosede_id:null,direccion_sede:null,ive:0,primaria:0,portabilidad:0,auditoria_concurrente:0,tercero:null,tipo:null,municipio:null},window:0,drawer:!0,items:[{icon:"account_balance",avatarColor:"primary",title:"Información básica",subTitle:"Datos básicos de la entidad.",component:function(){return i.e(328).then(i.bind(null,2208))}},{icon:"verified_user",avatarColor:"success",title:"Servicios habilitados",subTitle:"Listado de servicios habilitados",component:function(){return i.e(305).then(i.bind(null,2212))}},{icon:"healing",avatarColor:"danger",title:"Procedimientos",subTitle:"Listado de CUPS",component:function(){return i.e(325).then(i.bind(null,2216))}},{icon:"colorize",avatarColor:"purple",title:"Medicamentos",subTitle:"Listado de CUMS",component:function(){return i.e(327).then(i.bind(null,2220))}},{icon:"category",avatarColor:"orange",title:"Otros bienes y servicios",subTitle:"Bienes y servicios propios",component:function(){return i.e(326).then(i.bind(null,2224))}},{icon:"business",avatarColor:"accent",title:"Capacidad instalada",subTitle:"Capacidad instalada",component:function(){return i.e(329).then(i.bind(null,2228))}}],archivoMasivo:null,makeArchivoMasivo:{loading:!1,visible:!1,index:null,tipo:null,ruta:null,label:null,archivo:null,invalido:{headers:[],items:[]}}}},watch:{"archivoMasivo.visible":function(t){t||this.refreshArchivoMasivo()},"archivoMasivo.archivo":function(){this.archivoMasivo.invalido.headers=[],this.archivoMasivo.invalido.items=[]}},created:function(){this.refresh(),null!==this.parametros.entidad&&null!==this.parametros.entidad.id&&this.getRegistro(this.parametros.entidad.id)},methods:{submitArchivo:function(){var t=this;return u()(r.a.mark(function a(){var i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.archivoMasivo.validate();case 2:if(!a.sent){a.next=7;break}t.archivoMasivo.loading=!0,i=new FormData,i.append("archivo",t.archivoMasivo.archivo),t.axios.post("entidades/"+t.entidad.id+"/"+t.archivoMasivo.ruta,i).then(function(a){a.data.guardado.length&&t.reloadSection(t.archivoMasivo.index),a.data.invalido.length?(t.archivoMasivo.invalido.headers.push({text:"Fila",align:"left",sortable:!1}),d()(a.data.invalido[0].row).forEach(function(a){t.archivoMasivo.invalido.headers.push({text:a,align:"left",sortable:!1})}),t.archivoMasivo.invalido.headers.push({text:"Error",align:"left",sortable:!1}),a.data.invalido.forEach(function(a){var i=[];i.push(a.fila),l()(a.row).forEach(function(t){i.push(t)}),i.push(window.lodash.flattenDeep(a.errors).join(", ")),t.archivoMasivo.invalido.items.push(i)}),t.$store.commit(m.b,{msg:"El archivo de "+t.archivoMasivo.tipo+" se ha subido con "+a.data.invalido.length+" "+(1===a.data.invalido.length?"registro invalido":"Registros invalidos")+".",color:"warning"}),t.archivoMasivo.loading=!1):(t.$store.commit(m.b,{msg:"El archivo de "+t.archivoMasivo.tipo+" se ha subido correctamente. ",color:"success"}),t.archivoMasivo.visible=!1)}).catch(function(a){t.archivoMasivo.loading=!1,t.$store.commit(m.a,{expression:" al subir el archivo de "+t.archivoMasivo.tipo+". ",error:a})});case 7:case"end":return a.stop()}},a,t)}))()},cargarArchivo:function(t){switch(this.archivoMasivo.index=t,console.log("index",t),t){case 2:this.archivoMasivo.label="Archivo de procedimientos",this.archivoMasivo.tipo="procedimientos",this.archivoMasivo.ruta="importcups";break;case 3:this.archivoMasivo.label="Archivo de medicamentos",this.archivoMasivo.tipo="medicamentos",this.archivoMasivo.ruta="importcums";break;case 4:this.archivoMasivo.label="Archivo de otros bienes y servicios",this.archivoMasivo.tipo="otros bienes y servicios",this.archivoMasivo.ruta="importotros"}this.archivoMasivo.visible=!0},reloadSection:function(t){2===t||3===t||4===t?this.$refs["dataComponent"+t][0].$refs[2===t?"tablaProcedimientos":3===t?"tablaMedicamentos":"tablaOtros"].reloadPage():this.getRegistro(this.entidad.id)},migrarEntidad:function(){var t=this;this.loading=!0,this.dialog=!1,this.validador("formPago")&&(console.log("migrar/entidades/"+this.idActual+"/"+this.idNuevo),this.axios.get("migrar/entidades/"+this.idActual+"/"+this.idNuevo).then(function(a){""!==a.data&&(t.$store.commit(m.b,{msg:"La migración se ha realizado correctamente.",color:"success"}),t.close(),t.loading=!1)}).catch(function(a){t.$store.commit(m.a,{expression:" al traer la entidad. ",error:a})}))},validador:function(t){return this.$validator.validateAll(t).then(function(t){return t})},migrar:function(){this.dialog=!0},submit:function(){var t=this;return u()(r.a.mark(function a(){var i,o;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.dataComponent0[0].validate();case 2:if(!a.sent){a.next=9;break}t.loading=!0,1!==t.entidad.rs_tipentidade_id&&6!==t.entidad.rs_tipentidade_id&&(t.entidad.cod_habilitacion=null),1!==t.entidad.rs_tipentidade_id&&2!==t.entidad.rs_tipentidade_id&&6!==t.entidad.rs_tipentidade_id&&(t.entidad.res_habilitacion=null),i=t.entidad.id?"editar":"crear",o="editar"===i?t.axios.put("entidades/"+t.entidad.id,t.entidad):t.axios.post("entidades",t.entidad),o.then(function(a){a.data.entidad.codHabilitacionValido=a.data.entidad.cod_habilitacion,a.data.entidad.codigo=a.data.entidad.cod_habilitacion,t.entidad=a.data.entidad,t.loading=!1,t.$store.commit(p.J,{item:a.data.entidad_o,estado:i,key:t.parametros.key}),t.$store.commit(m.b,{msg:"Los datos de la entidad se han guardado satisfactoriamente. ",color:"success"})}).catch(function(a){t.$store.commit(m.a,{expression:" al guardar los datos de la entidad. ",error:a}),t.loading=!1});case 9:case"end":return a.stop()}},a,t)}))()},close:function(){this.$store.dispatch(f.c,{contexto:this,itemId:this.parametros.tabOrigin})},getRegistro:function(t){var a=this;this.loading=!0,this.axios.get("entidades_diferente/?idEntidad="+t).then(function(t){""!==t.data&&(a.itemsEntidades=t.data)}).catch(function(t){a.$store.commit(m.a,{expression:" al traer la entidad. ",error:t})}),this.axios.get("entidades/"+t).then(function(t){""!==t.data&&(t.data.data.codHabilitacionValido=t.data.data.cod_habilitacion,t.data.data.codigo=t.data.data.cod_habilitacion,a.entidad=t.data.data,a.nitActual=a.entidad.tercero.identificacion,a.idActual=a.entidad.id,a.loading=!1,console.log(a.entidad.tercero.identificacion))}).catch(function(t){a.$store.commit(m.a,{expression:" al traer la entidad. ",error:t})})},refresh:function(){this.refreshArchivoMasivo(),this.entidad=JSON.parse(e()(this.makeEntidad)),this.$validator.reset(),this.$refs.dataComponent0&&this.$refs.dataComponent0[0]&&this.$refs.dataComponent0[0].reset()},refreshArchivoMasivo:function(){this.archivoMasivo=JSON.parse(e()(this.makeArchivoMasivo)),this.$refs.archivoMasivo&&this.$refs.archivoMasivo.reset()}}}},2206:function(t,a,i){var o=i(2207);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(456)("1eb4cdc4",o,!0,{})},2207:function(t,a,i){a=t.exports=i(455)(!0),a.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroEntidad.vue",sourceRoot:""}])},2232:function(t,a,i){"use strict";var o=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("v-dialog",{attrs:{width:"500px"},model:{value:t.dialog,callback:function(a){t.dialog=a},expression:"dialog"}},[i("v-form",{attrs:{"data-vv-scope":"formPago"}},[i("v-card",[i("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[i("span",{staticClass:"title"},[t._v("Migrar Entidad")])]),t._v(" "),i("v-container",{attrs:{fluid:"","grid-list-md":""}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[i("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Nit Actual",name:"Nit Actual",readonly:"","error-messages":t.errors.collect("Nit Actual")},model:{value:t.nitActual,callback:function(a){t.nitActual=a},expression:"nitActual"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[i("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Entidades",items:t.itemsEntidades,"item-value":"id","item-text":"nombre",name:"Entidades",required:"","error-messages":t.errors.collect("Entidades")},model:{value:t.idNuevo,callback:function(a){t.idNuevo=a},expression:"idNuevo"}})],1)],1)],1),t._v(" "),i("v-card-actions",{staticClass:"grey lighten-4"},[i("v-spacer"),t._v(" "),i("v-btn",{on:{click:t.close}},[t._v("Cancelar")]),t._v(" "),i("v-btn",{attrs:{color:"primary"},on:{click:t.migrarEntidad}},[t._v("Migrar Entidad")])],1)],1)],1)],1),t._v(" "),i("v-container",{staticClass:"pa-0 ma-0",attrs:{fluid:"","grid-list-xl":""}},[i("v-slide-x-reverse-transition",{attrs:{mode:"out-in"}},[t.floatMenu?i("v-speed-dial",{key:"btn1",staticClass:"ml-1",attrs:{left:"",direction:"bottom","open-on-hover":"",fixed:""},model:{value:t.fabMenu,callback:function(a){t.fabMenu=a},expression:"fabMenu"}},[i("v-tooltip",{attrs:{slot:"activator",right:""},slot:"activator"},[i("v-btn",{staticClass:"mt-1",attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:function(a){t.floatMenu=!1}},slot:"activator",model:{value:t.fabMenu,callback:function(a){t.fabMenu=a},expression:"fabMenu"}},[i("v-icon",[t._v("vertical_split")])],1),t._v(" "),i("span",[t._v("Activar menú vertical")])],1),t._v(" "),t._l(t.items,function(a,o){return t.window!==o?i("v-tooltip",{key:o,attrs:{right:""}},[i("v-btn",{class:t.window===o?"elevation-5":"",attrs:{slot:"activator",fab:"",dark:"",small:"",color:a.avatarColor},on:{click:function(a){t.window=o}},slot:"activator"},[i("v-icon",[t._v(t._s(a.icon))])],1),t._v(" "),i("span",[t._v(t._s(a.title))])],1):t._e()})],2):t._e()],1),t._v(" "),i("v-toolbar",{attrs:{dense:!t.entidad.id}},[t.entidad.id&&!t.floatMenu?i("v-tooltip",{staticClass:"mr-2",attrs:{top:""}},[i("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(a){t.floatMenu=!0}},slot:"activator"},[i("v-icon",{attrs:{color:"accent"}},[t._v("group_work")])],1),t._v(" "),i("span",[t._v("activar menú flotante")])],1):t._e(),t._v(" "),i("v-icon",[t._v("account_balance")]),t._v(" "),t.entidad.id?i("v-list-tile",[i("v-list-tile-content",[t.entidad.tercero?i("v-list-tile-title",{domProps:{innerHTML:t._s(t.entidad.tercero.nombre_completo)}}):t._e(),t._v(" "),i("v-list-tile-sub-title",{domProps:{innerHTML:t._s("Código de habilitación: "+t.entidad.cod_habilitacion)}})],1)],1):i("v-toolbar-title",[t._v("Nueva entidad")])],1),t._v(" "),i("loading",{model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}}),t._v(" "),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-slide-x-reverse-transition",[t.entidad.id&&!t.floatMenu?i("v-flex",{attrs:{sm12:"",md3:""}},[i("v-card",{staticClass:"content-list-p0"},[i("v-list",{attrs:{"two-line":""}},[t._l(t.items,function(a,o){return[i("v-list-tile",{key:a.text,class:t.window===o?"grey lighten-2":"",on:{click:function(a){t.window=o}}},[i("v-list-tile-avatar",{attrs:{color:a.avatarColor}},[i("v-icon",{attrs:{dark:""}},[t._v(t._s(a.icon))])],1),t._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[t._v("\n\t                      "+t._s(a.title)+"\n\t                    ")]),t._v(" "),i("v-list-tile-sub-title",{domProps:{innerHTML:t._s(a.subTitle)}})],1)],1),t._v(" "),i("v-divider",{attrs:{inset:""}})]})],2)],1)],1):t._e()],1),t._v(" "),i("v-flex",{attrs:{md9:t.entidad.id&&!t.floatMenu}},[i("v-window",{staticClass:"elevation-1",attrs:{vertical:""},model:{value:t.window,callback:function(a){t.window=a},expression:"window"}},t._l(t.items,function(a,o){return i("v-window-item",{key:o,attrs:{lazy:""}},[i("v-card",{staticClass:"content-list-p0 pt-0",attrs:{flat:""}},[t.entidad.id?i("v-list",{attrs:{"two-line":""}},[[i("v-list-tile",[i("v-list-tile-avatar",{attrs:{color:a.avatarColor}},[i("v-icon",{attrs:{dark:""}},[t._v(t._s(a.icon))])],1),t._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[t._v("\n\t                        "+t._s(a.title)+"\n\t                      ")]),t._v(" "),i("v-list-tile-sub-title",{domProps:{innerHTML:t._s(a.subTitle)}})],1),t._v(" "),o>1&&o<5?i("v-list-tile-action",{staticStyle:{width:"120px !important"}},[i("v-layout",{attrs:{"align-center":"","justify-space-around":"",row:"","fill-height":""}},[i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",large:""},on:{click:function(a){return t.reloadSection(o)}},slot:"activator"},[i("v-icon",{attrs:{color:"primary",large:""}},[t._v("\n\t                              cached\n\t                            ")])],1),t._v(" "),i("span",[t._v("Recargar sección")])],1),t._v(" "),i("v-divider",{attrs:{vertical:""}}),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",href:t.axios.defaults.baseURL+"/../files/Plantilla_importacion_"+(2===o?"cups":3===o?"cums":"otros")+"_entidad.xlsx"},slot:"activator"},[i("v-icon",{attrs:{color:"blue-grey"}},[t._v("archive")])],1),t._v(" "),i("span",[t._v("Descargar plantilla")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(a){return t.cargarArchivo(o)}},slot:"activator"},[i("v-icon",{attrs:{color:"blue-grey"}},[t._v("publish")])],1),t._v(" "),i("span",[t._v("Carga masiva")])],1)],1)],1):i("v-list-tile-action",[i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",large:""},on:{click:function(a){return t.reloadSection(o)}},slot:"activator"},[i("v-icon",{attrs:{color:"primary",large:""}},[t._v("\n\t                            cached\n\t                          ")])],1),t._v(" "),i("span",[t._v("Recargar sección")])],1)],1)],1),t._v(" "),i("v-spacer"),t._v(" "),i("v-divider")]],2):t._e(),t._v(" "),i("v-card-text",[i(a.component,{ref:"dataComponent"+o,refInFor:!0,tag:"component",model:{value:t.entidad,callback:function(a){t.entidad=a},expression:"entidad"}})],1)],1)],1)}),1)],1)],1),t._v(" "),i("v-dialog",{attrs:{persistent:"","max-width":"700px"},model:{value:t.archivoMasivo.visible,callback:function(a){t.$set(t.archivoMasivo,"visible",a)},expression:"archivoMasivo.visible"}},[i("v-card",[i("v-toolbar",{attrs:{dense:""}},[i("v-toolbar-title",[i("v-icon",[t._v("publish")]),t._v("\n\t            Cargar archivo\n\t          ")],1)],1),t._v(" "),i("v-container",{attrs:{"grid-list-md":""}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t.archivoMasivo.visible?i("input-file",{ref:"archivoMasivo",attrs:{label:t.archivoMasivo.label,required:"",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",hint:"Extenciones aceptadas: xls, xlsx","prepend-icon":"description",clearable:""},model:{value:t.archivoMasivo.archivo,callback:function(a){t.$set(t.archivoMasivo,"archivo",a)},expression:"archivoMasivo.archivo"}}):t._e()],1),t._v(" "),i("v-slide-y-reverse-transition",{attrs:{mode:"out-in"}},[this.archivoMasivo.invalido.items.length?i("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[i("v-card",[i("v-toolbar",{staticClass:"elevation-0",attrs:{dense:""}},[i("v-toolbar-title",[i("v-icon",[t._v("label_off")]),t._v("\n\t                      Registros invalidos\n\t                    ")],1)],1),t._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.archivoMasivo.invalido.headers,items:t.archivoMasivo.invalido.items,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(a){return[i("tr",t._l(a.item,function(a,o){return i("td",{key:"registro"+o,staticStyle:{height:"10px !important"}},[t._v("\n\t                          "+t._s(a)+"\n\t                        ")])}),0)]}}],null,!1,2666985706)})],1)],1):t._e()],1)],1)],1),t._v(" "),i("v-divider"),t._v(" "),i("v-card-actions",[i("v-btn",{attrs:{disabled:t.archivoMasivo.loading},on:{click:function(a){t.archivoMasivo.visible=!1}}},[t._v("Cerrar")]),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{staticClass:"white--text",attrs:{loading:t.archivoMasivo.loading,disabled:t.archivoMasivo.loading,color:"blue darken-1"},on:{click:t.submitArchivo}},[t._v("\n\t            Subir archivo\n\t            "),i("v-icon",{attrs:{right:"",dark:""}},[t._v("cloud_upload")])],1)],1)],1)],1),t._v(" "),i("v-slide-x-reverse-transition",{attrs:{mode:"out-in",group:""}},[0===t.window?i("v-speed-dial",{key:"btn1",staticClass:"mb-3",attrs:{bottom:"",right:"",direction:"top","open-on-hover":"",fixed:""},model:{value:t.fab,callback:function(a){t.fab=a},expression:"fab"}},[i("v-tooltip",{attrs:{slot:"activator",left:""},slot:"activator"},[i("v-btn",{attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:t.submit},slot:"activator",model:{value:t.fab,callback:function(a){t.fab=a},expression:"fab"}},[i("v-icon",[t._v("save")]),t._v(" "),i("v-icon",[t._v("save")])],1),t._v(" "),i("span",[t._v("Guardar")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"purple"},on:{click:function(a){return t.migrar(null)}},slot:"activator"},[i("v-icon",[t._v("info")])],1),t._v(" "),i("span",[t._v("Migrar")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"purple"},on:{click:function(a){return t.refresh(null)}},slot:"activator"},[i("v-icon",[t._v("clear_all")])],1),t._v(" "),i("span",[t._v("Limpiar formulario")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"red"},on:{click:t.close},slot:"activator"},[i("v-icon",[t._v("close")])],1),t._v(" "),i("span",[t._v("Cerrar")])],1)],1):i("v-speed-dial",{key:"btn2",staticClass:"mb-3",attrs:{bottom:"",right:"",fixed:""},model:{value:t.fab,callback:function(a){t.fab=a},expression:"fab"}},[i("v-tooltip",{attrs:{slot:"activator",bottom:""},slot:"activator"},[i("v-btn",{attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:t.close},slot:"activator",model:{value:t.fab,callback:function(a){t.fab=a},expression:"fab"}},[i("v-icon",[t._v("close")])],1),t._v(" "),i("span",[t._v("Cerrar")])],1)],1)],1)],1)],1)},e=[],n={render:o,staticRenderFns:e};a.a=n},672:function(t,a,i){"use strict";function o(t){i(2206)}Object.defineProperty(a,"__esModule",{value:!0});var e=i(1221),n=i(2232),r=i(1),s=o,l=r(e.a,n.a,!1,s,"data-v-3e19d832",null);a.default=l.exports}});
//# sourceMappingURL=95.eb05bff7dcd409664599.js.map