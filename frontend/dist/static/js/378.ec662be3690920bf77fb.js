webpackJsonp([378],{1273:function(t,e,a){"use strict";var i=a(23),o=a.n(i),n=a(13),s=a.n(n),r=a(14),c=a.n(r);e.a={name:"DialogAuditores",components:{ToolbarList:function(){return new Promise(function(t){t()}).then(a.bind(null,247))}},data:function(){return{loading:!1,openM:!1,facturas:[],auditoresSeleccionados:[],auditorSeleccionado:null,headersAuditor:[{text:"Identificación",align:"left",sortable:!1,value:"auditor.usuario.identification"},{text:"Nombre",align:"left",sortable:!1,value:"auditor.usuario.name"},{text:"Tipo Auditor",align:"left",sortable:!1,value:"auditor"},{text:"Eliminar",align:"center",sortable:!1,value:""}]}},watch:{auditorSeleccionado:function(t){var e=this;return c()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t&&(e.auditoresSeleccionados.length&&e.auditoresSeleccionados.find(function(e){return e.id===t.id})?e.$store.commit("SNACK_SHOW",{msg:"El auditor ya se encuentra seleccionado",color:"orange"}):e.auditoresSeleccionados.length&&e.auditoresSeleccionados.find(function(e){return e.tipo===t.tipo})?e.$store.commit("SNACK_SHOW",{msg:"Ya hay un auditor de tipo "+t.tipo,color:"orange"}):e.auditoresSeleccionados.push(t)),e.$nextTick(function(){e.auditorSeleccionado=null,e.$validator.reset()});case 2:case"end":return a.stop()}},a,e)}))()}},methods:{asignar:function(){var t=this;if(this.facturas.length&&this.auditoresSeleccionados.length)return this.loading=!0,new o.a(function(e){t.axios.post("asignaciones/facturas",{facturas:t.facturas.map(function(t){return t.id}),auditores:t.auditoresSeleccionados.map(function(t){return t.id})}).then(function(a){console.log("response auditor",a),t.facturas.forEach(function(e){e.auditores=t.auditoresSeleccionados}),t.$store.commit("SNACK_SHOW",{msg:"Se asignaron correctamente los auditores.",color:"success"}),t.$emit("asigna"),t.loading=!1,e(!0),t.close()}).catch(function(a){t.loading=!1,t.$store.commit("SNACK_ERROR_LIST",{expression:" al asignar el auditor. ",error:a}),e(!1)})});this.$store.commit("SNACK_SHOW",{msg:this.facturas.length?"No hay auditores seleccionados":"No hay facturas seleccionadas",color:"orange"})},eliminar:function(t){this.auditoresSeleccionados.splice(t,1)},open:function(t){this.auditoresSeleccionados=[],this.facturas=t,1===this.facturas.length&&(this.auditoresSeleccionados=this.facturas[0].auditores),this.openM=!0},close:function(){var t=this;this.openM=!1,this.$nextTick(function(){t.auditorSeleccionado=null,t.$validator.reset()})}}}},2387:function(t,e,a){"use strict";function i(t){a(2388)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(1273),n=a(2390),s=a(1),r=i,c=s(o.a,n.a,!1,r,"data-v-1f785c92",null);e.default=c.exports},2388:function(t,e,a){var i=a(2389);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(456)("1c362847",i,!0,{})},2389:function(t,e,a){e=t.exports=a(455)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"DialogAuditores.vue",sourceRoot:""}])},2390:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"",width:"720px"},model:{value:t.openM,callback:function(e){t.openM=e},expression:"openM"}},[t.facturas.length?a("v-card",[a("loading",{model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}}),t._v(" "),a("v-toolbar",{attrs:{dense:""}},[a("v-toolbar-title",[t._v(t._s("Auditores factura"+(1===t.facturas.length?"":"s")+" No. "+t.facturas.map(function(t){return t.no_factura}).join(", ")))]),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",icon:""},on:{click:function(e){e.stopPropagation(),t.openM=!1}}},[a("v-icon",[t._v("close")])],1)],1),t._v(" "),a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("postulador-v3",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{"no-data-text":"Busqueda por identificación, nombre o código de auditor.","item-text":"usuario.name",label:"Auditores",route:"ac_auditores",model:"ac_auditores",filter:"identificacion_completa,usuario.name,codigo","prepend-icon":"person_outline",name:"auditor","error-messages":t.errors.collect("auditor"),"slot-data":{template:'\n                      <v-list-tile class="content-v-list-tile-p0" style="width: 100% !important;">\n                        <v-list-tile-content>\n                          <v-list-tile-title>{{value.codigo}} - {{value.usuario.name}}</v-list-tile-title>\n                          <v-list-tile-sub-title>{{value.identificacion_completa}} - {{value.tipo}}</v-list-tile-sub-title>\n                        </v-list-tile-content>\n                      </v-list-tile>\n                    ',props:["value"]}},model:{value:t.auditorSeleccionado,callback:function(e){t.auditorSeleccionado=e},expression:"auditorSeleccionado"}}),t._v(" "),1===t.facturas.length?a("v-data-table",{key:"table",staticClass:"elevation-1",attrs:{items:t.facturas[0].auditores,headers:t.headersAuditor,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",{key:"tag-"+(e.item.id?e.index:e.item.id=e.index)},[a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.identificacion_completa:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.usuario.name:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.tipo:null))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{staticClass:"mx-0",attrs:{slot:"activator",icon:"",fab:"",small:""},on:{click:function(a){return t.eliminar(e.index)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[t._v("delete")])],1),t._v(" "),a("span",[t._v("Eliminar")])],1)],1)])]}}],null,!1,102094488)},[t._v(" "),a("template",{staticClass:"error",slot:"no-data"},[a("div",{staticClass:"pa-1 pl-2 red--text text-xs-center"},[t._v("\n            No hay auditores asignados\n          ")])])],2):a("v-data-table",{key:"table",staticClass:"elevation-1",attrs:{items:t.auditoresSeleccionados,headers:t.headersAuditor,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",{key:"tag-"+(e.item.id?e.index:e.item.id=e.index)},[a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.identificacion_completa:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.usuario.name:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item?e.item.tipo+(1===e.item.tecnico?" Técnico":""):null))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{staticClass:"mx-0",attrs:{slot:"activator",icon:"",fab:"",small:""},on:{click:function(a){return t.auditoresSeleccionados.splice(e.index,1)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[t._v("delete")])],1),t._v(" "),a("span",[t._v("Elimina")])],1)],1)])]}}],null,!1,2816318012)},[t._v(" "),a("template",{staticClass:"error",slot:"no-data"},[a("div",{staticClass:"pa-1 pl-2 red--text text-xs-center"},[t._v("\n            No hay auditores seleccionados\n          ")])])],2)],1),t._v(" "),a("v-divider"),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{flat:"",color:"grey"},domProps:{textContent:t._s("Cerrar")},on:{click:function(e){t.openM=!1}}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){return t.asignar()}}},[t._v("Guardar")])],1)],1):t._e()],1)},o=[],n={render:i,staticRenderFns:o};e.a=n}});
//# sourceMappingURL=378.ec662be3690920bf77fb.js.map