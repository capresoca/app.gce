webpackJsonp([157],{1204:function(a,r,t){"use strict";var e=t(249),o=t.n(e),s=t(7),l=t.n(s),i=t(13),d=t.n(i),n=t(14),u=t.n(n),c=t(23),p=t.n(c),v=t(58),b=t(40),_=t(248),m=t(12),g=t(251);r.a={name:"RegistroTraslado",props:["parametros"],components:{Loading:v.default,InputNumber:function(){return new Promise(function(a){a()}).then(t.bind(null,254))}},data:function(){return{prTraslado:null,dialog2:!1,dialogThree:!1,presupuesto:null,presupuestos:[],presupuestoRubroTrasladado:null,detalle_anulacion:null,rubroTraslado:null,rubros:[],rubrosFiltrados:[],rubrosCreados:"",detalle:{},localLoading:!1,cambiarValor:!1,seEstaCreando:!1,tableLoading:!1,loadingSubmit:!1,dialog:!1,menuDate:!1,readOnly:!1,loadingUno:!1,loadingRubroUno:!1,loadingRubroDos:!1,valorATrasladar:0,valorTrasladado:0,nuevoValorTraslado:0,valorDisponible:0,valorRubroTraslado:0,headers:[{text:"Rubro Debitado",align:"left",sortable:!1,value:"rubro_trasladado"},{text:"Valor Debitado",align:"center",sortable:!1,value:"valorInicial"},{text:"Rubro Acreditado",align:"center",sortable:!1,value:"rubro_traslado"},{text:"Valor Rubro Acreditado",align:"center",sortable:!1,value:"rubroTraslado"},{text:"Valor Trasladado",align:"center",sortable:!1,value:"valor_movimiento"},{text:"Opciones",align:"center",sortable:!1,value:"id"}]}},created:function(){var a=this;this.formReset(),this.resetDialog(),this.validadorPostulador(),g.a.extend("rubroTraslado",{validate:function(r){return new p.a(function(t){if(null!==r&&void 0!==r&&""!==r){var e=(a.detalle.rubro_trasladado?a.detalle.rubro_trasladado.id:0)===r.id?{valido:!1,mensaje:"El rubro seleccionado debe ser diferente al rubro a trasladar."}:{valido:!0,mensaje:null};return t({valid:e.valido,data:{message:e.mensaje}})}})},getMessage:function(a,r,t){return t.message}})},mounted:function(){null!==this.parametros.entidad?this.getRegister():(this.dialog2=!0,this.seEstaCreando=!0);var a={custom:{rubro:{not_in:"El rubro ya fue registrado para traslado."}}};this.$validator.localize("es",a)},computed:{iconoEstado:function(){return"Registrado"===this.prTraslado.estado?"stars":"Confirmado"===this.prTraslado.estado?"check_circle":"Anulado"===this.prTraslado.estado?"remove_circle":void 0},colorEstado:function(){return"Registrado"===this.prTraslado.estado?"primary":"Confirmado"===this.prTraslado.estado?"teal":"Anulado"===this.prTraslado.estado?"red":void 0},computedDateFormatted:function(){return this.formDate(this.prTraslado.fecha)}},watch:{"prTraslado.tipo":function(a){a&&(this.obtenerPresupuestos(),this.dialog2=!1)},"detalle.pr_rubro_trasladado_id":function(a){a?this.obtenerPresupuestoRubroATrasladar():(this.presupuestoRubroTrasladado=null,this.rubroTraslado=null,this.detalle.rubro_traslado=null,this.detalle.pr_rubro_id=null,this.detalle.saldo_rubro=null)},"detalle.pr_rubro_id":function(a){a?this.obtenerRubroATraslado():this.rubroTraslado=null},"detalle.saldo_rubro":function(a){this.valorATrasladar=null===a?0:a},valorTrasladado:function(a){this.modificandoSaldoRubro(a),this.detalle.valor_movimiento=a}},methods:{getRegister:function(){var a=this,r=this.$loading.show({container:this.$refs.formTraladoPresupuesto.$el}),t=this.parametros.entidad.id;this.axios.get("pr_traslados/"+t).then(function(t){""!==t.data&&(a.prTraslado=t.data.data,"Registrado"===t.data.data.estado&&a.obtenerPresupuesto(a.prTraslado.periodo),"Registrado"!==a.prTraslado.estado&&(a.readOnly=!0,a.prTraslado.periodo=t.data.data.periodo,a.presupuesto="Gasto"===a.prTraslado.tipo?t.data.data.presupuesto_inicial_gasto:t.data.data.presupuesto_inicial_ingreso,a.prTraslado.pr_strgasto_id="Gasto"===a.prTraslado.tipo?a.presupuesto.id:null,a.prTraslado.pr_stringreso_id="Ingreso"===a.prTraslado.tipo?a.presupuesto.id:null,a.prTraslado.detalles=t.data.data.detalles)),r.hide()}).catch(function(t){r.hide(),a.$store.commit(m.a,{expression:" al traer el traslado presupuestal. ",error:t})})},modificandoSaldoRubro:function(a){if(console.log("guest",a),a>this.valorDisponible||0===a||null===a||""===a)this.valorATrasladar=this.valorDisponible,this.nuevoValorTraslado=0;else{var r=parseFloat(a),t=r,e=0,o=0;this.valorATrasladar=this.valorDisponible,this.nuevoValorTraslado=this.valorRubroTraslado,a!==t?(e=Math.round(this.valorATrasladar-parseFloat(a)),o=Math.round(this.nuevoValorTraslado+parseFloat(a))):(e=Math.round(this.valorATrasladar-parseFloat(r)),o=Math.round(this.nuevoValorTraslado+parseFloat(r))),console.log("valor",r),this.valorATrasladar=e,this.nuevoValorTraslado=o}},obtenerPresupuestos:function(){var a=this;if(!this.prTraslado.id){var r="Ingreso"===this.prTraslado.tipo?"peridos_presupuesto_ingresos":"peridos_presupuesto_gastos";this.axios.get(r).then(function(r){if(!0===r.data.exists){a.presupuestos=r.data.data;var t=a.moment().format("YYYY");a.presupuestos.find(function(a){return a===t})?(a.prTraslado.periodo=t,a.obtenerPresupuesto(t)):a.$store.commit(m.b,{msg:"No se encuentra confirmado el periodo actual.",color:"danger"})}else a.$store.commit(m.b,{msg:r.data.data,color:"danger"})}).catch(function(r){a.$store.commit(m.a,{expression:" al obtener presupuesto. ",error:r})})}},obtenerPresupuesto:function(a){var r=this;this.loadingUno=!0;var t=this.prTraslado.tipo;this.axios.get("periodo_presupuestos?periodo="+a+"&tipo="+t).then(function(a){""!==a.data&&(r.presupuesto=a.data.presupuesto,r.rubros=a.data.rubros,r.prTraslado.pr_strgasto_id="Gasto"===t?r.presupuesto.id:null,r.prTraslado.pr_stringreso_id="Ingreso"===t?r.presupuesto.id:null,r.prTraslado.periodo=r.presupuesto.periodo),r.loadingUno=!1}).catch(function(a){r.loadingUno=!1,r.$store.commit(m.b,{msg:"Hay un error al traer el registro. "+a,color:"danger"})})},obtenerPresupuestoRubroATrasladar:function(){var a=this;this.loadingRubroUno=!0;var r=this.presupuesto.id;this.axios.get("presupuesto_rubro_traslado?presupuestoId="+r+"&rubroId="+this.detalle.rubro_trasladado.id+"&tipo="+this.prTraslado.tipo).then(function(r){a.presupuestoRubroTrasladado=r.data.data,a.detalle.saldo_rubro=a.presupuestoRubroTrasladado.valor_disponible,a.valorDisponible=r.data.data.valor_disponible,a.loadingRubroUno=!1}).catch(function(r){a.loadingRubroUno=!1,a.$store.commit(m.b,{msg:"Hay un error al traer el registro. "+r,color:"danger"})})},obtenerRubroATraslado:function(){var a=this;this.loadingRubroDos=!0;var r=this.presupuesto.id;this.axios.get("presupuesto_rubro_traslado?presupuestoId="+r+"&rubroId="+this.detalle.rubro_traslado.id+"&tipo="+this.prTraslado.tipo).then(function(r){a.rubroTraslado=r.data.data,a.detalle.tipo_gasto=a.rubroTraslado.tipo_gasto,a.detalle.tipo_ingreso=a.rubroTraslado.tipo_ingreso,a.detalle.valor_rubro_traslado=a.rubroTraslado.valor_disponible,a.valorRubroTraslado=r.data.data.valor_disponible,a.loadingRubroDos=!1}).catch(function(r){a.loadingRubroDos=!1,a.$store.commit(m.b,{msg:"Hay un error al traer el registro. "+r,color:"danger"})})},getRubrosUsados:function(){var a=this;return this.prTraslado.detalles.map(function(r){if(null==a.detalle.rubro_traslado.id||a.detalle.rubro_traslado.id!==r.rubro_traslado.id)return r.rubro_traslado.id})},abrirModal:function(){this.dialog=!0},agregarDetalle:function(a){var r=this;return u()(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.validador("formDialogGastos");case 2:if(!t.sent){t.next=10;break}r.agregarValoresAlDetalle(),"number"!=typeof a.indexId?r.prTraslado.detalles.push(a):r.prTraslado.detalles.splice(r.prTraslado.detalles.findIndex(function(t){return r.prTraslado.detalles.indexOf(t)===a.indexId}),1,a),r.$validator.reset(),r.resetDialog(),r.dialog=!1,t.next=11;break;case 10:r.$store.commit(m.b,{msg:"Hay uno o más campos vacios.",color:"danger"});case 11:case"end":return t.stop()}},t,r)}))()},editarDetalle:function(a,r){this.valorTrasladado=r.valor_movimiento,this.detalle=JSON.parse(l()(r)),this.detalle.indexId=a,this.valorDisponible=this.detalle.saldo_rubro,this.valorRubroTraslado=this.detalle.valor_rubro_traslado,this.rubrosCreados=this.getRubrosUsados(),this.dialog=!0},eliminarDetalle:function(a){this.prTraslado.detalles.splice(a,1),this.dialog=!1},cancelarDealle:function(){this.resetDialog(),this.$validator.reset(),this.valorTrasladado=0,this.dialog=!1},formReset:function(){this.prTraslado={id:null,consecutivo_presupuestal:null,periodo:null,fecha:null,documento:null,detalle_modificacion:null,tipo:null,estado:"Registrado",pr_strgasto_id:null,pr_stringreso_id:null,concepto_anulacion:null,fecha_anulacion:null,detalles:[]},this.rubrosCreados=this.getRubrosUsados(),this.presupuesto=null},resetDialog:function(){this.detalle={id:null,indexId:null,pr_detstrgasto_id:null,pr_detstringreso_id:null,pr_rubro_id:null,pr_rubro_trasladado_id:null,pr_tipo_gasto_id:null,pr_tipo_ingreso_id:null,pr_detstrgastodebitado_id:null,pr_detstringresodebitado_id:null,tipo_ingreso:null,tipo_gasto:null,saldo_rubro:null,valor_rubro_traslado:null,naturaleza:null,valor_movimiento:null,rubro_trasladado:null,detalleGasto:null,detalleIngreso:null,rubro_traslado:null},this.valorATrasladar=0,this.valorTrasladado=0,this.nuevoValorTraslado=0,this.valorDisponible=0,this.valorRubroTraslado=0,this.presupuestoRubroTrasladado=null,this.rubroTraslado=null},agregarValoresAlDetalle:function(){this.detalle.saldo_rubro=this.presupuestoRubroTrasladado.valor_disponible,"Gasto"===this.prTraslado.tipo?(this.detalle.pr_detstrgastodebitado_id=this.presupuestoRubroTrasladado.id,this.detalle.pr_detstrgasto_id=this.rubroTraslado.id,this.detalle.pr_tipo_gasto_id=this.rubroTraslado.tipo_gasto.id):(this.detalle.pr_detstringresodebitado_id=this.presupuestoRubroTrasladado.id,this.detalle.pr_detstringreso_id=this.rubroTraslado.id,this.detalle.pr_tipo_ingreso_id=this.rubroTraslado.tipo_ingreso.id)},formDate:function(a){if(!a)return null;var r=a.split("-"),t=o()(r,3);return t[0]+"/"+t[1]+"/"+t[2]},filterRubros:function(a,r){var t=function(a){return null!=a?a:""},e=t(a.nombre+" "+a.codigo),o=t(r);return e.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1},validador:function(a){return this.$validator.validateAll(a).then(function(a){return a})},validadorPostulador:function(){var a=this;g.a.extend("rubroValido",{validate:function(r,t){return new p.a(function(t){var e={};if(null!==r&&void 0!==r&&""!==r)return e=a.rubrosCreados.includes(r.id)?{valido:!1,mensaje:"Rubro ya usado"}:{valido:!0,mensaje:null},t({valid:e.valido,data:{message:e.mensaje}})})},getMessage:function(a,r,t){return t.message}})},confirmar:function(){this.prTraslado.estado="Confirmado",this.submit()},anular:function(a){this.prTraslado.estado=1===a?"Anulado":"Registrado",this.detalle_anulacion=null,this.dialogThree=1===a},actualizarEstado:function(a){this.prTraslado.concepto_anulacion=a,this.submit()},cerrar:function(){this.$store.dispatch(b.c,{contexto:this,itemId:this.parametros.tabOrigin})},submit:function(){var a=this;return u()(d.a.mark(function r(){var t,e;return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.validador("formGastos");case 2:if(!r.sent){r.next=9;break}a.localLoading=!0,t=a.prTraslado.id?"editar":"crear",e=a.prTraslado.id?a.axios.put("pr_traslados/"+a.prTraslado.id,a.prTraslado):a.axios.post("pr_traslados",a.prTraslado),e.then(function(r){a.$store.commit(m.b,{msg:"Item "+(a.prTraslado.id?"actualizado":"creado")+" satisfactoriamente",color:"success"}),a.$store.commit(_._26,{item:r.data.data,estado:t,key:a.parametros.key}),a.$store.dispatch(b.c,{contexto:a,itemId:a.parametros.tabOrigin})}).catch(function(r){a.localLoading=!1,a.$store.commit(m.a,{expression:" al guardar el registro. ",error:r})}),r.next=10;break;case 9:a.$store.commit(m.b,{msg:"Hay uno o más campos vacios.",color:"danger"});case 10:case"end":return r.stop()}},r,a)}))()}}}},2152:function(a,r,t){var e=t(2153);"string"==typeof e&&(e=[[a.i,e,""]]),e.locals&&(a.exports=e.locals);t(456)("6683a863",e,!0,{})},2153:function(a,r,t){r=a.exports=t(455)(!0),r.push([a.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroTraslado.vue",sourceRoot:""}])},2154:function(a,r,t){"use strict";var e=function(){var a=this,r=a.$createElement,t=a._self._c||r;return t("div",[t("v-dialog",{attrs:{persistent:"","max-width":"300"},model:{value:a.dialog2,callback:function(r){a.dialog2=r},expression:"dialog2"}},[t("v-card",[t("v-card-title",{staticClass:"headline grey lighten-3"},[a._v("¿En qué tipo de estructura presupuestal realizará traslado?")]),a._v(" "),t("v-container",[t("v-radio-group",{attrs:{row:""},model:{value:a.prTraslado.tipo,callback:function(r){a.$set(a.prTraslado,"tipo",r)},expression:"prTraslado.tipo"}},[t("v-radio",{attrs:{label:"Ingresos",value:"Ingreso"}}),a._v(" "),t("v-radio",{attrs:{label:"Gastos",value:"Gasto"}})],1)],1),a._v(" "),t("v-card-actions",{staticClass:"grey lighten-3"},[t("v-spacer"),a._v(" "),t("v-btn",{attrs:{color:"black lighten-3",medium:"",flat:""},domProps:{textContent:a._s("Cancelar")},on:{click:a.cerrar}})],1)],1)],1),a._v(" "),t("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:a.dialogThree,callback:function(r){a.dialogThree=r},expression:"dialogThree"}},[t("v-card",[t("v-card-title",{staticClass:"grey lighten-3"},[t("v-card-text",{staticClass:"title"},[a._v("¿Por qué anula el traslado?")])],1),a._v(" "),t("v-container",{attrs:{fluid:""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:""}},[t("v-textarea",{attrs:{outline:"",color:"primary",name:"Detalle de anulación"},model:{value:a.detalle_anulacion,callback:function(r){a.detalle_anulacion=r},expression:"detalle_anulacion"}},[t("div",{attrs:{slot:"label"},slot:"label"},[a._v("\n                  Detalle de anulación\n                ")])])],1)],1)],1),a._v(" "),t("v-card-actions",[t("v-spacer"),a._v(" "),t("v-btn",{attrs:{flat:""},nativeOn:{click:function(r){return a.anular(2)}}},[a._v("Cancelar")]),a._v(" "),t("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(r){return a.actualizarEstado(a.detalle_anulacion)}}},[a._v("Enviar")])],1)],1)],1),a._v(" "),t("v-card",{ref:"formTraladoPresupuesto"},[t("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[t("v-toolbar-title",{domProps:{textContent:a._s("Traslado a Presupuesto Inicial de "+(null===a.prTraslado.tipo?"N/A":"Ingreso"!==a.prTraslado.tipo?"Gastos":"Ingresos"))}}),a._v(" "),t("v-spacer"),a._v(" "),a.prTraslado.id?t("v-chip",{attrs:{label:"",color:"white","text-color":"red",dark:"",absolute:"",right:"",top:""}},[t("span",{staticClass:"subheading"},[a._v("N°")]),a._v(" \n          "),t("span",{staticClass:"subheading",domProps:{textContent:a._s(null==a.prTraslado.consecutivo_presupuestal?"00":a.prTraslado.consecutivo_presupuestal)}})]):a._e(),a._v(" "),a.prTraslado.id?t("v-chip",{attrs:{color:a.colorEstado,"text-color":"white"}},[t("v-avatar",[t("v-icon",[a._v(a._s(a.iconoEstado))])],1),a._v("\n          "+a._s(a.prTraslado.estado)+"\n        ")],1):a._e()],1),a._v(" "),t("v-container",{staticStyle:{"max-width":"inherit"},attrs:{"grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:""}},[t("v-form",{attrs:{"data-vv-scope":"formGastos"}},[t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{staticClass:"pb-4",attrs:{xs12:""}},[t("v-card",[t("v-toolbar",{staticClass:"grey lighten-4 elevation-0",attrs:{dense:""}},[t("v-toolbar-title",{staticClass:"subheading"},[t("v-icon",[a._v("assignment_ind")]),a._v(" Presupuesto")],1)],1),a._v(" "),t("v-card-text",[t("v-layout",{attrs:{row:"",wrap:""}},[a.prTraslado.id?t("v-flex",{attrs:{xs12:"",sm4:""}},[t("v-text-field",{key:"periodo",attrs:{loading:a.loadingUno,"prepend-icon":"calendar_today",label:"Periodo",readonly:""},model:{value:a.prTraslado.periodo,callback:function(r){a.$set(a.prTraslado,"periodo",r)},expression:"prTraslado.periodo"}})],1):t("v-flex",{attrs:{xs12:"",sm4:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:a.presupuestos,loading:a.loadingUno,name:"periodo",label:"Periodo","no-data-text":"No hay resoluciones disponibles","error-messages":a.errors.collect("periodo"),required:"","prepend-icon":"calendar_today"},on:{change:function(r){return a.obtenerPresupuesto(r)}},model:{value:a.prTraslado.periodo,callback:function(r){a.$set(a.prTraslado,"periodo",r)},expression:"prTraslado.periodo"}})],1),a._v(" "),t("v-flex",{attrs:{xs12:"",sm4:""}},[t("v-text-field",{key:"unidad ejecturoa",attrs:{value:a.presupuesto&&a.presupuesto.entidad_resolucion?a.presupuesto.entidad_resolucion.codigo:null,"prepend-icon":"account_balance",loading:a.loadingUno,label:"Unidad ejecutora",readonly:""}})],1),a._v(" "),t("v-flex",{attrs:{xs12:"",sm4:""}},[t("v-text-field",{key:"nombre",attrs:{value:a.presupuesto?a.presupuesto.entidad_resolucion.nombre:null,loading:a.loadingUno,"prepend-icon":"account_balance",label:"Nombre",readonly:""}})],1)],1)],1)],1)],1),a._v(" "),t("v-flex",{staticClass:"pb-4",attrs:{xs12:""}},[t("v-card",[t("v-toolbar",{staticClass:"grey lighten-4 elevation-0",attrs:{dense:""}},[t("v-toolbar-title",{staticClass:"subheading"},[t("v-icon",[a._v("assignment_ind")]),a._v(" General")],1)],1),a._v(" "),t("v-card-text",{attrs:{fluid:"","grid-list-xl":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[a.prTraslado.id?t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-text-field",{key:"fecha",attrs:{"prepend-icon":"event",label:"Fecha",name:"fecha",readonly:"","error-messages":a.errors.collect("fecha")},model:{value:a.computedDateFormatted,callback:function(r){a.computedDateFormatted=r},expression:"computedDateFormatted"}})],1):t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:a.menuDate,callback:function(r){a.menuDate=r},expression:"menuDate"}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],key:"fecha",attrs:{slot:"activator",label:"Fecha","prepend-icon":"event",readonly:"",name:"fecha","error-messages":a.errors.collect("fecha")},slot:"activator",model:{value:a.computedDateFormatted,callback:function(r){a.computedDateFormatted=r},expression:"computedDateFormatted"}}),a._v(" "),t("v-date-picker",{attrs:{locale:"es","no-title":"",readonly:a.readOnly},on:{input:function(r){a.menuDate=!1},change:function(){var r=a.$validator.errors.items.findIndex(function(a){return"fecha"===a.field});a.$validator.errors.items.splice(-1!==r?r:0,-1!==r?1:0)}},model:{value:a.prTraslado.fecha,callback:function(r){a.$set(a.prTraslado,"fecha",r)},expression:"prTraslado.fecha"}})],1)],1),a._v(" "),t("v-flex",{attrs:{xs12:"",sm8:"",md8:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"documento",attrs:{"prepend-icon":"assignment",label:"Documento",name:"documento",required:"",readonly:a.readOnly,"error-messages":a.errors.collect("documento")},model:{value:a.prTraslado.documento,callback:function(r){a.$set(a.prTraslado,"documento",r)},expression:"prTraslado.documento"}})],1),a._v(" "),t("v-layout",[t("v-flex",{attrs:{xs12:""}},[t("v-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"observaciones",attrs:{"auto-grow":"",rows:"1","prepend-icon":"reorder",label:"Observaciones",name:"observaciones",readonly:a.readOnly,"error-messages":a.errors.collect("observaciones")},model:{value:a.prTraslado.observaciones,callback:function(r){a.$set(a.prTraslado,"observaciones",r)},expression:"prTraslado.observaciones"}})],1)],1)],1)],1)],1)],1),a._v(" "),t("v-expand-transition",[(a.presupuesto?a.presupuesto.id:null)?t("v-layout",[(a.presupuesto?a.presupuesto.id:null)?t("v-flex",{staticClass:"pb-4",attrs:{xs12:""}},[[t("loading",{model:{value:a.localLoading,callback:function(r){a.localLoading=r},expression:"localLoading"}}),a._v(" "),t("v-card",[t("v-toolbar",{staticClass:"grey lighten-3 elevation-0",attrs:{dense:""}},[t("v-toolbar-title",{staticClass:"subheading",domProps:{textContent:a._s("Traslados")}}),a._v(" "),t("v-spacer"),a._v(" "),a.readOnly?a._e():t("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(r){return r.preventDefault(),a.abrirModal(r)}}},[t("v-icon",[a._v("add")]),a._v(" Agregar")],1)],1),a._v(" "),t("v-expand-transition",{attrs:{mode:"in-out"}},[t("v-card",{directives:[{name:"show",rawName:"v-show",value:a.dialog,expression:"dialog"}],ref:"dialogTraslados"},[t("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[t("span",{staticClass:"subheading pl-2",staticStyle:{"font-weight":"500"},domProps:{textContent:a._s("Nuevo Traslado")}})]),a._v(" "),t("v-form",{attrs:{"data-vv-scope":"formDialogGastos"}},[t("v-container",{attrs:{fluid:"","grid-list-xl":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:a.rubros,filter:a.filterRubros,loading:a.loadingRubroUno,"item-text":"nombre","item-value":"id",name:"rubro a debitar",label:"Rubro a Debitar",hint:a.detalle.rubro_trasladado?"Código: "+a.detalle.rubro_trasladado.codigo:"","persistent-hint":"","no-data-text":"No hay rubros disponibles","error-messages":a.errors.collect("rubro a debitar"),"prepend-icon":"subtitles","return-object":"",clearable:"",flat:""},on:{change:function(r){return a.detalle.pr_rubro_trasladado_id=r?r.id:null}},scopedSlots:a._u([{key:"item",fn:function(r){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:a._s(r.item.nombre)}}),a._v(" "),t("v-list-tile-sub-title",{domProps:{innerHTML:a._s(r.item.codigo)}})],1)]]}}],null,!1,3181165253),model:{value:a.detalle.rubro_trasladado,callback:function(r){a.$set(a.detalle,"rubro_trasladado",r)},expression:"detalle.rubro_trasladado"}}),a._v(" "),[t("v-expand-transition",[a.presupuestoRubroTrasladado?t("v-list",{staticClass:"grey lighten-4"},[t("v-list-tile",[t("v-list-tile-content",[t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s("<b>Valor</b>"+(a.detalle.id&&a.detalle.indexId?"<b> anterior:</b> "+a.currency(a.detalle.saldo_rubro):"<b> disponible:</b> "+a.currency(a.presupuestoRubroTrasladado.valor_disponible)))}}),a._v(" "),t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s(a.presupuestoRubroTrasladado.tipo_gasto?"<b>Tipo de gasto:</b> "+a.presupuestoRubroTrasladado.tipo_gasto.nombre:a.presupuestoRubroTrasladado.tipo_ingreso?"<b>Tipo de ingreso:</b> "+a.presupuestoRubroTrasladado.tipo_ingreso.nombre:"")}})],1)],1)],1):a._e()],1)]],2),a._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required|not_in:"+a.rubrosCreados+"|rubroTraslado",expression:"'required|not_in:'+ rubrosCreados +'|rubroTraslado'"}],key:"rubro",attrs:{items:a.rubros,filter:a.filterRubros,"item-text":"nombre","item-value":"id",loading:a.loadingRubroDos,name:"rubro",disabled:null===a.detalle.rubro_trasladado,label:"Rubro Acreditar",hint:a.detalle.rubro_traslado?"Código: "+a.detalle.rubro_traslado.codigo:"","persistent-hint":"","no-data-text":"No hay rubros disponibles","error-messages":a.errors.collect("rubro"),required:"","prepend-icon":"subtitles","return-object":"",clearable:"",flat:""},on:{change:function(r){return a.detalle.pr_rubro_id=r?r.id:null}},scopedSlots:a._u([{key:"item",fn:function(r){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:a._s(r.item.nombre)}}),a._v(" "),t("v-list-tile-sub-title",{domProps:{innerHTML:a._s(r.item.codigo)}})],1)]]}}],null,!1,3181165253),model:{value:a.detalle.rubro_traslado,callback:function(r){a.$set(a.detalle,"rubro_traslado",r)},expression:"detalle.rubro_traslado"}}),a._v(" "),[t("v-expand-transition",[a.rubroTraslado?t("v-list",{staticClass:"grey lighten-4"},[t("v-list-tile",[t("v-list-tile-content",[t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s("<b>Valor</b>"+(a.detalle.id&&a.detalle.indexId?"<b> anterior:</b> "+a.currency(a.rubroTraslado.valor_disponible-a.detalle.valor_movimiento):"<b> actual:</b> "+a.currency(a.rubroTraslado.valor_disponible)))}}),a._v(" "),t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s(a.rubroTraslado.tipo_gasto?"<b>Tipo de gasto:</b> "+a.rubroTraslado.tipo_gasto.nombre:a.rubroTraslado.tipo_ingreso?"<b>Tipo de ingreso:</b> "+a.rubroTraslado.tipo_ingreso.nombre:"")}})],1)],1)],1):a._e()],1)]],2),a._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required|min_value:1|max_value:"+(a.presupuestoRubroTrasladado?a.presupuestoRubroTrasladado.valor_disponible:null),expression:"'required|min_value:1|max_value:' + (presupuestoRubroTrasladado ? presupuestoRubroTrasladado.valor_disponible : null)"}],key:"valor a trasladar",attrs:{label:"Valor A Trasladar",id:"valorMovimiento",name:"valor a trasladar","prepend-icon":"attach_money",disabled:null===a.detalle.rubro_trasladado||null===a.detalle.rubro_traslado||(a.detalle.rubro_trasladado?a.detalle.rubro_trasladado.id:a.detalle.rubro_trasladado=null)===(a.detalle.rubro_traslado?a.detalle.rubro_traslado.id:a.detalle.rubro_traslado=null),precision:0,"error-messages":a.errors.collect("valor a trasladar")},model:{value:a.valorTrasladado,callback:function(r){a.valorTrasladado=a._n(r)},expression:"valorTrasladado"}}),a._v(" "),[t("v-expand-transition",[0!==a.valorTrasladado&&a.valorTrasladado>0?t("v-list",{staticClass:"grey lighten-4"},[t("v-list-tile",[t("v-list-tile-content",[t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s("<b>Saldo rubro debitado: </b>"+a.currency(a.valorATrasladar))}}),a._v(" "),t("v-list-tile-title",{staticClass:"body-1",domProps:{innerHTML:a._s("<b>Nuevo valor acreditado: </b>"+a.currency(a.nuevoValorTraslado))}})],1)],1)],1):a._e()],1)]],2)],1)],1)],1),a._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-spacer"),a._v(" "),t("v-btn",{staticClass:"white--text",attrs:{flat:"",small:"",color:"red",dark:""},on:{click:a.cancelarDealle}},[a._v("Cancelar")]),a._v(" "),t("v-btn",{attrs:{flat:"",small:"",color:"primary",dark:""},domProps:{textContent:a._s(a.detalle.id?"Actualizar":"Agregar")},on:{click:function(r){return a.agregarDetalle(a.detalle)}}})],1)],1)],1),a._v(" "),t("v-expand-transition",[a.prTraslado.detalles.length?t("v-data-table",{attrs:{headers:a.headers,items:a.prTraslado.detalles,loading:a.tableLoading,"hide-actions":"","rows-per-page-text":"Registros por página","rows-per-page-items":[5,10,25,{text:"Todos",value:-1}]},scopedSlots:a._u([{key:"items",fn:function(r){return[t("td",{staticClass:"text-xs-left"},[a._v(a._s(r.item.rubro_trasladado?r.item.rubro_trasladado.codigo:""))]),a._v(" "),t("td",{staticClass:"text-xs-right"},[a._v(a._s(a._f("numberFormat")(r.item.saldo_rubro,0,"$")))]),a._v(" "),t("td",{staticClass:"text-xs-center"},[a._v(a._s(r.item.rubro_traslado?r.item.rubro_traslado.codigo:""))]),a._v(" "),t("td",{staticClass:"text-xs-right"},[a._v(a._s(a.currency(r.item.valor_rubro_traslado)))]),a._v(" "),t("td",{staticClass:"text-xs-right"},[a._v(a._s(a._f("numberFormat")(r.item.valor_movimiento,0,"$")))]),a._v(" "),t("td",{staticClass:"text-xs-center"},["Registrado"===a.prTraslado.estado?t("v-speed-dial",{attrs:{direction:"left","open-on-hover":"",transition:"slide-x-transition"},model:{value:r.item.show,callback:function(t){a.$set(r.item,"show",t)},expression:"props.item.show"}},[t("v-btn",{attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:"",small:""},slot:"activator",model:{value:r.item.show,callback:function(t){a.$set(r.item,"show",t)},expression:"props.item.show"}},[t("v-icon",[a._v("chevron_left")]),a._v(" "),t("v-icon",[a._v("close")])],1),a._v(" "),t("v-tooltip",{attrs:{top:""}},[t("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"white"},on:{click:function(t){return a.editarDetalle(r.index,r.item)}},slot:"activator"},[t("v-icon",{attrs:{color:"accent"}},[a._v("mode_edit")])],1),a._v(" "),t("span",[a._v("Editar")])],1),a._v(" "),t("v-tooltip",{attrs:{top:""}},[t("v-btn",{attrs:{slot:"activator",fab:"",dark:"",small:"",color:"white"},on:{click:function(t){return a.eliminarDetalle(r.index,r.item.id)}},slot:"activator"},[t("v-icon",{attrs:{color:"accent"}},[a._v("delete")])],1),a._v(" "),t("span",[a._v("Eliminar")])],1)],1):a._e()],1)]}},{key:"pageText",fn:function(r){return[a._v("\n                                    "+a._s(r.pageStart)+" - "+a._s(r.pageStop)+" de "+a._s(r.itemsLength)+"\n                                  ")]}}],null,!1,1185023296)},[a._v(" "),t("template",{slot:"no-data"},[a.tableLoading?t("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[a._v("\n                                      Estamos cargando los registros. "),t("v-icon",[a._v("sentiment_satisfied_alt")])],1):t("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[a._v("\n                                      Lo sentimos, no tenemos registros para mostrar. "),t("v-icon",[a._v("sentiment_very_dissatisfied")])],1)],1)],2):a._e()],1)],1)]],2):a._e()],1):a._e()],1)],1)],1)],1)],1)],1)],1),a._v(" "),t("v-divider"),a._v(" "),"Registrado"===a.prTraslado.estado?t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{staticClass:"text-xs-center text-sm-left",attrs:{xs12:"",sm6:""}},[a.prTraslado.id?t("v-btn",{attrs:{dark:"",color:"danger",loading:a.loadingSubmit},domProps:{textContent:a._s("Anular")},on:{click:function(r){return a.anular(1)}}}):a._e()],1),a._v(" "),t("v-flex",{staticClass:"text-xs-center text-xs-right pt-1",attrs:{xs12:"",sm6:""}},["Confirmado"!==a.prTraslado.estado?t("v-btn",{attrs:{color:"primary",loading:a.loadingSubmit},on:{click:function(r){return r.preventDefault(),a.submit(r)}}},[a._v("Guardar")]):a._e(),a._v(" "),t("v-btn",{attrs:{slot:"activator",color:"success"},on:{click:a.confirmar},slot:"activator"},[a.prTraslado.id?t("span",[a._v("Confirmar")]):t("span",[a._v("Guardar y Confirmar")])])],1)],1)],1):a._e()],1)],1)},o=[],s={render:e,staticRenderFns:o};r.a=s},658:function(a,r,t){"use strict";function e(a){t(2152)}Object.defineProperty(r,"__esModule",{value:!0});var o=t(1204),s=t(2154),l=t(1),i=e,d=l(o.a,s.a,!1,i,"data-v-790b510a",null);r.default=d.exports}});
//# sourceMappingURL=157.d9d4eae813eec2d2d614.js.map