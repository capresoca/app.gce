webpackJsonp([381],{1264:function(e,t,a){"use strict";var i=a(13),o=a.n(i),s=a(14),n=a.n(s),r=a(249),c=a.n(r),l=a(7),d=a.n(l),u=a(12),m=a(58);t.a={name:"Insumos",components:{Loading:m.default},props:{data:{type:Object,default:null},concurrencia:{type:Object,default:{}}},data:function(){return{insumo:{},glosas:[],dialog:!1,loading:!1,loadingSubmit:!1,menuDate:!1,headers:[{text:"id",align:"left",sortable:!1,value:"id"},{text:"Código",align:"left",sortable:!1,value:"codigo"},{text:"Cantidad",align:"left",sortable:!1,value:"cantidad"},{text:"Fecha",align:"left",sortable:!1,value:"fecha"},{text:"Opciones",align:"left",sortable:!1,value:"id"}]}},beforeMount:function(){this.resetDialog()},mounted:function(){this.getGlosas()},computed:{computedDateFormatted:function(){return this.formDate(this.insumo.fecha)}},methods:{getGlosas:function(){var e=this;this.axios.get("manglosas").then(function(t){""!==t.data&&(e.glosas=t.data.data.glosas)}).catch(function(t){e.$store.commit(u.b,{msg:"Hay un error al traer las glosas. "+t,color:"danger"})})},resetDialog:function(){this.insumo={id:"",cm_convisita_id:null,codigo:null,cantidad:null,descripcion:null,observaciones:null,cm_manglosa_id:null,fecha:null}},edit:function(e){this.openDialog(),this.insumo=JSON.parse(d()(e))},openDialog:function(){this.dialog=!0,this.insumo.cm_convisita_id=this.data.id},close:function(){this.dialog=!1,this.resetDialog()},formDate:function(e){if(!e)return null;var t=e.split("-"),a=c()(t,3);return a[0]+"/"+a[1]+"/"+a[2]},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},guardar:function(){var e=this;return n()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validador("form");case 2:if(!t.sent){t.next=8;break}e.loadingSubmit=!0,a=e.insumo.id?e.axios.put("cuentasmedicas/concurrencia/insumos/"+e.insumo.id,e.insumo):e.axios.post("cuentasmedicas/concurrencia/insumos",e.insumo),a.then(function(t){e.insumo.id?(e.loadingSubmit=!1,e.$store.commit(u.b,{msg:"Item actualizado satisfactoriamente",color:"success"}),e.data.insumos.splice(e.data.insumos.findIndex(function(e){return e.id===t.data.data.id}),1,t.data.data)):(e.loadingSubmit=!1,e.$store.commit(u.b,{msg:"Item creado satisfactoriamente",color:"success"}),e.data.insumos.unshift(t.data.data)),e.close()}).catch(function(t){e.loadingSubmit=!1,e.$store.commit(u.a,{expression:" al guardar el registro. ",error:t})}),t.next=9;break;case 8:e.$store.commit(u.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 9:case"end":return t.stop()}},t,e)}))()}}}},2351:function(e,t,a){"use strict";function i(e){a(2352)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1264),s=a(2354),n=a(1),r=i,c=n(o.a,s.a,!1,r,"data-v-54013eac",null);t.default=c.exports},2352:function(e,t,a){var i=a(2353);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(456)("5e9d2f59",i,!0,{})},2353:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Insumos.vue",sourceRoot:""}])},2354:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{width:"720px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-form",{attrs:{"data-vv-scope":"form"}},[a("v-card",[a("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[a("span",{staticClass:"title"},[e._v("Insumo")])]),e._v(" "),a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",md6:""}},[a("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:e.menuDate,callback:function(t){e.menuDate=t},expression:"menuDate"}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],attrs:{slot:"activator",label:"Fecha","prepend-icon":"event",readonly:"",name:"fecha",required:"","error-messages":e.errors.collect("fecha")},slot:"activator",model:{value:e.computedDateFormatted,callback:function(t){e.computedDateFormatted=t},expression:"computedDateFormatted"}}),e._v(" "),a("v-date-picker",{attrs:{locale:"es","no-title":""},on:{input:function(t){e.menuDate=!1},change:function(){var t=e.$validator.errors.items.findIndex(function(e){return"fecha"===e.field});e.$validator.errors.items.splice(-1!==t?t:0,-1!==t?1:0)}},model:{value:e.insumo.fecha,callback:function(t){e.$set(e.insumo,"fecha",t)},expression:"insumo.fecha"}})],1)],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md6:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"prepend-icon":"subtitles",label:"Código",name:"codigo",required:"","error-messages":e.errors.collect("codigo")},model:{value:e.insumo.codigo,callback:function(t){e.$set(e.insumo,"codigo",t)},expression:"insumo.codigo"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"prepend-icon":"toc",label:"Descripción",name:"descripcion",required:"","error-messages":e.errors.collect("descripcion")},model:{value:e.insumo.descripcion,callback:function(t){e.$set(e.insumo,"descripcion",t)},expression:"insumo.descripcion"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|numeric",expression:"'required|numeric'"}],attrs:{"prepend-icon":"dns",label:"Cantidad",name:"cantidad",required:"","error-messages":e.errors.collect("cantidad")},model:{value:e.insumo.cantidad,callback:function(t){e.$set(e.insumo,"cantidad",t)},expression:"insumo.cantidad"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.glosas,"item-text":"descripcion","item-value":"id",label:"Glosa","no-data-text":"No hay datos disponibles",name:"glosa","prepend-icon":"security",required:"","error-messages":e.errors.collect("glosa")},scopedSlots:e._u([{key:"item",fn:function(t){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:e._s(t.item.descripcion)}}),e._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.item.tipo)}})],1)]]}}]),model:{value:e.insumo.cm_manglosa_id,callback:function(t){e.$set(e.insumo,"cm_manglosa_id",t)},expression:"insumo.cm_manglosa_id"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{outline:"",name:"observaciones",label:"Observaciones"},model:{value:e.insumo.observaciones,callback:function(t){e.$set(e.insumo,"observaciones",t)},expression:"insumo.observaciones"}})],1)],1)],1),e._v(" "),a("v-card-actions",{staticClass:"grey lighten-4"},[a("v-spacer"),e._v(" "),a("v-btn",{on:{click:e.close}},[e._v("Cancelar")]),e._v(" "),a("v-btn",{attrs:{color:"primary",loading:e.loadingSubmit},on:{click:e.guardar}},[e._v("Guardar")])],1)],1)],1)],1),e._v(" "),a("v-card",[a("v-toolbar",{staticClass:"elevation-0",attrs:{dense:""}},[a("v-toolbar-title",[e._v("Insumos")]),e._v(" "),a("small",{staticClass:"mt-2 ml-1"},[e._v(" Registro y gestión")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",fab:"",color:"accent",small:"",disabled:"Cerrada"===e.concurrencia.estado},on:{click:function(t){return e.openDialog()}},slot:"activator"},[a("v-icon",[e._v("add")])],1),e._v(" "),a("span",[e._v(e._s("Abierta"===e.concurrencia.estado?"Crear registro":"Concurrencia cerrada"))])],1)],1),e._v(" "),a("loading",{model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),e._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.data.insumos,loading:e.loading,"rows-per-page-text":"Registros por página"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.id))]),e._v(" "),a("td",[e._v(e._s(t.item.codigo))]),e._v(" "),a("td",[e._v(e._s(t.item.cantidad))]),e._v(" "),a("td",[e._v(e._s(t.item.fecha))]),e._v(" "),a("td",[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",icon:"",disabled:"Cerrada"===e.concurrencia.estado},on:{click:function(a){return e.edit(t.item)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[e._v("edit")])],1),e._v(" "),a("span",[e._v(e._s("Abierta"===e.concurrencia.estado?"Editar":"Concurrencia cerrada"))])],1)],1)]}}])},[e._v(" "),a("template",{slot:"no-data"},[e.loading?a("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[e._v("\n          Estamos cargando los registros. "),a("v-icon",[e._v("sentiment_satisfied_alt")])],1):a("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n          Lo sentimos, no tenemos registros para mostrar. "),a("v-icon",[e._v("sentiment_very_dissatisfied")])],1)],1)],2)],1)],1)},o=[],s={render:i,staticRenderFns:o};t.a=s}});
//# sourceMappingURL=381.1cf43ae8539f50685ed5.js.map