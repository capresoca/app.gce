webpackJsonp([81],{1054:function(a,i,e){"use strict";var t=e(7),n=e.n(t),r=e(23),o=e.n(r),l=e(13),c=e.n(l),s=e(14),d=e.n(s),f=e(12),u=e(40),m=e(248);i.a={name:"RegistroAfiliacion",props:["parametros"],data:function(){return{loadingEndBtn:!1,dialogFinalizar:{show:!1,imprimir:!1,radicar:!1,fechaRadicacion:this.moment().format("DD/MM/YYYY"),menuDatex:!1},component:null,ips:null,afitramite:{},afitramiteGo:{},maxDateAfiliacion:(new Date).toISOString().substr(0,10),minDateAfiliacion:"01/01/1910",makeAfitramite:{idAfiliadoValido:null,afiliado:null,anexos:[],nf_ciiu_id:null,as_afiliado_id:null,as_archivoreporte_id:null,as_clasecotizante_id:null,as_regimene_id:2,as_tipafiliacione_id:null,as_tipafiliado_id:2,codigo_entidad:null,declaraciones:[],estado:"Registrado",fecha_anulacion:null,fecha_radicacion:null,ficha_sisben:null,gs_usuario_id:null,ibc:null,id:null,ips:null,no_radicado:null,nucleo_familiar:[],puntaje_sisben:null,recien_nacido:0,rs_ips_id:null,usuanula_id:null,afiliado_pagador:{gn_municipio_id:null,arl:null,as_afiliado_id:null,as_arl_id:null,as_formtrasmov_id:null,as_pagadore_id:null,fecha_vinculacion:null,ibc:null,id:null,pagador:null},usuradica_id:null}}},watch:{"afitramite.recien_nacido":function(a){this.afitramite.recien_nacido=a,this.dialogFinalizar.fechaRadicacion=this.moment().format("DD/MM/YYYY"),this.afitramite.afiliado=null,this.component=function(){return e(1763)("./RegistroAfiliacion"+(a?"RN":"S"))}}},beforeMount:function(){this.refresh()},mounted:function(){null!==this.parametros.entidad&&null!==this.parametros.entidad.id&&this.getRegistro(this.parametros.entidad.id)},methods:{gofinalizar:function(a){this.afitramiteGo=a,this.afitramiteGo.recien_nacido&&(this.dialogFinalizar.radicar=!0),this.dialogFinalizar.show=!0},finalizar:function(){var a=this;return d()(c.a.mark(function i(){return c.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a.loadingEndBtn=!0,a.dialogFinalizar.radicar&&(a.afitramiteGo.estado="Radicado",a.afitramiteGo.fecha_radicacion=a.dialogFinalizar.fechaRadicacion),i.next=4,a.submitAfitramite();case 4:if(!i.sent){i.next=6;break}a.$store.commit(f.b,{msg:"El trámite de afiliación se ha "+("Radicado"===a.afitramiteGo.estado?"radicado":"guardado")+" satisfactoriamente.",color:"success"});case 6:a.dialogFinalizar.show=!1,a.loadingEndBtn=!1,a.$store.dispatch(u.c,{contexto:a,itemId:a.parametros.tabOrigin}),a.dialogFinalizar.imprimir&&a.axios.get("ruta-pdf-formafiliacion?id="+a.value.id).then(function(a){""!==a.data&&window.open(a.data,"_blank")}).catch(function(i){a.$store.commit(f.a,{expression:" al generar el documento. ",error:i})});case 10:case"end":return i.stop()}},i,a)}))()},submitAfitramite:function(){var a=this,i=this.afitramiteGo.id?"editar":"crear";return new o.a(function(e,t){("editar"===i?a.axios.put("formafiliaciones/"+a.afitramiteGo.id,a.afitramiteGo):a.axios.post("formafiliaciones",a.afitramiteGo)).then(function(t){a.value=t.data.formafiliacion,a.$store.commit(m.c,{item:t.data.formafiliacion_o,estado:i,key:a.parametros.key}),a.$store.commit("reloadTable","tableItemAfilliatum"),e(!0)}).catch(function(i){a.$store.commit(f.a,{expression:" al guardar el registro del trámite de afiliación. ",error:i}),e(!1)})})},refresh:function(){this.afitramite=JSON.parse(n()(this.makeAfitramite)),this.$validator.reset()},getRegistro:function(a){var i=this;this.axios.get("formafiliaciones/"+a).then(function(a){""!==a.data&&(a.data.data.idAfiliadoValido=a.data.data.afiliado.id,i.afitramite=a.data.data)}).catch(function(a){i.$store.commit(f.a,{expression:" al traer el trámite de afiliación. ",error:a})})}}}},1761:function(a,i,e){var t=e(1762);"string"==typeof t&&(t=[[a.i,t,""]]),t.locals&&(a.exports=t.locals);e(456)("e226b49c",t,!0,{})},1762:function(a,i,e){i=a.exports=e(455)(!0),i.push([a.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroAfiliacion.vue",sourceRoot:""}])},1763:function(a,i,e){function t(a){var i=n[a];return i?Promise.all(i.slice(1).map(e.e)).then(function(){return e(i[0])}):Promise.reject(new Error("Cannot find module '"+a+"'."))}var n={"./RegistroAfiliacion":[461],"./RegistroAfiliacion.vue":[461],"./RegistroAfiliacionRN":[1055,297],"./RegistroAfiliacionRN.vue":[1055,297],"./RegistroAfiliacionS":[1058,298],"./RegistroAfiliacionS.vue":[1058,298]};t.keys=function(){return Object.keys(n)},t.id=1763,a.exports=t},1777:function(a,i,e){"use strict";var t=function(){var a=this,i=a.$createElement,e=a._self._c||i;return e("v-card",[e("v-toolbar",{attrs:{dense:""}},[e("v-icon",[a._v("file_copy")]),a._v(" "),e("v-toolbar-title",{domProps:{innerHTML:a._s((a.afitramite.id?"Edición de trámite de afiliación":"Nuevo trámite de afiliación")+": "+(a.afitramite.recien_nacido?"Recién nacido":"Régimen subsidiado"))}}),a._v(" "),e("v-spacer"),a._v(" "),a.afitramite.id?a._e():e("v-toolbar-items",[e("v-checkbox",{staticClass:"mt-2",attrs:{label:"Recién nacido","false-value":0,"true-value":1},model:{value:a.afitramite.recien_nacido,callback:function(i){a.$set(a.afitramite,"recien_nacido",i)},expression:"afitramite.recien_nacido"}})],1)],1),a._v(" "),e(a.component,{tag:"component",attrs:{afitramite:a.afitramite,parametros:a.parametros},on:{change:function(i){return a.afitramite=i},endsubmit:function(i){return a.gofinalizar(i)}}}),a._v(" "),e("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:a.dialogFinalizar.show,callback:function(i){a.$set(a.dialogFinalizar,"show",i)},expression:"dialogFinalizar.show"}},[e("v-card",[e("v-card-title",{staticClass:"grey lighten-3"},[e("span",{staticClass:"title"},[a._v("¿Qué desea hacer?")])]),a._v(" "),e("v-card-text",[e("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[e("v-layout",{attrs:{row:"",wrap:""}},[a.afitramiteGo.recien_nacido?a._e():e("v-flex",{attrs:{xs6:""}},[e("v-layout",{attrs:{"align-center":""}},[e("v-checkbox",{staticClass:"shrink mr-2",class:a.dialogFinalizar.radicar?"pb-4":"",attrs:{disabled:a.afitramiteGo&&1===a.afitramiteGo.recien_nacido,label:a.dialogFinalizar.radicar?"":"Radicar","hide-details":""},model:{value:a.dialogFinalizar.radicar,callback:function(i){a.$set(a.dialogFinalizar,"radicar",i)},expression:"dialogFinalizar.radicar"}}),a._v(" "),a.dialogFinalizar.radicar?e("v-menu",{key:"fechaRadicacionmenu",ref:"Fecha radicación",attrs:{disabled:1===a.afitramiteGo.recien_nacido,"close-on-content-click":!1,"nudge-right":40,"return-value":a.dialogFinalizar.fechaRadicacion,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(i){return a.$set(a.dialogFinalizar,"fechaRadicacion",i)},"update:return-value":function(i){return a.$set(a.dialogFinalizar,"fechaRadicacion",i)}},model:{value:a.dialogFinalizar.menuDatex,callback:function(i){a.$set(a.dialogFinalizar,"menuDatex",i)},expression:"dialogFinalizar.menuDatex"}},[e("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:DD/MM/YYYY|date_between:"+a.minDateAfiliacion+","+a.maxDateAfiliacion+",true",expression:"'required|date_format:DD/MM/YYYY' + (false ? '' : '|date_between:' + minDateAfiliacion + ',' + maxDateAfiliacion + ',true')"}],key:"fechaRadicaciontext",attrs:{slot:"activator",label:"Fecha radicación",name:"fecha radicación",required:"",max:a.maxDateAfiliacion,min:a.minDateAfiliacion,"error-messages":a.errors.collect("fecha radicación"),readonly:""},slot:"activator",model:{value:a.dialogFinalizar.fechaRadicacion,callback:function(i){a.$set(a.dialogFinalizar,"fechaRadicacion",i)},expression:"dialogFinalizar.fechaRadicacion"}}),a._v(" "),e("v-date-picker",{key:"fechaRadicaciondatepicker",attrs:{locale:"es-co"},on:{input:function(i){return a.$refs["Fecha radicación"].save(a.dialogFinalizar.fechaRadicacion)},change:function(){var i=a.$validator.errors.items.findIndex(function(a){return"fecha radicación"===a.field});a.$validator.errors.items.splice(-1!==i?i:0,-1!==i?1:0)}},model:{value:a.dialogFinalizar.fechaRadicacion,callback:function(i){a.$set(a.dialogFinalizar,"fechaRadicacion",i)},expression:"dialogFinalizar.fechaRadicacion"}})],1):a._e()],1)],1),a._v(" "),e("v-flex",{attrs:{xs6:!a.afitramiteGo.recien_nacido,xs12:a.afitramiteGo.recien_nacido}},[e("v-checkbox",{staticClass:"ml-2",attrs:{label:"Imprimir"},model:{value:a.dialogFinalizar.imprimir,callback:function(i){a.$set(a.dialogFinalizar,"imprimir",i)},expression:"dialogFinalizar.imprimir"}})],1)],1)],1)],1),a._v(" "),e("v-divider"),a._v(" "),e("v-card-actions",[e("v-spacer"),a._v(" "),e("v-btn",{attrs:{flat:"",loading:a.loadingEndBtn},on:{click:function(i){a.dialogFinalizar.show=!1}}},[a._v("Cancelar")]),a._v(" "),e("v-btn",{attrs:{color:"primary",flat:"",loading:a.loadingEndBtn},on:{click:a.finalizar}},[a._v("Guardar")])],1)],1)],1)],1)},n=[],r={render:t,staticRenderFns:n};i.a=r},461:function(a,i,e){"use strict";function t(a){e(1761)}Object.defineProperty(i,"__esModule",{value:!0});var n=e(1054),r=e(1777),o=e(1),l=t,c=o(n.a,r.a,!1,l,"data-v-2a55062c",null);i.default=c.exports}});
//# sourceMappingURL=81.6884c53696858408b7a9.js.map