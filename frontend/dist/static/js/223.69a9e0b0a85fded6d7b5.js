webpackJsonp([223],{1297:function(t,e,a){"use strict";var i=a(23),n=a.n(i),o=a(13),s=a.n(o),r=a(14),l=a.n(r),c=a(7),d=a.n(c),u=a(251),p=a(58),m=a(12),v=a(248);e.a={name:"AuditoriaPacientes",props:["parametros"],components:{Loading:p.default,PostuladorV2:function(){return new Promise(function(t){t()}).then(a.bind(null,61))},ToolbarList:function(){return new Promise(function(t){t()}).then(a.bind(null,247))},DataTable:function(){return new Promise(function(t){t()}).then(a.bind(null,60))}},data:function(){return{diOpen:!1,pacientes:null,censo:null,estado:null,asignacion:null,loadingIps:!1,auditorTemporal:null,ips:null,instituciones:[],auditores:[],itemsSeleccionados:[],dialogOpenOfMenu:!1,diOpenAntesDeAsignar:!1,ruta:null,tempIdPacienteHospitalario:null,dataTablePacientes:{nameItemState:"itemPacientesCenso",route:null,simplePaginate:!0,optionsPerPage:[{text:15,value:15},{text:50,value:50},{text:100,value:100}],makeHeaders:[{selectable:!0},{text:"PACIENTE",align:"left",sortable:!1,value:"as_afiliado_id",component:{component:{template:"\n                  <div>\n                    <mini-card-detail\n                    :data=\"value.afiliado\n                    ? value.afiliado.mini_afiliado\n                    : {identificacion_completa: value.identificacion, nombre_completo: value.nombre_paciente, id: null, emoticon: '⚠️'}\"></mini-card-detail>\n                  </div>\n                ",props:["value"]}}},{text:"ESTANCIA",align:"center",sortable:!1,value:"tiempo_estancia",component:{component:{template:"\n                  <div>\n                     <v-chip :color=\"value.color_semaforo\" text-color=\"white\" small>\n                        <v-avatar :class=\"value.color_semaforo + 'darken-4'\" medium>{{value.tiempo_estancia}}</v-avatar>\n                        <span v-text=\"'Día' + (value.tiempo_estancia !== 1 ? 's' : '')\"></span>\n                    </v-chip>\n                  </div>\n                ",props:["value"]}}},{text:"FECHA INGRESO",align:"left",sortable:!1,value:"fecha_ingreso",component:{component:{template:"\n                  <div>\n                   <span v-text=\"moment(value.fecha_ingreso).format('YYYY/MM/DD')\"></span>\n                  </div>\n                ",props:["value"]}},classData:"text-xs-center"},{text:"CAMA/SERVICIO",align:"left",sortable:!1,value:"cama_servicio"},{text:"DIAGNOSTICO",align:"left",sortable:!1,value:"cod_dx",component:{component:{template:"\n                  <div>\n                   <span v-text=\"value.cod_dx !== null ? (value.cod_dx + ' - ' + value.nombre_diagnostico) : 'No Registra'\"></span>\n                  </div>\n                ",props:["value"]}}},{text:"CÓDIGO INGRESO",align:"left",sortable:!1,value:"consecutivo_entidad"},{text:"ESTADO",align:"left",sortable:!0,value:"estado"},{text:"OPCIONES",align:"center",sortable:!1,actions:!0,singlesActions:!0,classData:"text-xs-center"}],filters:[{label:"Estado",type:"v-autocomplete",items:function(){return[{text:"Sin Asignar",value:"Sin Asignar"},{text:"Asignado",value:"Asignado"},{text:"Cerrado",value:"Cerrado"}]},vModel:[],multiple:!0,itemText:"text",itemValue:"value",value:"estado",clearable:!0}]},headersAuditor:[{text:"Identificación",align:"left",sortable:!1,value:"auditor.usuario.identification"},{text:"Nombre",align:"left",sortable:!1,value:"auditor.usuario.name"},{text:"Tipo Auditor",align:"left",sortable:!1,value:"auditor"},{text:"Eliminar",align:"center",sortable:!1,value:""}]}},watch:{auditorTemporal:function(t){var e=this;t&&this.$validator.validateAll("formAsignarAuditor").then(function(a){if(a){if(e.auditores.length&&e.auditores.find(function(e){return e.id===t.id}))return;var i=JSON.parse(d()(t));e.asignacion.auditores.push(t.id),e.auditores.push(i),e.$nextTick(function(){e.auditorTemporal=null,e.$validator.reset()})}})},itemsSeleccionados:function(t){var e=this;t&&t.forEach(function(t){t.as_afiliado_id&&e.asignacion.pacientes.push(t.id),null!==t.concurrencia&&(e.auditores=JSON.parse(d()(t.concurrencia.auditores)))})},diOpen:function(t){t||this.close()},ips:function(t){this.ruta=t?"cm_pacientes_hospitalarios?censo:ips_id="+t.id:"cm_pacientes_hospitalarios"},ruta:function(t){t&&(this.dataTablePacientes.route=t)}},computed:{infoComponent:function(){return this.$store.getters.getInfoComponent("auPacientes")}},methods:{resetOptions:function(t){return t.options=[],this.infoComponent&&this.infoComponent.permisos.agregar&&null!==t.as_afiliado_id&&t.options.push({event:"asignar",icon:"fab fa-slideshare",tooltip:"Asignar Auditores",color:"red",size:"20px"}),this.infoComponent&&this.infoComponent.permisos.agregar&&null!==t.as_afiliado_id&&"Asignado"===t.estado&&t.options.push({event:"linked",icon:"fas fa-link",tooltip:"Ir a la concurrencia",color:"teal",size:"20px"}),t},openDialogFormAsignacion:function(t){null!==t.concurrencia&&(this.auditores=t.concurrencia.auditores),t.as_afiliado_id&&this.asignacion.pacientes.push(t.id),this.tempIdPacienteHospitalario=t.id,this.diOpen=!this.diOpen},close:function(){this.auditorTemporal=null,this.$refs.dataCenso.deselectAll(),this.formData(),this.$validator.reset(),this.auditores=[],this.itemsSeleccionados=[],this.tempIdPacienteHospitalario=null},formData:function(){this.asignacion={pacientes:[],auditores:[]}},openDialogTwo:function(){this.asignacion.auditores.length?this.diOpenAntesDeAsignar=!this.diOpenAntesDeAsignar:this.$store.commit(m.b,{msg:"Debe asignar almenos un auditor "+(this.auditores!==[]?this.auditores.length>1?"diferentes los que se encuentran":"diferente al que esta":"")+".",color:"danger"})},asignar:function(){var t=this;this.axios.post("asignarConcurrencia",this.asignacion).then(function(e){t.$store.commit(m.b,{msg:"Se "+(t.asignacion.pacientes.length>1?"asignaron":"asignó")+" correctamente "+(t.asignacion.pacientes.length>1?"los pacientes":"el paciente")+" al auditor.",color:"success"}),t.$store.commit(v._0,{item:e.data.data,estado:"reload",key:null}),t.diOpenAntesDeAsignar=!1,t.diOpen=!1}).catch(function(e){t.$store.commit("SNACK_ERROR_LIST",{expression:" al asignar audiroes. ",error:e}),t.$store.commit(m.b,{msg:e.response.data.message,color:"danger"})})},eliminar:function(t){var e=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:void 0===t.item.pivot||null===t.item.pivot?(e.auditores.splice(t.index,1),e.$store.commit(m.b,{msg:"El auditor se ha eliminado correctamente.",color:"success"})):e.axios.delete("eliminar_concurrencia_asignada/"+t.item.id+"/"+t.item.pivot.concurrencia_id+"/"+e.tempIdPacienteHospitalario).then(function(a){e.$store.commit(m.b,{msg:"El auditor se ha eliminado correctamente.",color:"success"}),e.auditores.splice(t.index,1),e.$store.commit(v._0,{item:a.data.data,estado:"reload",key:null})}).catch(function(t){e.$store.commit("SNACK_ERROR_LIST",{expression:" "+t.response.data.msg,error:t})});case 1:case"end":return a.stop()}},a,e)}))()}},created:function(){var t=this;this.formData(),this.parametros?(this.ruta="cm_censos/"+(null!==this.parametros.entidad?this.parametros.entidad.id:null)+"/pacientes",this.censo=JSON.parse(d()(null!==this.parametros.entidad?this.parametros.entidad:null)),this.dialogOpenOfMenu=!1):(this.ruta="cm_pacientes_hospitalarios",this.dialogOpenOfMenu=!0,this.axios.get("institucionesConPacientes").then(function(e){t.instituciones=JSON.parse(d()(e.data.data))}).catch(function(){t.$store.commit(m.b,{msg:"Error al cargar las instituciones.",color:"danger"})}))},mounted:function(){var t=this;u.a.extend("noAuditor",{validate:function(e){return new n.a(function(a){if(null!==e&&void 0!==e&&""!==e){var i=0===e.auditor_concurrente?{valido:!1,mensaje:"El auditor seleccionado no esta marcado como auditor concurrente."}:t.auditores.find(function(t){return t.id===e.id})?{valido:!1,mensaje:"El auditor seleccionado ya se encuentra asigando auditores."}:{valido:!0,mensaje:!1};return a({valid:i.valido,data:{message:i.mensaje}})}})},getMessage:function(t,e,a){return a.message}})}}},2466:function(t,e,a){var i=a(2467);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(456)("6acb91d6",i,!0,{})},2467:function(t,e,a){e=t.exports=a(455)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"AuditoriaPacientes.vue",sourceRoot:""}])},2468:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"400"},model:{value:t.diOpenAntesDeAsignar,callback:function(e){t.diOpenAntesDeAsignar=e},expression:"diOpenAntesDeAsignar"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"title",domProps:{textContent:t._s("¿Está seguro de asignar los auditores?")}})]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"grey",dark:""},domProps:{textContent:t._s("No")},on:{click:function(e){t.diOpenAntesDeAsignar=!1}}}),t._v(" "),a("v-btn",{attrs:{color:"primary"},domProps:{textContent:t._s("Sí")},on:{click:t.asignar}})],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{persistent:"",width:"600px"},model:{value:t.diOpen,callback:function(e){t.diOpen=e},expression:"diOpen"}},[a("v-card",[a("toolbar-list",{attrs:{title:"Asignar Auditores"}}),t._v(" "),a("v-form",{attrs:{"data-vv-scope":"formAsignarAuditor"}},[a("v-container",{attrs:{fluid:"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"noAuditor",expression:"'noAuditor'"}],attrs:{"no-data":"Busqueda por identificación, nombre o código de auditor",hint:"usuario.identification","item-text":"usuario.name","data-title":"identificacion_completa","data-subtitle":"usuario.name",label:"Auditor",entidad:"ac_auditores",preicon:"person_outline","route-params":"estado=1&auditor_concurrente=1",name:"auditor",rules:"noAuditor","error-messages":t.errors.collect("auditor"),"no-btn-create":"","min-characters-search":3,clearable:""},model:{value:t.auditorTemporal,callback:function(e){t.auditorTemporal=e},expression:"auditorTemporal"}})],1),t._v(" "),a("v-flex",{staticClass:"pa-1",attrs:{xs12:""}},[[a("v-slide-y-transition",{attrs:{group:""}},[t.auditores!==[]?a("v-data-table",{key:"table",staticClass:"elevation-1",attrs:{items:t.auditores,headers:t.headersAuditor,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",{key:"tag-"+(e.item.id?e.index:e.item.id=e.index)},[a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.usuario?e.item.identificacion_completa:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.usuario?e.item.usuario.name:null))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.usuario?e.item.tipo:null))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{staticClass:"mx-0",attrs:{slot:"activator",icon:"",fab:"",small:""},on:{click:function(a){return t.eliminar(e)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[t._v("delete")])],1),t._v(" "),a("span",{domProps:{textContent:t._s("Eliminar")}})],1)],1)])]}}],null,!1,1256685215)},[t._v(" "),a("template",{staticClass:"error",slot:"no-data"},[a("div",{staticClass:"pa-1 pl-2 text--white text-xs-center"},[t._v("\n                            Lo sentimos, no existen registros. "),a("v-icon",[t._v("sentiment_very_dissatisfied")])],1)])],2):t._e()],1)]],2)],1)],1)],1),t._v(" "),a("v-card-actions",{staticClass:"grey lighten-3"},[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",color:"grey darken-1"},domProps:{textContent:t._s("Cerrar")},on:{click:function(e){t.diOpen=!1}}}),t._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},domProps:{textContent:t._s("Asignar")},on:{click:function(e){return e.preventDefault(),t.openDialogTwo(e)}}})],1)],1)],1),t._v(" "),a("v-card",[t.dialogOpenOfMenu?a("toolbar-list",{attrs:{info:t.infoComponent,title:"Pacientes Hospitalarios",subtitle:"Gestión"}}):[a("v-card",{key:"cardtop",staticClass:"elevation-1"},[a("v-container",{staticClass:"pa-2",attrs:{fluid:"","grid-list-sm":""}},[a("v-layout",{attrs:{"align-center":"","justify-space-between":"",row:"",wrap:"","fill-height":""}},[a("v-flex",{attrs:{md4:"",sm6:"",xs12:"","order-xs2":"","order-sm2":"","order-md1":""}},[a("v-toolbar",{staticClass:"toolbar-pa0 elevation-0",staticStyle:{background:"transparent !important"}},[a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",icon:"",large:""},slot:"activator"},[a("v-icon",{attrs:{color:"teal",large:""},domProps:{textContent:t._s("fas fa-clipboard-list")}})],1),t._v(" "),a("span",[t._v("Listado de Pacientes")])],1),t._v(" "),a("v-divider",{attrs:{vertical:""}}),t._v(" "),a("span",{staticClass:"pt-1 pl-2 text-xs-left"},[null!==t.censo?a("span",{staticClass:"body-2 text-capitalize"},[t._v(t._s(t.censo.ips?t.censo.ips.nombre:null))]):t._e(),t._v(" "),a("p",{staticClass:"mb-0 caption"},[t._v(t._s("Sin Asignar"))])])],1)],1),t._v(" "),a("v-flex",{staticClass:"text-xs-center",attrs:{md4:"",sm12:"",xs12:"","order-xs1":"","order-sm1":"","order-md2":""}},[a("span",{domProps:{textContent:t._s("Pacientes Hospitalarios")}}),a("br"),t._v(" "),a("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s("Listado de pacientes censados")}}),a("br"),t._v(" "),null!==t.censo?a("span",{staticClass:"font-weight-bold"},[t._v("Fecha: "+t._s(t.censo.fecha))]):t._e()]),t._v(" "),a("v-flex",{staticClass:"text-xs-right",attrs:{md4:"",sm6:"",xs12:"","order-xs3":"","order-sm3":"","order-md3":""}},[a("v-toolbar",{staticClass:"toolbar-pa0 elevation-0",staticStyle:{background:"transparent !important"}},[null!==t.censo?a("v-toolbar-title",{staticClass:"body-1 text-xs-right pr-2",staticStyle:{width:"100% !important"}},[a("span",[t._v("Total pacientes: "+t._s(t.censo.cantidad_pacientes))]),a("br"),t._v(" "),a("span",{staticClass:"font-weight-bold"},[t._v(t._s("Usuario: "+(t.censo.usuario?t.censo.usuario.name:"")))])]):t._e(),t._v(" "),a("v-spacer")],1)],1)],1)],1)],1)],t._v(" "),t.dataTablePacientes.route?a("data-table",{ref:"dataCenso",attrs:{"select-all":"accent"},on:{selecteds:function(e){return t.itemsSeleccionados=e},resetOption:function(e){return t.resetOptions(e)},asignar:function(e){return t.openDialogFormAsignacion(e)},linked:function(e){return t.$store.commit("NAV_ADD_ITEM",{ruta:"detalleConcurrencia",titulo:"Detalle concurrencia",parametros:{entidad:{id:e.cm_concurrencia_id,afiliado:e.afiliado},tabOrigin:t.$store.state.nav.currentItem.split("tab-")[1]}})}},scopedSlots:t._u([{key:"actions",fn:function(e){return[t.itemsSeleccionados.length?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",flat:"",dark:"",icon:"",large:"",color:"accent darken-2"},on:{click:function(e){t.diOpen=!t.diOpen}},slot:"activator"},[a("v-icon",[t._v("fab fa-slideshare")])],1),t._v(" "),a("span",{domProps:{textContent:t._s("Asignación masiva")}})],1):t._e(),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"pt-1",attrs:{xs12:"",sm6:"",md6:""}},[null===t.censo?a("v-autocomplete",{attrs:{items:t.instituciones,loading:t.loadingIps,label:"Filtrar por IPS","prepend-icon":"far fa-hospital","item-value":"id","item-text":"nombre_razon_social",flat:"","return-object":"",clearable:""},scopedSlots:t._u([{key:"item",fn:function(e){return[[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(e.item.nombre_razon_social)}}),t._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:t._s(e.item.cod_habilitacion)}})],1)]]}}],null,!0),model:{value:t.ips,callback:function(e){t.ips=e},expression:"ips"}},[t._v(" "),a("template",{slot:"no-data"},[t.loadingIps?a("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[t._v("\n                        Se estan cargando los registros. "),a("v-icon",[t._v("sentiment_satisfied_alt")])],1):a("v-alert",{staticClass:"pt-1 pb-1 mb-0 mt-0",attrs:{value:!0,color:"error",icon:"warning"}},[t._v("\n                        Lo sentimos, no tenemos registros para mostrar. "),a("v-icon",[t._v("sentiment_very_dissatisfied")])],1)],1)],2):t._e()],1)],1)]}}],null,!1,3806026563),model:{value:t.dataTablePacientes,callback:function(e){t.dataTablePacientes=e},expression:"dataTablePacientes"}}):t._e()],2)],1)},n=[],o={render:i,staticRenderFns:n};e.a=o},699:function(t,e,a){"use strict";function i(t){a(2466)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1297),o=a(2468),s=a(1),r=i,l=s(n.a,o.a,!1,r,"data-v-15999541",null);e.default=l.exports}});
//# sourceMappingURL=223.69a9e0b0a85fded6d7b5.js.map