webpackJsonp([387],{1267:function(e,a,o){"use strict";var r=o(13),t=o.n(r),i=o(14),n=o.n(i),s=o(249),c=o.n(s),d=o(12);a.a={name:"ConEgresos",components:{PostuladorV2:function(){return new Promise(function(e){e()}).then(o.bind(null,61))}},props:{concurrenciaId:{type:Number,default:0},concurrenciaObj:{type:Object,defatul:{}}},data:function(){return{egreso:{cm_concurrencia_id:this.concurrenciaId,diagnostico_egreso:null},tiposEstadoSalida:["Vivo","Muerto","Remitido"],au_referencias:[],menuDate:!1,menuTime:!1,fechaRecepcion:null,horaRecepcion:null,loadingSubmit:!1}},mounted:function(){this.getRegisto()},watch:{"egreso.estado_salida":function(e){"Remitido"===e&&this.getEntidadRemitido()}},computed:{computedDateFormatted:function(){return this.formDate(this.fechaRecepcion)}},methods:{getRegisto:function(){var e=this,a=this.$loading.show({container:this.$refs.formEgreso.$el});this.axios.get("cuentasmedicas/concurrencia/egreso/"+this.concurrenciaId).then(function(o){""!==o.data&&(e.egreso=o.data,e.splitFechaRecepcionYHora(),"Remitido"===e.egreso.estado_salida&&(e.egreso.au_referencia_id=e.concurrenciaObj.au_referencia_id,e.getReferencias())),a.hide()}).catch(function(o){a.hide(),e.$store.commit(d.b,{msg:"Hay un error al traer el egreso. "+o.response,color:"danger"})})},getReferencias:function(){var e=this,a=this.$loading.show({container:this.$refs.formEgreso.$el});this.axios.get("referencias/by-afiliado/"+this.concurrenciaObj.as_afiliado_id).then(function(o){""!==o.data&&(console.log(o),e.au_referencias=o.data.data),a.hide()}).catch(function(o){a.hide(),e.$store.commit(d.b,{msg:"Hay un error al traer las referencias. "+o.response,color:"danger"})})},getEntidadRemitido:function(){var e=this,a=this.$loading.show({container:this.$refs.formEgreso.$el});this.axios.get("referencias/traslado/"+this.concurrenciaObj.afiliado.id).then(function(o){""!==o.data&&(e.egreso.entidadRemitido=o.data),a.hide()}).catch(function(o){a.hide(),e.$store.commit(d.b,{msg:"Hay un error al traer las entidades. "+o.response,color:"danger"})})},splitFechaRecepcionYHora:function(){var e=this.egreso.fecha_egreso.split(" ");this.fechaRecepcion=e[0],this.horaRecepcion=e[1]},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},formDate:function(e){if(!e)return null;var a=e.split("-"),o=c()(a,3);return o[0]+"/"+o[1]+"/"+o[2]},submit:function(){var e=this;return n()(t.a.mark(function a(){var o;return t.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.validador("formEgresos");case 2:if(!a.sent){a.next=11;break}e.loadingSubmit=!0,e.egreso.fecha_egreso=e.fechaRecepcion+" "+e.horaRecepcion,"Remitido"===e.egreso.estado_salida&&(e.egreso.rs_entidad_destino_id=e.egreso.entidadRemitido.id),console.log("conegreso",e.egreso),o=e.egreso.id?e.axios.put("cuentasmedicas/concurrencia/egreso/"+e.egreso.id,e.egreso):e.axios.post("cuentasmedicas/concurrencia/egreso",e.egreso),o.then(function(a){e.egreso.id?(e.loadingSubmit=!1,e.$store.commit(d.b,{msg:"Item actualizado satisfactoriamente",color:"success"})):(e.loadingSubmit=!1,e.$store.commit(d.b,{msg:"Item creado satisfactoriamente",color:"success"}))}).catch(function(a){e.loadingSubmit=!1,e.$store.commit(d.a,{expression:" al guardar el registro. ",error:a})}),a.next=12;break;case 11:e.$store.commit(d.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 12:case"end":return a.stop()}},a,e)}))()}}}},2365:function(e,a,o){"use strict";function r(e){o(2366)}Object.defineProperty(a,"__esModule",{value:!0});var t=o(1267),i=o(2368),n=o(1),s=r,c=n(t.a,i.a,!1,s,"data-v-70ad1944",null);a.default=c.exports},2366:function(e,a,o){var r=o(2367);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(456)("328241e6",r,!0,{})},2367:function(e,a,o){a=e.exports=o(455)(!0),a.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"ConEgresos.vue",sourceRoot:""}])},2368:function(e,a,o){"use strict";var r=function(){var e=this,a=e.$createElement,o=e._self._c||a;return o("v-container",{ref:"formEgreso",staticStyle:{"max-width":"inherit"},attrs:{"grid-list-md":""}},[o("v-form",{attrs:{"data-vv-scope":"formEgresos"}},[o("v-container",{attrs:{fluid:"","grid-list-md":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{xs12:"",sm4:""}},[o("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.tiposEstadoSalida,label:"Estado de salida",name:"estado de salida","prepend-icon":"format_textdirection_r_to_l","error-messages":e.errors.collect("estado de salida"),required:"",disabled:"Cerrada"===e.concurrenciaObj.estado},model:{value:e.egreso.estado_salida,callback:function(a){e.$set(e.egreso,"estado_salida",a)},expression:"egreso.estado_salida"}})],1),e._v(" "),o("v-flex",{attrs:{xs12:"",sm4:""}},[o("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:e.menuDate,callback:function(a){e.menuDate=a},expression:"menuDate"}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],attrs:{slot:"activator",label:"Fecha","prepend-icon":"event",readonly:"",name:"fecha de salida","error-messages":e.errors.collect("fecha de salida"),disabled:"Cerrada"===e.concurrenciaObj.estado},slot:"activator",model:{value:e.computedDateFormatted,callback:function(a){e.computedDateFormatted=a},expression:"computedDateFormatted"}}),e._v(" "),o("v-date-picker",{attrs:{readonly:"Cerrada"===e.concurrenciaObj.estado,locale:"es","no-title":""},on:{input:function(a){e.menuDate=!1},change:function(){var a=e.$validator.errors.items.findIndex(function(e){return"fecha"===e.field});e.$validator.errors.items.splice(-1!==a?a:0,-1!==a?1:0)}},model:{value:e.fechaRecepcion,callback:function(a){e.fechaRecepcion=a},expression:"fechaRecepcion"}})],1)],1),e._v(" "),o("v-flex",{attrs:{xs12:"",sm4:""}},[o("v-menu",{ref:"menuTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.horaRecepcion,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(a){e.horaRecepcion=a},"update:return-value":function(a){e.horaRecepcion=a}},model:{value:e.menuTime,callback:function(a){e.menuTime=a},expression:"menuTime"}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{slot:"activator",label:"Hora de Egreso","prepend-icon":"access_time",readonly:"",required:"",name:"hora egreso","error-messages":e.errors.collect("hora ingreso"),disabled:"Cerrada"===e.concurrenciaObj.estado},slot:"activator",model:{value:e.horaRecepcion,callback:function(a){e.horaRecepcion=a},expression:"horaRecepcion"}}),e._v(" "),e.menuTime?o("v-time-picker",{attrs:{readonly:"Cerrada"===e.concurrenciaObj.estado,"full-width":""},on:{change:function(a){return e.$refs.menuTime.save(e.horaRecepcion)}},model:{value:e.horaRecepcion,callback:function(a){e.horaRecepcion=a},expression:"horaRecepcion"}}):e._e()],1)],1),e._v(" "),"Remitido"===e.egreso.estado_salida?o("v-flex",{attrs:{xs12:""}},[o("v-text-field",{attrs:{label:"Entidad destino (Centro Regulador",hint:"Teléfono: "+e.egreso.entidadRemitido.telefono_sede,"persistent-hint":"",readOnly:"","prepend-icon":"contacts",disabled:"Cerrada"===e.concurrenciaObj.estado},model:{value:e.egreso.entidadRemitido.nombre,callback:function(a){e.$set(e.egreso.entidadRemitido,"nombre",a)},expression:"egreso.entidadRemitido.nombre"}})],1):e._e(),e._v(" "),o("v-flex",{attrs:{xs12:""}},[o("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"no-data":"Busqueda por código, descripcion y genero",hint:"codigo","item-text":"descripcion","data-title":"codigo","data-subtitle":"descripcion",label:"Diagnóstico Principal",entidad:"rs_cie10s",preicon:"reorder",name:"diagnóstico",rules:"required","error-messages":e.errors.collect("diagnóstico"),"no-btn-create":"","min-characters-search":3,clearable:"",disabled:"Cerrada"===e.concurrenciaObj.estado},on:{changeid:function(a){return e.egreso.dx_egreso=a}},model:{value:e.egreso.diagnostico_egreso,callback:function(a){e.$set(e.egreso,"diagnostico_egreso",a)},expression:"egreso.diagnostico_egreso"}})],1),e._v(" "),o("v-flex",{attrs:{xs12:""}},[o("postulador-v2",{attrs:{"no-data":"Busqueda por código, descripcion y genero",hint:"codigo","item-text":"descripcion","data-title":"codigo","data-subtitle":"descripcion",label:"Diagnóstico Relacionado (opcional)",entidad:"rs_cie10s",preicon:"reorder",name:"diagnóstico","no-btn-create":"","min-characters-search":3,clearable:"",disabled:"Cerrada"===e.concurrenciaObj.estado},on:{changeid:function(a){return e.egreso.dx_relacionado=a}},model:{value:e.egreso.diagnostico_relacionado,callback:function(a){e.$set(e.egreso,"diagnostico_relacionado",a)},expression:"egreso.diagnostico_relacionado"}})],1)],1)],1),e._v(" "),o("v-divider")],1),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"primary",loading:e.loadingSubmit},on:{click:function(a){return a.preventDefault(),e.submit(a)}}},[e._v("Guardar")])],1)],1)},t=[],i={render:r,staticRenderFns:t};a.a=i}});
//# sourceMappingURL=387.55ae8e0fbc2e3f729703.js.map