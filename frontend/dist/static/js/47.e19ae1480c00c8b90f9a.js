webpackJsonp([47,288],{1316:function(e,t,a){"use strict";var o=a(13),i=a.n(o),r=a(14),n=a.n(r),s=a(248),l=a(12),c=a(748);t.a={name:"AuditoriaMS",components:{ToolbarList:function(){return new Promise(function(e){e()}).then(a.bind(null,247))},DataTable:function(){return new Promise(function(e){e()}).then(a.bind(null,60))},InputFile:c.default},data:function(){return{dataTableMsauditoria:{nameItemState:"itemMsAuditoria",route:"maestroafiliados",optionsPerPage:[{text:15,value:15},{text:50,value:50},{text:100,value:100}],makeHeaders:[{text:"Fecha Archivo",align:"center",sortable:!1,value:"fecha_archivo",classData:"text-xs-center",component:{component:{template:"\n                  <div>\n                    <span class=\"text-xs-center\">\n                      {{ moment(value.fecha_archivo, 'DDMMYYYY').format('DD/MM/YYYY') }}\n                    </span>\n                  </div>\n                ",props:["value"]}}},{text:"Nombre Archivo",align:"left",sortable:!1,value:"nombre_archivo"},{text:"Número de Filas",align:"center",sortable:!1,value:"numero_filas",classData:"text-xs-center"},{text:"Usuario",align:"left",sortable:!1,value:"usuario.name",classData:"text-xs-left"},{text:"Tipo",align:"left",sortable:!1,value:"tipo",classData:"text-xs-left"}]},dialog:!1,dialogLoader:!1,dialogProceso:!1,msAuditoria:{},nombre_archivo:null,message:null,logProceso:null}},watch:{dialogProceso:function(e){!1===e&&(this.logProceso=null)},dialog:function(e){!1===e&&this.$validator.reset()},dialogLoader:function(e){!1===e&&(this.message=null)},"msAuditoria.archivo":function(e){e&&(this.nombre_archivo=this.$refs.archivoAdjunto.namesArchivos)}},mounted:function(){this.formReset()},computed:{infoComponent:function(){return this.$store.getters.getInfoComponent("auditoriaMS")},tipos:function(){return["Subsidiado","Contributivo"]}},methods:{resetOptions:function(e){return e.options=[],this.infoComponent&&this.infoComponent.permisos.agregar&&e.options.push({event:"editar",icon:"edit",tooltip:"Editar"}),e},formReset:function(){this.msAuditoria={tipo:null,archivo:null},this.nombre_archivo=null},close:function(){this.$validator.reset(),this.formReset(),this.dialog=!1},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},validar:function(){var e=this;return n()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.archivoAdjunto.validate();case 2:return a=t.sent,t.next=5,e.validador("formArchivoMS");case 5:if(t.t1=t.sent,!t.t1){t.next=8;break}t.t1=a;case 8:if(t.t0=t.t1,!t.t0){t.next=11;break}t.t0=null!==e.msAuditoria.archivo;case 11:if(!t.t0){t.next=17;break}e.dialogLoader=!0,e.message="Validando archivo...",e.axios.get("maestroafiliados/"+e.nombre_archivo).then(function(t){console.log("respuesta",t),!1===t.data.exists?(e.dialog=!1,e.message=t.data.msg,e.save()):(e.close(),e.dialogLoader=!1,e.message=t.data.msg,e.$store.commit(l.b,{msg:t.data.msg,color:"danger"}))}).catch(function(t){e.close(),e.dialogLoader=!1,e.$store.commit(l.b,{msg:t.response.msg,color:"danger"})}),t.next=18;break;case 17:e.$store.commit(l.b,{msg:"Se debe cargar un archivo para iniciar el proceso.",color:"danger"});case 18:case"end":return t.stop()}},t,e)}))()},save:function(){var e=this,t=new FormData;t.append("tipo",this.msAuditoria.tipo),this.msAuditoria.archivo&&t.append("archivo",void 0===this.msAuditoria.archivo?"":this.msAuditoria.archivo),this.axios.post("maestroafiliados/store",t).then(function(t){e.$store.commit(l.b,{msg:"El proceso se realizo correctamente.",color:"success"}),e.$store.commit(s.V,{item:t.data.proceso,estado:"reload",key:null}),e.logProceso=t.data.log,e.dialogProceso=!0,e.dialogLoader=!1,e.close()}).catch(function(t){e.dialogLoader=!1,e.$store.commit(l.b,{msg:t.response.msg,color:"danger"})})}}}},2529:function(e,t,a){var o=a(2530);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(456)("e9a1cc8e",o,!0,{})},2530:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"AuditoriaMS.vue",sourceRoot:""}])},2531:function(e,t,a){"use strict";var o=function(){var e=this,t=this,a=t.$createElement,o=t._self._c||a;return o("div",[o("v-dialog",{attrs:{persistent:"",width:"350px"},model:{value:t.dialogProceso,callback:function(e){t.dialogProceso=e},expression:"dialogProceso"}},[o("v-card",[o("v-card-title",{staticClass:"grey lighten-3"},[o("span",{staticClass:"title",domProps:{textContent:t._s("Respuesta Proceso")}})]),t._v(" "),o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[o("v-layout",{attrs:{row:"",wrap:""}},t._l(t.logProceso,function(e,t,a){return o("v-flex",{key:"Log-"+a,attrs:{xs12:""}},[o("v-text-field",{key:"TwoLog-"+a,attrs:{value:e,label:t,placeholder:"Placeholder",readonly:"",box:""}})],1)}),1)],1),t._v(" "),o("v-card-actions",{staticClass:"grey lighten-3"},[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{color:"black lighten-3",flat:"",medium:""},domProps:{textContent:t._s("Cerrar")},on:{click:function(e){e.preventDefault(),t.dialogProceso=!1}}})],1)],1)],1),t._v(" "),o("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.dialogLoader,callback:function(e){t.dialogLoader=e},expression:"dialogLoader"}},[o("v-card",{attrs:{color:"primary",dark:""}},[o("v-card-text",[o("span",{domProps:{textContent:t._s(t.message)}}),t._v(" "),o("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),t._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-card",[o("toolbar-list",{attrs:{title:"Cargar de Archivo MS"}}),t._v(" "),o("v-form",{attrs:{"data-vv-scope":"formArchivoMS"}},[o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[o("v-flex",{attrs:{xs12:""}},[o("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"tipo",attrs:{items:t.tipos,"prepend-icon":"label_important",label:"Tipo",name:"tipo","error-messages":t.errors.collect("tipo")},model:{value:t.msAuditoria.tipo,callback:function(e){t.$set(t.msAuditoria,"tipo",e)},expression:"msAuditoria.tipo"}})],1),t._v(" "),o("v-flex",{attrs:{xs12:""}},[o("input-file",{ref:"archivoAdjunto",staticClass:"mb-3",attrs:{label:"Adjuntar Archivo","file-name":t.msAuditoria.archivo?t.msAuditoria.archivo.nombre:null,accept:"application/x-zip-compressed",hint:"Extenciones aceptadas: zip","prepend-icon":"attach_file"},model:{value:t.msAuditoria.archivo,callback:function(e){t.$set(t.msAuditoria,"archivo",e)},expression:"msAuditoria.archivo"}})],1)],1)],1),t._v(" "),o("v-card-actions",{staticClass:"grey lighten-3"},[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{flat:""},on:{click:t.close}},[t._v("Cancelar")]),t._v(" "),o("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:function(e){return e.preventDefault(),t.validar()}}},[t._v("Cargar")])],1)],1)],1),t._v(" "),o("v-card",[o("toolbar-list",{attrs:{info:t.infoComponent,btnplustruncate:"",btnplus:"",btnplustitle:"Cargar Archivo",title:"Auditoría MS",subtitle:"Gestión"},on:{click:function(e){t.dialog=!0}}}),t._v(" "),o("data-table",{on:{resetOption:function(e){return t.resetOptions(e)},editar:function(a){return t.$store.commit("NAV_ADD_ITEM",{ruta:e.infoComponent.ruta_registro,titulo:e.infoComponent.titulo_registro,parametros:{entidad:a,tabOrigin:e.$store.state.nav.currentItem.split("tab-")[1]}})}},model:{value:t.dataTableMsauditoria,callback:function(e){t.dataTableMsauditoria=e},expression:"dataTableMsauditoria"}})],1)],1)},i=[],r={render:o,staticRenderFns:i};t.a=r},705:function(e,t,a){"use strict";function o(e){a(2529)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1316),r=a(2531),n=a(1),s=o,l=n(i.a,r.a,!1,s,"data-v-1172db54",null);t.default=l.exports},748:function(e,t,a){"use strict";function o(e){a(769)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(752),r=a(771),n=a(1),s=o,l=n(i.a,r.a,!1,s,"data-v-410eab20",null);t.default=l.exports},752:function(e,t,a){"use strict";t.a={name:"InputFile",props:{label:{type:String,default:null},prependIcon:{type:String,default:"attach_file"},accept:{type:String,default:null},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},hint:{type:String,default:""},fileName:{type:String,default:null},value:null},data:function(){return{namesArchivos:null,forceEmpty:!1}},watch:{fileName:function(e){void 0!==e&&(this.namesArchivos=e)},value:function(e){var t=this;"string"==typeof e&&(this.namesArchivos=e),e||(this.namesArchivos=null,this.forceEmpty=!0,setTimeout(function(){t.forceEmpty=!1},100))},namesArchivos:function(e){null===e&&this.$emit("input",null)}},computed:{rules:function(){var e=[],t=this.required?"required":"";t.length&&e.push(t);var a=this.accept?"mimes:"+this.accept:"";return a.length&&e.push(a),e.join("|")}},methods:{validate:function(e){return!!this.namesArchivos||this.$validator.validateAll(e)},reset:function(){this.$validator.reset()},onFilePicked:function(e){var t=e.target.files;if(t.length){for(var a=[],o=0;o<t.length;o++)a.push(t[o].name);this.namesArchivos=a.join(" || "),this.$emit("input",this.multiple?t:t[0])}}}}},769:function(e,t,a){var o=a(770);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(456)("5a1f3f0e",o,!0,{})},770:function(e,t,a){t=e.exports=a(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"InputFile.vue",sourceRoot:""}])},771:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.disabled||e.forceEmpty?e._e():a("input",{directives:[{name:"validate",rawName:"v-validate",value:e.rules,expression:"rules"}],ref:"inputAnexo",attrs:{accept:e.accept,type:"file",multiple:e.multiple,hidden:"",name:e.label+"archivo","data-vv-delay":"500","data-vv-as":e.label},on:{change:function(t){return e.onFilePicked(t)}}}),e._v(" "),a("v-textarea",{directives:[{name:"validate",rawName:"v-validate",value:{required:e.required},expression:"{required: required}"}],attrs:{rows:"1","auto-grow":"",label:e.label,"prepend-icon":e.prependIcon,readonly:"","error-messages":e.errors.collect(e.label+"archivox").length?e.errors.collect(e.label+"archivox")+".. "+e.hint:e.errors.collect(e.label+"archivo").length?e.errors.collect(e.label+"archivo")+".. "+e.hint:"",hint:e.hint,"persistent-hint":"",clearable:e.clearable,disabled:e.disabled,name:e.label+"archivox","data-vv-as":e.label,required:""},nativeOn:{click:function(t){return e.$refs.inputAnexo.click()}},model:{value:e.namesArchivos,callback:function(t){e.namesArchivos=t},expression:"namesArchivos"}})],1)},i=[],r={render:o,staticRenderFns:i};t.a=r}});
//# sourceMappingURL=47.e19ae1480c00c8b90f9a.js.map