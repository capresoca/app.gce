webpackJsonp([217],{1272:function(t,e,a){"use strict";var i=a(7),o=a.n(i),n=a(8),s=a.n(n),r=a(6);e.a={name:"DetalleFacturasRadicadas",props:["parametros"],components:{DialogAuditores:function(){return a.e(378).then(a.bind(null,2387))},EditarFactura:function(){return a.e(377).then(a.bind(null,2391))}},data:function(){return{loading:!0,radicado:null,facturasSeleccionadas:[],dataTable:{nameItemState:"tableFacturasRadicadas",route:null,advanceFilters:!0,makeHeaders:[{selectable:!0},{text:"Número",align:"left",sortable:!1,component:{template:'\n                    <v-list-tile class="content-v-list-tile-p0">\n                      <v-list-tile-content>\n                        <v-list-tile-title class="body-2" v-if="value.entidad">Factura: {{value.no_factura}}</v-list-tile-title>\n                        <v-list-tile-sub-title class="caption grey--text" v-if="value.entidad">Radicado: {{value.consecutivo_radicado}}</v-list-tile-sub-title>\n                      </v-list-tile-content>\n                    </v-list-tile>\n                  ',props:["value"]}},{text:"Tipo",align:"left",sortable:!1,value:"tipo_facturacion"},{text:"Plan Beneficio",align:"left",sortable:!1,value:"plan_beneficio"},{text:"Entidad",align:"left",width:"300px",sortable:!1,component:{template:'\n                    <v-tooltip right>\n                      <v-list-tile class="content-v-list-tile-p0 cursor-pointer" slot="activator">\n                        <v-list-tile-content class="truncate-content">\n                          <v-list-tile-title class="body-2" v-if="value.entidad">{{value.entidad.tipo.tipo}}: {{value.entidad.nombre}}</v-list-tile-title>\n                          <v-list-tile-sub-title class="caption grey--text" v-if="value.entidad">Código habilitación: {{value.entidad.cod_habilitacion}}</v-list-tile-sub-title>\n                        </v-list-tile-content>\n                      </v-list-tile>\n                    <span>{{value.entidad.nombre}}</span>\n                    </v-tooltip>\n                  ',props:["value"]}},{text:"Estado",align:"center",sortable:!0,value:"estado",classData:"text-xs-center"},{text:"Valor Neto",align:"right",sortable:!1,value:"valor_neto",classData:"text-xs-right",component:{template:"<span>{{currency(value.valor_neto)}}</span>",props:["value"]}},{text:"Opciones",align:"center",sortable:!1,actions:!0,singlesActions:!0,classData:"text-xs-center"}]},filters:{entidades:[],radicados:[],montos:[],auditores:[]},filtroRuta:{entidad:null,radicado:null,montos:[],auditores:[]},rutaBase:"",filterLocalEntidades:function(t,e){var a=function(t){return null!=t?t:""},i=a(t.cod_habilitacion+" "+t.nombre),o=a(e);return i.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1},filterAuditores:function(t,e){var a=function(t){return null!=t?t:""},i=a(t.codigo+" "+t.tipo+" "+t.identificacion_completa+" "+t.name),o=a(e);return i.toString().toLowerCase().indexOf(o.toString().toLowerCase())>-1}}},computed:s()({},Object(r.c)({currentUser:function(t){return t.user.profile}}),{esAuditor:function(){return this.currentUser&&this.currentUser.roles&&this.currentUser.roles.find(function(t){return 43===t.id})},infoComponent:function(){return this.$store.getters.getInfoComponent("facturasradicadas")}}),watch:{},created:function(){this.reloadComplementos(),this.radicado=this.parametros&&null!==this.parametros.entidad?this.parametros.entidad:null,this.dataTable.route=this.parametros&&null!==this.parametros.entidad?"cm_radicado/"+this.parametros.entidad.id+"/facturas":"facturas_all",this.rutaBase=JSON.parse(o()(this.dataTable.route))},methods:{editarCapitado:function(t){this.$refs.edicionFactura.assign(t)},reloadTable:function(){this.$refs.tableFacturasRadicadas.reloadPage()},aplicaFiltros:function(){var t=this.rutaBase;this.filtroRuta.entidad&&(t=t+(t.indexOf("?")>-1?"&":"?")+"radicado:rs_entidad_id="+this.filtroRuta.entidad.id),this.filtroRuta.radicado&&(t=t+(t.indexOf("?")>-1?"&":"?")+"id_radicado="+this.filtroRuta.radicado.id),this.filtroRuta.montos.length&&(t=t+(t.indexOf("?")>-1?"&":"?")+"montos="+this.filtroRuta.montos),this.filtroRuta.auditores.length&&(t=t+(t.indexOf("?")>-1?"&":"?")+"auditores="+this.filtroRuta.auditores),this.dataTable.route=t},reloadComplementos:function(){var t=this;this.axios.get("complementos/facturas").then(function(e){t.filters=e.data.data}).catch(function(e){t.$store.commit("SNACK_ERROR_LIST",{expression:" al traer los complementos para crear los filtros. ",error:e})})},asignarAuditores:function(){this.$refs.dialogAuditores.open(this.facturasSeleccionadas)},openDialogAuditores:function(t){this.$refs.dialogAuditores.open([t])},resetOptions:function(t){return t.selectable=!0,t.options=[],this.infoComponent&&this.infoComponent.permisos.agregar&&!this.esAuditor&&t.options.push({event:"asignar",icon:"fas fa-users-cog",tooltip:"Auditores"}),this.infoComponent&&this.infoComponent.permisos.agregar&&("Asignada"===t.estado||"Auditando"===t.estado)&&this.esAuditor&&t.options.push({event:"auditar",icon:"fas fa-tasks",tooltip:"Auditar",color:"orange"}),this.infoComponent&&this.infoComponent.permisos.ver&&t.options.push({event:"verdetalle",icon:"fas fa-file-invoice",tooltip:"Ver detalle",color:"success"}),this.infoComponent&&this.infoComponent.permisos.agregar&&"Capita"===t.tipo_facturacion&&t.options.push({event:t.feha_repcapita?"":"editarcapitado",icon:"far fa-edit",tooltip:t.feha_repcapita?"La factura ya fue editada, fecha: "+t.feha_repcapita:"Editar Factura",color:t.feha_repcapita?"grey":"indigo"}),t}}}},2385:function(t,e,a){var i=a(2386);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(456)("3d90cb34",i,!0,{})},2386:function(t,e,a){e=t.exports=a(455)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"DetalleFacturasRadicadas.vue",sourceRoot:""}])},2395:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[t.esAuditor?a("v-toolbar",[a("v-list-tile",{staticClass:"content-v-list-tile-p0"},[a("v-list-tile-avatar",{attrs:{color:"primary"}},[a("v-icon",{staticClass:"white--text"},[t._v(t._s(t.infoComponent?t.infoComponent.icono:""))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"font-weight-bold"},[t._v("Listado de facturas asignadas")]),t._v(" "),a("v-list-tile-sub-title",{staticClass:"caption"},[a("strong",[t._v("Audita:")]),t._v(" "+t._s(t.currentUser.name))])],1)],1)],1):a("v-toolbar",{attrs:{dense:""}},[a("v-list-tile",{staticClass:"content-v-list-tile-p0"},[a("v-list-tile-avatar",{attrs:{color:"primary"}},[a("v-icon",{staticClass:"white--text"},[t._v(t._s(t.infoComponent?t.infoComponent.icono:""))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"font-weight-bold title"},[t._v("Listado de facturas radicadas")])],1)],1)],1),t._v(" "),t.dataTable.route?a("data-table-v2",{ref:"tableFacturasRadicadas",attrs:{"select-all":""},on:{resetOption:function(e){return t.resetOptions(e)},auditar:function(e){return t.$store.commit("NAV_ADD_ITEM",{ruta:"detalleFacturaRadicada",titulo:"Auditoría Factura: "+e.no_factura,parametros:{entidad:e,esdetalle:!1,tabOrigin:t.$store.state.nav.currentItem.split("tab-")[1]}})},verdetalle:function(e){return t.$store.commit("NAV_ADD_ITEM",{ruta:"detalleFacturaRadicada",titulo:"Detalle Factura: "+e.no_factura,parametros:{entidad:e,esdetalle:!0,tabOrigin:t.$store.state.nav.currentItem.split("tab-")[1]}})},asignar:function(e){return t.openDialogAuditores(e)},"apply-filters":t.aplicaFiltros,selecteds:function(e){return t.facturasSeleccionadas=e},editarcapitado:function(e){return t.editarCapitado(e)}},model:{value:t.dataTable,callback:function(e){t.dataTable=e},expression:"dataTable"}},[a("template",{slot:"filters"},[a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-select",{attrs:{label:"Montos","item-text":"descrip","item-value":"id",multiple:"",items:t.filters.montos,chips:"","deletable-chips":"","small-chips":"",clearable:""},model:{value:t.filtroRuta.montos,callback:function(e){t.$set(t.filtroRuta,"montos",e)},expression:"filtroRuta.montos"}})],1),t._v(" "),t.esAuditor?t._e():a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{attrs:{clearable:"",label:"Auditores",multiple:"",items:t.filters.auditores,filter:t.filterAuditores,"item-value":"id"},scopedSlots:t._u([{key:"item",fn:function(e){return[a("v-list-tile-content",{staticClass:"truncate-content",staticStyle:{width:"100% !important"}},[a("v-list-tile-title",[t._v(t._s(e.item.tipo)+" - "+t._s(e.item.name))]),t._v(" "),a("v-list-tile-sub-title",[t._v(t._s(e.item.identificacion_completa))])],1)]}},{key:"selection",fn:function(e){return[a("v-chip",{attrs:{small:"",close:"",color:"accent","text-color":"white"},on:{input:function(a){return t.filtroRuta.auditores.splice(e.index,1)}}},[t._v("\n                "+t._s(e.item.name)+"\n              ")])]}}],null,!1,2656807739),model:{value:t.filtroRuta.auditores,callback:function(e){t.$set(t.filtroRuta,"auditores",e)},expression:"filtroRuta.auditores"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{attrs:{clearable:"",label:"Entidad","item-text":"nombre","return-object":"",items:t.filters.entidades,filter:t.filterLocalEntidades,hint:t.filtroRuta.entidad?"Código habilitación: "+t.filtroRuta.entidad.cod_habilitacion+" -- Municipio: "+t.filtroRuta.entidad.municipio.nombre+", "+t.filtroRuta.entidad.municipio.nombre_departamento:"","persistent-hint":""},on:{input:function(e){return e&&(t.filtroRuta.radicado=null)}},scopedSlots:t._u([{key:"item",fn:function(e){return[a("v-list-tile-content",{staticClass:"truncate-content",staticStyle:{width:"100% !important"}},[a("v-list-tile-title",[t._v(t._s(e.item.nombre))]),t._v(" "),a("v-list-tile-sub-title",[t._v("Código habilitación: "+t._s(e.item.cod_habilitacion)+" -- Municipio: "+t._s(e.item.municipio.nombre)+", "+t._s(e.item.municipio.nombre_departamento))])],1)]}}],null,!1,252625881),model:{value:t.filtroRuta.entidad,callback:function(e){t.$set(t.filtroRuta,"entidad",e)},expression:"filtroRuta.entidad"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md6:""}},[a("v-autocomplete",{attrs:{clearable:"",label:"Radicado","item-text":"numero_radicado","return-object":"",items:t.filtroRuta.entidad?t.filters.radicados.filter(function(e){return e.rs_entidad_id===t.filtroRuta.entidad.id}):t.filters.radicados,hint:t.filtroRuta.radicado?"Fecha: "+t.filtroRuta.radicado.fecha_radicado:"","persistent-hint":""},on:{input:function(e){return e&&t.filters.entidades.find(function(t){return t.id===e.rs_entidad_id})&&(t.filtroRuta.entidad=t.filters.entidades.find(function(t){return t.id===e.rs_entidad_id}))}},scopedSlots:t._u([{key:"item",fn:function(e){return[a("v-list-tile-content",{staticClass:"truncate-content",staticStyle:{width:"100% !important"}},[a("v-list-tile-title",[t._v(t._s(e.item.numero_radicado))]),t._v(" "),a("v-list-tile-sub-title",[t._v("Fecha: "+t._s(e.item.fecha_radicado))])],1)]}}],null,!1,426707664),model:{value:t.filtroRuta.radicado,callback:function(e){t.$set(t.filtroRuta,"radicado",e)},expression:"filtroRuta.radicado"}})],1)],1)],2):t._e(),t._v(" "),a("dialog-auditores",{ref:"dialogAuditores",on:{asigna:t.reloadTable}}),t._v(" "),a("v-bottom-nav",{attrs:{fixed:"",dark:"",value:t.facturasSeleccionadas.length,color:"primary"}},[a("v-list-tile",{staticClass:"white--text"},[a("v-list-tile-content",[a("v-list-tile-title",[t._v("Facturas seleccionadas: "),a("strong",[t._v(t._s(t.facturasSeleccionadas.length))])]),t._v(" "),a("v-list-tile-title",[t._v("Valor seleccionado: "),a("strong",[t._v(t._s(t.currency(t.sum_by(t.facturasSeleccionadas,"valor_neto"))))])])],1)],1),t._v(" "),this.esAuditor?void 0:[a("v-btn",{attrs:{dark:"",flat:"",value:"recent"},on:{click:function(e){return e.stopPropagation(),t.asignarAuditores(e)}}},[a("span",[t._v("asignar auditores")]),t._v(" "),a("v-icon",[t._v("fas fa-user-plus")])],1)]],2),t._v(" "),a("editar-factura",{ref:"edicionFactura"})],1)},o=[],n={render:i,staticRenderFns:o};e.a=n},690:function(t,e,a){"use strict";function i(t){a(2385)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(1272),n=a(2395),s=a(1),r=i,l=s(o.a,n.a,!1,r,"data-v-7de5d218",null);e.default=l.exports}});
//# sourceMappingURL=217.40ffdcdf0cfb70cbbc77.js.map