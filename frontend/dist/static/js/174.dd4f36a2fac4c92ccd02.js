webpackJsonp([174],{1544:function(o,e,t){var a=t(1545);"string"==typeof a&&(a=[[o.i,a,""]]),a.locals&&(o.exports=a.locals);t(456)("effa953c",a,!0,{})},1545:function(o,e,t){e=o.exports=t(455)(!0),e.push([o.i,"","",{version:3,sources:[],names:[],mappings:"",file:"UnidadesApoyo.vue",sourceRoot:""}])},1546:function(o,e,t){"use strict";var a=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",[t("v-dialog",{attrs:{width:"500px"},model:{value:o.dialog,callback:function(e){o.dialog=e},expression:"dialog"}},[t("v-form",{attrs:{"data-vv-scope":"formPago"}},[t("v-card",[t("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[t("span",{staticClass:"title"},[o._v(o._s(o.modalTitulo))])]),o._v(" "),t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:5|not_in:"+o.codigosUsados,expression:"'required|max:5|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo",required:"","error-messages":o.errors.collect("codigo")},model:{value:o.unidadApoyo.codigo,callback:function(e){o.$set(o.unidadApoyo,"codigo",e)},expression:"unidadApoyo.codigo"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:150|not_in:"+o.nombresUsados,expression:"'required|max:150|not_in:' + nombresUsados"}],key:"nombre",attrs:{label:"Nombre",name:"nombre",required:"","error-messages":o.errors.collect("nombre")},model:{value:o.unidadApoyo.nombre,callback:function(e){o.$set(o.unidadApoyo,"nombre",e)},expression:"unidadApoyo.nombre"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Centro de Costo",items:o.complementos.cencostos,"item-value":"id","item-text":"nombre",name:"centro de costo",required:"","error-messages":o.errors.collect("centro de costo"),"return-object":"",clearable:""},on:{change:function(e){return o.unidadApoyo.nf_cencosto_id=e?e.id:null}},scopedSlots:o._u([{key:"item",fn:function(e){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:o._s(e.item.nombre)}})],1)]]}}]),model:{value:o.unidadApoyo.cencosto,callback:function(e){o.$set(o.unidadApoyo,"cencosto",e)},expression:"unidadApoyo.cencosto"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}})],1)],1),o._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-spacer"),o._v(" "),t("v-btn",{on:{click:o.close}},[o._v("Cancelar")]),o._v(" "),t("v-btn",{attrs:{color:"primary"},on:{click:o.save}},[o._v("Guardar")])],1)],1)],1)],1),o._v(" "),t("v-card",[t("v-toolbar",{staticClass:"elevation-0 toolbar--dense"},[t("v-toolbar-title",{staticClass:"title"},[o._v("Unidades de Apoyo ")]),o._v(" "),t("v-spacer"),o._v(" "),o.infoComponent&&o.infoComponent.permisos.agregar?t("v-btn",{attrs:{fab:"",small:"",color:"accent"},nativeOn:{click:function(e){o.dialog=!0}}},[t("v-icon",[o._v("add")])],1):o._e()],1),o._v(" "),t("v-card-title",[t("v-text-field",{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",flat:""},model:{value:o.search,callback:function(e){o.search=e},expression:"search"}})],1),o._v(" "),t("v-data-table",{staticClass:"elevation-1",attrs:{headers:o.headers,items:o.unidadesApoyo,loading:o.tableLoading,pagination:o.pagination,"hide-actions":"",search:o.search,"rows-per-page-text":"Registros por página","rows-per-page-items":[10,25,50,{text:"Todos",value:-1}]},on:{"update:pagination":function(e){o.pagination=e}},scopedSlots:o._u([{key:"items",fn:function(e){return[t("td",[o._v(o._s(e.item.codigo))]),o._v(" "),t("td",[o._v(o._s(e.item.nombre))]),o._v(" "),t("td",[o._v(o._s(e.item.cencosto?e.item.cencosto.nombre:""))]),o._v(" "),t("td",{staticClass:"text-xs-center"},[o.infoComponent&&o.infoComponent.permisos.agregar?t("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(t){return o.edit(e.item)}}},[t("v-icon",{attrs:{color:"accent"}},[o._v("edit")])],1):o._e()],1)]}},{key:"pageText",fn:function(e){return[o._v("\n        "+o._s(e.pageStart)+" - "+o._s(e.pageStop)+" de "+o._s(e.itemsLength)+"\n      ")]}}])},[o._v(" "),t("template",{slot:"no-data"},[o.tableLoading?t("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[o._v("\n          Lo sentimos, no tenemos registros para mostrar. "),t("v-icon",[o._v("sentiment_very_dissatisfied")])],1):t("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[o._v("\n          Estamos cargando los registros. "),t("v-icon",[o._v("sentiment_satisfied_alt")])],1)],1),o._v(" "),o._v(" "),t("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[o._v('\n        No se encontraron resultados de "'+o._s(o.search)+'"\n      ')])],2),o._v(" "),t("v-card-actions",{staticClass:"text-xs-center pt-2 d-block"},[t("v-pagination",{attrs:{length:o.pages},model:{value:o.pagination.page,callback:function(e){o.$set(o.pagination,"page",e)},expression:"pagination.page"}})],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};e.a=s},498:function(o,e,t){"use strict";function a(o){t(1544)}Object.defineProperty(e,"__esModule",{value:!0});var n=t(981),s=t(1546),i=t(1),r=a,d=i(n.a,s.a,!1,r,"data-v-2f243ce1",null);e.default=d.exports},981:function(o,e,t){"use strict";var a=t(13),n=t.n(a),s=t(14),i=t.n(s),r=t(7),d=t.n(r),c=t(12),l=t(59);e.a={name:"UnidadesApoyo",data:function(){return{unidadesApoyo:[],unidadApoyo:{},search:"",dialog:!1,tableLoading:!1,pagination:{},codigosUsados:"",nombresUsados:"",headers:[{text:"Código",align:"left",sortable:!1,value:"codigo"},{text:"Nombre",align:"left",sortable:!1,value:"nombre"},{text:"Centro Costo",align:"left",sortable:!1,value:"nf_cencosto_id"},{text:"Opciones",align:"center",sortable:!1,value:"id"}]}},beforeMount:function(){this.formReset()},mounted:function(){var o={custom:{codigo:{not_in:"Este código ya fue registrado."},nombre:{not_in:"Este nombre ya fue registrado."}}};this.$validator.localize("es",o)},watch:{dialog:function(o){!1===o&&this.close()}},beforeCreate:function(){var o=this;this.tableLoading=!0,this.axios.get("pg_uniapoyos").then(function(e){o.unidadesApoyo=e.data.data,o.pagination.totalItems=o.unidadesApoyo.length,o.tableLoading=!1,o.codigosUsados=o.getCodigosUsados(),o.nombresUsados=o.getNombresUsados()}).catch(function(o){return console.log("Hay un error. "+o),!1})},computed:{complementos:function(){return l.b.getters.complementosFormComDiario},infoComponent:function(){return this.$store.getters.getInfoComponent("conPagos")},modalTitulo:function(){return this.unidadApoyo.id?"Edición de la Unidad de Apoyo: "+this.unidadApoyo.nombre:"Nueva Unidad de Apoyo"},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)}},methods:{formReset:function(){this.unidadApoyo={id:"",codigo:null,nombre:null,nf_cencosto_id:null,cencosto:null},this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},edit:function(o){console.log(o),this.dialog=!0,this.unidadApoyo=JSON.parse(d()(o)),console.log(this.unidadApoyo),this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},close:function(){this.dialog=!1,this.formReset(),this.$validator.reset()},getCodigosUsados:function(){var o=this;return this.unidadesApoyo.map(function(e){if(null==o.unidadApoyo.codigo||o.unidadApoyo.codigo!==e.codigo)return e.codigo})},getNombresUsados:function(){var o=this;return this.unidadesApoyo.map(function(e){if(null==o.unidadApoyo.nombre||o.unidadApoyo.nombre!==e.nombre)return e.nombre})},validador:function(o){return this.$validator.validateAll(o).then(function(o){return o})},save:function(){var o=this;return i()(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.validador("formPago");case 2:if(!e.sent){e.next=7;break}t=o.unidadApoyo.id?o.axios.put("pg_uniapoyos/"+o.unidadApoyo.id,o.unidadApoyo):o.axios.post("pg_uniapoyos",o.unidadApoyo),t.then(function(e){o.unidadApoyo.id?(o.$store.commit(c.b,{msg:"La unidad de apoyo se actualizó correctamente",color:"success"}),o.unidadesApoyo.splice(o.unidadesApoyo.findIndex(function(o){return o.id===e.data.data.id}),1,e.data.data)):(o.$store.commit(c.b,{msg:"La unidad de apoyo se creó correctamente",color:"success"}),o.unidadesApoyo.splice(0,0,e.data.data)),o.dialog=!1,o.close()}).catch(function(e){o.$store.commit(c.b,{msg:"Hay un error al guardar el registro. "+e.response,color:"danger"})}),e.next=8;break;case 7:o.$store.commit(c.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 8:case"end":return e.stop()}},e,o)}))()}}}}});
//# sourceMappingURL=174.dd4f36a2fac4c92ccd02.js.map