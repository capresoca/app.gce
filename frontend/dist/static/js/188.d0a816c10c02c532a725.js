webpackJsonp([188],{1507:function(e,a,t){var r=t(1508);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t(456)("aa2052f2",r,!0,{})},1508:function(e,a,t){a=e.exports=t(455)(!0),a.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroRtf.vue",sourceRoot:""}])},1509:function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-dialog",{attrs:{"max-width":"290"},model:{value:e.destroyFila,callback:function(a){e.destroyFila=a},expression:"destroyFila"}},[t("v-card",[t("v-card-text",{attrs:{color:"blue-grey darken-1"}},[e._v("¿Está seguro/a de eliminar el rango del registro RTF "),t("span",{domProps:{textContent:e._s(e.conRtf.nombre+"?")}})]),e._v(" "),t("v-card-actions",[t("v-spacer"),e._v(" "),t("v-btn",{attrs:{flat:"flat"},nativeOn:{click:function(a){return e.restoreDetalle()}}},[e._v("No")]),e._v(" "),t("v-btn",{attrs:{color:"primary",flat:"flat"},on:{click:function(a){return e.eliminarDe(e.detalle)}}},[e._v("Si")])],1)],1)],1),e._v(" "),t("v-divider"),e._v(" "),t("v-card",[t("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[t("v-toolbar-title",[e._v(" "+e._s(e.tapTitulo)+" ")])],1),e._v(" "),t("v-container",{staticStyle:{"max-width":"inherit"},attrs:{"grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[t("v-form",{attrs:{"data-vv-scope":"formPrincipal"}},[t("v-container",{attrs:{fluid:"","grid-list-md":"","grid-list-xl":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:5|not_in:"+e.codigosUsados,expression:"'required|max:5|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo",required:"","error-messages":e.errors.collect("codigo"),disabled:!!e.conRtf.id},model:{value:e.conRtf.codigo,callback:function(a){e.$set(e.conRtf,"codigo",a)},expression:"conRtf.codigo"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombre",attrs:{label:"Nombre",name:"nombre",required:"","error-messages":e.errors.collect("nombre")},model:{value:e.conRtf.nombre,callback:function(a){e.$set(e.conRtf,"nombre",a)},expression:"conRtf.nombre"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.manejos,label:"Manejo",name:"manejo","error-messages":e.errors.collect("manejo"),required:""},model:{value:e.conRtf.manejo,callback:function(a){e.$set(e.conRtf,"manejo",a)},expression:"conRtf.manejo"}})],1),e._v(" "),t("v-slide-x-transition",["Base"===e.conRtf.manejo||"Variable"===e.conRtf.manejo?t("v-flex",{attrs:{xs12:"",sm12:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"base mínima",attrs:{prefix:"$",type:"number",value:0,name:"base mínima",required:"","error-messages":e.errors.collect("base mínima"),label:"Base Mínima"},model:{value:e.conRtf.base_minima,callback:function(a){e.$set(e.conRtf,"base_minima",e._n(a))},expression:"conRtf.base_minima"}})],1):e._e()],1),e._v(" "),t("v-slide-x-transition",["Base"===e.conRtf.manejo?t("v-flex",{attrs:{xs12:"",sm12:"",md4:"",transition:"slide-y-transition"}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"porcentaje",attrs:{prefix:"%",type:"number",name:"porcentaje",required:"","error-messages":e.errors.collect("porcentaje"),label:"Porcentaje"},model:{value:e.conRtf.porcentaje,callback:function(a){e.$set(e.conRtf,"porcentaje",e._n(a))},expression:"conRtf.porcentaje"}})],1):e._e()],1)],1)],1)],1)],1),e._v(" "),"Rangos"===e.conRtf.manejo?t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[[t("v-card",[t("v-card-title",{staticClass:"grey lighten-3"},[t("h3",[e._v("Agregar Rangos")])]),e._v(" "),t("v-divider"),e._v(" "),t("v-form",{attrs:{"data-vv-scope":"formRango"}},[t("v-container",{attrs:{fluid:"","grid-list-lg":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"valor inicial",ref:"vIncial",attrs:{step:.1,type:"number",name:"valor inicial",required:"","error-messages":""!=e.valor_value?e.valor_value:e.errors.collect("valor inicial"),label:"Valor Inicial",min:1,max:e.detalle.valor_final},on:{input:e.validaMensaje},model:{value:e.detalle.valor_inicial,callback:function(a){e.$set(e.detalle,"valor_inicial",e._n(a))},expression:"detalle.valor_inicial"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"valor final",attrs:{type:"number",name:"valor final",required:"","error-messages":""!=e.valor_value2?e.valor_value2:e.errors.collect("valor final"),label:"Valor Final",min:e.detalle.valor_inicial},on:{input:e.validaMensaje},model:{value:e.detalle.valor_final,callback:function(a){e.$set(e.detalle,"valor_final",e._n(a))},expression:"detalle.valor_final"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"porcentaje",attrs:{suffix:"%",type:"number",name:"porcentaje",required:"","error-messages":e.errors.collect("porcentaje"),label:"Porcentaje",min:"0"},model:{value:e.detalle.porcentaje,callback:function(a){e.$set(e.detalle,"porcentaje",e._n(a))},expression:"detalle.porcentaje"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"deducido",attrs:{suffix:"-",type:"number",name:"deducido",required:"","error-messages":e.errors.collect("deducido"),label:"Deducido",min:"0"},model:{value:e.detalle.deducido,callback:function(a){e.$set(e.detalle,"deducido",e._n(a))},expression:"detalle.deducido"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"incremento",attrs:{suffix:"+",type:"number",name:"incremento",required:"","error-messages":e.errors.collect("incremento"),label:"Incremento",min:"0"},model:{value:e.detalle.incremento,callback:function(a){e.$set(e.detalle,"incremento",e._n(a))},expression:"detalle.incremento"}})],1),e._v(" "),t("v-flex",{staticClass:"text-sm-center pt-2",attrs:{xs12:"",sm4:"",md2:"",lg2:""}},[t("div",{attrs:{sm10:""}},[t("v-btn",{attrs:{color:"primary"},on:{click:function(a){return a.preventDefault(),e.agregarDetalle(e.detalle)}}},[t("v-icon",[e._v("add")]),e._v(" Agregar")],1)],1)])],1)],1)],1),e._v(" "),""!==e.valorEnd?t("v-alert",{staticClass:"py-1",attrs:{color:"error",type:"error"},on:{input:e.validaMensaje},model:{value:e.valorEnd,callback:function(a){e.valorEnd=a},expression:"valorEnd"}},[e._v("\n                  "+e._s(e.validarDetalles(e.detalle).mensaje_error_rango)+"\n                ")]):e._e(),e._v(" "),t("v-divider"),e._v(" "),e.conRtf.detalles.length>0?t("v-data-table",{attrs:{headers:e.headers,items:e.conRtf.detalles,loading:e.tableLoading,pagination:e.pagination,"hide-actions":"","rows-per-page-text":"Registros por página","rows-per-page-items":[5,10,25,{text:"Todos",value:-1}]},on:{"update:pagination":function(a){e.pagination=a}},scopedSlots:e._u([{key:"items",fn:function(a){return[t("td",[e._v(e._s(a.item.valor_inicial))]),e._v(" "),t("td",[e._v(e._s(a.item.valor_final))]),e._v(" "),t("td",[e._v(e._s(a.item.porcentaje))]),e._v(" "),t("td",[e._v(e._s(a.item.deducido))]),e._v(" "),t("td",[e._v(e._s(a.item.incremento))]),e._v(" "),t("td",{staticClass:"text-xs-center"},[t("v-btn",{staticClass:"mx-0",attrs:{icon:"",fab:"",small:""},on:{click:function(t){return e.preguntarEliminarDetalle(a.item)}}},[t("v-icon",{attrs:{color:"accent"}},[e._v("delete")])],1)],1)]}},{key:"pageText",fn:function(a){return[e._v("\n                    "+e._s(a.pageStart)+" - "+e._s(a.pageStop)+" de "+e._s(a.itemsLength)+"\n                  ")]}}],null,!1,587277752)},[e._v(" "),t("template",{slot:"no-data"},[e.tableLoading?t("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n                      Lo sentimos, no tenemos registros para mostrar. "),t("v-icon",[e._v("sentiment_very_dissatisfied")])],1):t("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[e._v("\n                      Estamos cargando los registros. "),t("v-icon",[e._v("sentiment_satisfied_alt")])],1)],1)],2):e._e()],1)]],2):e._e(),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-switch",{attrs:{color:"success",label:e.conRtf.estado,"true-value":"Activo","false-value":"Inactivo"},model:{value:e.conRtf.estado,callback:function(a){e.$set(e.conRtf,"estado",a)},expression:"conRtf.estado"}})],1)],1)],1),e._v(" "),t("v-divider"),e._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{staticClass:"text-xs-left",attrs:{xs6:""}},[t("v-btn",{on:{click:function(a){return e.refresh(null)}}},[e._v("Limpiar")])],1),e._v(" "),t("v-flex",{staticClass:"text-xs-right",attrs:{xs6:""}},[t("v-btn",{on:{click:function(a){return e.close()}}},[e._v("Cancelar")]),e._v(" "),t("v-btn",{attrs:{color:"primary"},on:{click:function(a){return a.preventDefault(),e.save(a)}}},[e._v("Guardar")])],1)],1)],1)],1)],1)},i=[],o={render:r,staticRenderFns:i};a.a=o},489:function(e,a,t){"use strict";function r(e){t(1507)}Object.defineProperty(a,"__esModule",{value:!0});var i=t(968),o=t(1509),n=t(1),l=r,s=n(i.a,o.a,!1,l,"data-v-44fe90df",null);a.default=s.exports},968:function(e,a,t){"use strict";var r=t(13),i=t.n(r),o=t(14),n=t.n(o),l=t(7),s=t.n(l),c=t(40),d=t(248),v=t(12);a.a={name:"RegistroRtf",props:["parametros"],data:function(){return{conRtf:{},conRtfEdicion:{id:null,codigo:null,nombre:null,manejo:null,base_minima:null,porcentaje:null,estado:"Activo",detalles:[]},valor_value:"",valor_value2:"",valorEnd:"",manejos:["Base","Rangos","Variable"],detalle:{},tableLoading:!1,destroyFila:!1,codigosUsados:null,obtenerCodigos:[],pagination:{},headers:[{text:"Valor Inicial",align:"left",sortable:!1,value:"valor_inicial"},{text:"Valor Final",align:"left",sortable:!1,value:"valor_final"},{text:"Procentaje",align:"left",sortable:!1,value:"procentaje"},{text:"Deducido",align:"left",sortable:!1,value:"deducido"},{text:"Incremento",align:"left",sortable:!1,value:"incremento"},{text:"",align:"center",sortable:!1,value:"id"}],detallesValidos:[]}},computed:{tapTitulo:function(){return this.conRtf.id?"Edición del Concepto RTF: "+this.conRtf.nombre:"Nuevo Concepto de RTF"},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)}},beforeMount:function(){this.getCodigo(),this.refresh(),this.formReset(),this.validarDetalles()},mounted:function(){var e={custom:{codigo:{not_in:"Este código ya fue usado"}}};this.$validator.localize("es",e),null!==this.parametros.entidad&&this.getRegisto(this.parametros.entidad.id)},methods:{getRegisto:function(e){var a=this;this.axios.get("conrtfs/"+e).then(function(e){console.log(e),""!==e.data&&(a.conRtf=e.data.data)}).catch(function(e){a.$store.commit(v.b,{msg:"Hay un error al traer el concepto RTF. "+e.response,color:"danger"})})},getCodigo:function(){var e=this;this.axios.get("conrtfs").then(function(a){e.obtenerCodigos=a.data.data,e.codigosUsados=e.getCodigosUsados(e.obtenerCodigos)}).catch(function(a){e.$store.commit(v.b,{msg:"Hay un error al hacer la busqueda de registros. "+a.response,color:"danger"})})},getCodigosUsados:function(e){return this.obtenerCodigos.map(function(e){return e.codigo})},formReset:function(){this.detalle={valor_inicial:"",valor_final:"",porcentaje:"",deducido:"",incremento:""}},close:function(){this.formReset(),this.$validator.reset(),this.$store.dispatch(c.c,{contexto:this,itemId:this.parametros.tabOrigin})},refresh:function(){this.$validator.reset(),this.conRtf=JSON.parse(s()(this.conRtfEdicion))},agregarDetalle:function(e){var a=this;return n()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.validador("formRango");case 2:if(t.t5=t.sent,!t.t5){t.next=5;break}t.t5=a.validarDetalles(e).libre;case 5:if(t.t4=t.t5,!t.t4){t.next=8;break}t.t4=""!==a.detalle.valor_inicial;case 8:if(t.t3=t.t4,!t.t3){t.next=11;break}t.t3=""!==a.detalle.valor_final;case 11:if(t.t2=t.t3,!t.t2){t.next=14;break}t.t2=""!==a.detalle.porcentaje;case 14:if(t.t1=t.t2,!t.t1){t.next=17;break}t.t1=""!==a.detalle.deducido;case 17:if(t.t0=t.t1,!t.t0){t.next=20;break}t.t0=""!==a.detalle.incremento;case 20:if(!t.t0){t.next=27;break}a.conRtf.detalles.push(e),a.$validator.reset(),a.ordenarDetalles(),a.formReset(),t.next=28;break;case 27:""===a.detalle.valor_inicial&&""===a.detalle.valor_final&&""===a.detalle.porcentaje&&""===a.detalle.deducido&&""===a.detalle.incremento?a.$store.commit(v.b,{msg:"Los campos no pueden estar vacíos. ",color:"danger"}):a.$store.commit(v.b,{msg:"Hay un error al registrar el rango, rectifica la información. ",color:"danger"});case 28:case"end":return t.stop()}},t,a)}))()},validaMensaje:function(){var e=this.validarDetalles(this.detalle).mensaje_inicial,a=this.validarDetalles(this.detalle).mensaje_final;e&&""!==this.detalle.valor_inicial?this.valor_value=e:(this.$validator.reset(),this.valor_value=""),a&&""!==this.detalle.valor_final?this.valor_value2=a:(this.$validator.reset(),this.valor_value2=""),""!==this.detalle.valor_inicial&&""!==this.detalle.valor_final?this.valorEnd=this.validarDetalles(this.detalle).mensaje_error_rango:(this.$validator.reset(),this.valorEnd="")},validarDetalles:function(e){var a={libre:!0,mensaje_inicial:"",mensaje_final:"",mensaje_error_rango:""};return this.conRtf.detalles.length&&(e.valor_final<=e.valor_inicial?(a.mensaje_error_rango="El valor final debe ser mayor al valor inicial.",a.libre=!1):e.valor_inicial>=e.valor_final?(a.mensaje_error_rango="El valor inicial debe ser menor al valor inicial.",a.libre=!1):this.conRtf.detalles.forEach(function(t){var r=e.valor_inicial>=t.valor_inicial&&e.valor_inicial<=t.valor_final,i=e.valor_final>=t.valor_inicial&&e.valor_final<=t.valor_final,o=r||i;if(o)a.libre=!1,a.mensaje_inicial=r?"El valor inicial: "+e.valor_inicial+" esta entre el rango: "+t.valor_inicial+" - "+t.valor_final+".":"",a.mensaje_final=i?"El valor final: "+e.valor_final+" esta entre el rango: "+t.valor_inicial+" - "+t.valor_final+".":"",a.mensaje_error_rango=o?"Se presenta conflicto con otro(s) rango(s).":"";else{var n=t.valor_inicial>=e.valor_inicial&&t.valor_inicial<=e.valor_final,l=t.valor_final<=e.valor_final&&t.valor_final>=e.valor_inicial,s=n||l;s&&(a.libre=!1,a.mensaje_inicial=n?"El valor inicial: "+t.valor_inicial+" esta entre el rango: "+e.valor_inicial+" - "+e.valor_final+".":"",a.mensaje_final=l?"El valor final: "+t.valor_final+" esta entre el rango: "+e.valor_inicial+" - "+e.valor_final+".":"",a.mensaje_error_rango=s?"Se presenta conflicto con otro(s) rango(s).":"")}})),a},restoreDetalle:function(){this.destroyFila=!1,this.formReset(),this.$validator.reset()},preguntarEliminarDetalle:function(e){this.detalle=""===e?"":e,this.destroyFila=!0},eliminarDe:function(e){var a=this;e.id?this.axios.delete("conrtfs/detalles/"+e.id).then(function(t){a.restoreDetalle(),a.conRtf.detalles.splice(a.conRtf.detalles.indexOf(e),1),a.$store.commit(v.b,{msg:"Rango eliminado correctamente. ",color:"success"})}):(this.restoreDetalle(),this.conRtf.detalles.splice(this.conRtf.detalles.indexOf(e),1))},ordenarDetalles:function(){this.conRtf.detalles.sort(function(e,a){return e.valor_inicial-a.valor_final})},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},save:function(){var e=this;return n()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.validador("formPrincipal");case 2:if(!a.sent){a.next=6;break}e.submit(),a.next=19;break;case 6:return a.next=8,e.validador("formPrincipal");case 8:if(a.t1=a.sent,!a.t1){a.next=11;break}a.t1="Rangos"===e.conRtf.manejo;case 11:if(a.t0=a.t1,!a.t0){a.next=14;break}a.t0=e.conRtf.detalles.length>0;case 14:if(!a.t0){a.next=18;break}e.submit(),a.next=19;break;case 18:"Rangos"===e.conRtf.manejo&&e.conRtf.detalles.length<1?e.$store.commit(v.b,{msg:"Se debe agregar al menos un rango.",color:"danger"}):null==e.conRtf.manejo||null==e.conRtf.codigo||null==e.conRtf.nombre?e.$store.commit(v.b,{msg:"Los campos no pueden estar vacios.",color:"danger"}):e.$store.commit(v.b,{msg:"Se presenta un error al guardar el registro.",color:"danger"});case 19:case"end":return a.stop()}},a,e)}))()},submit:function(){var e=this;"Rangos"!==this.conRtf.manejo?this.conRtf.detalles=[]:"Base"!==this.conRtf.manejo?this.conRtf.porcentaje=null:"Rangos"===this.conRtf.manejo&&(this.conRtf.base_minima=null,this.conRtf.porcentaje=null);var a=this.conRtf.id?"editar":"crear";this.axios.post("conrtfs",this.conRtf).then(function(t){e.conRtf.id?e.$store.commit(v.b,{msg:"El concepto RTF se actualizó correctamente",color:"success"}):e.$store.commit(v.b,{msg:"El concepto RTF se creó correctamente",color:"success"}),e.$store.commit(d.w,{conRtf:t.data.data,estado:a,key:e.parametros.key}),e.$store.dispatch(c.c,{contexto:e,itemId:e.parametros.tabOrigin})}).catch(function(a){e.$store.commit(v.b,{msg:"Hay un error al guardar el registro. "+a.response,color:"danger"})})}}}}});
//# sourceMappingURL=188.d0a816c10c02c532a725.js.map