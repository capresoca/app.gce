webpackJsonp([252],{1178:function(e,t,a){"use strict";var i=a(13),r=a.n(i),o=a(14),n=a.n(o),s=a(40),d=a(248),l=a(12);t.a={name:"RegistroEntidadResolucion",props:["parametros"],components:{PostuladorV2:function(){return new Promise(function(e){e()}).then(a.bind(null,61))},ToolbarList:function(){return new Promise(function(e){e()}).then(a.bind(null,247))},Loading:function(){return new Promise(function(e){e()}).then(a.bind(null,58))}},data:function(){return{buscandoCodigo:!1,dialogCodigo:!1,ordenEdit:!1,entidad:{},resoluciones:[],loading:!1,codigosUsados:"",vigenciasRegistradas:""}},watch:{"entidad.tercero":function(e){var t=this;e&&(this.loading=!0,this.axios.get("empleado/tercero/"+e.id).then(function(e){t.loading=!1,e.data.exists?t.procesarTercero(e.data.tercero):t.$store.commit(l.b,{msg:"No podemos recuperar los datos del tercero. Intente de nuevo",color:"danger"})}).catch(function(e){t.loading=!1,t.$store.commit(l.a,{expression:" Al intentar consultar codigo. ",error:e})}))}},methods:{getCodigosUsados:function(){var e=this;return this.resoluciones.map(function(t){if(null==e.entidad.codigo||e.entidad.codigo!==t.codigo)return t.codigo})},getVigenciaRegistrada:function(){var e=this;return this.resoluciones.map(function(t){if(null==e.entidad.periodo||e.entidad.periodo!==t.periodo)return t.periodo})},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},submit:function(){var e=this;return n()(r.a.mark(function t(){var a,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validador("formRegistroEntidadResolucion");case 2:if(!t.sent){t.next=8;break}a=e.entidad.id?"editar":"crear",i=e.entidad.id?e.axios.put("pr_entidad_resolucion/"+e.entidad.id,e.entidad):e.axios.post("pr_entidad_resolucion",e.entidad),i.then(function(t){e.$store.commit(l.b,{msg:"Se "+(e.entidad.id?"actualizaron los datos":"realizó el registro")+" de la Entidad/Resolución | Código: "+t.data.data.codigo+".",color:"success"}),e.formReset(),e.$store.dispatch(s.c,{contexto:e,itemId:e.parametros.tabOrigin}),e.$store.commit(d.K,{item:t.data.data,estado:a,key:e.parametros.key})}).catch(function(t){e.$store.commit(l.b,{msg:"Hay un error al guardar el registro. "+t.response,color:"danger"})}),t.next=9;break;case 8:e.$store.commit(l.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 9:case"end":return t.stop()}},t,e)}))()},editarByCodigo:function(){this.dialogCodigo=!1,this.ordenEdit=!0},cerrarByCodigo:function(){this.formReset(),this.ordenEdit=!1,this.dialogCodigo=!1},formReset:function(){this.entidad={periodo:null,codigo:null,gn_tercero_id:null,nombre:null,resolucion:null,valor:null,identificacion_rep_legal:null,representante_legal:null,identificacion_jefe_pr:null,jefe_presupuesto:null,identificacion_jefe_financiero:null,jefe_financiero:null,tercero:null},this.buscandoCodigo=!1,this.codigosUsados=this.getCodigosUsados(),this.vigenciasRegistradas=this.getVigenciaRegistrada(),this.dialogCodigo=!1,this.ordenEdit=!1},seleccionTercero:function(e){var t=this;null!==e&&null!==e.id&&""!==e.id&&void 0!==e.id&&e.id!==this.entidad.tercero.id&&this.axios.get("empleado/tercero/"+e.id).then(function(e){e.data.exists?t.procesarTercero(e.data.tercero):t.$store.commit(l.b,{msg:"No podemos recuperar los datos del tercero. Intente de nuevo",color:"danger"})}).catch(function(e){t.$store.commit(l.a,{expression:" Al intentar consultar codigo. ",error:e})})},procesarTercero:function(e){this.entidad.tercero.municipio=e.municipio?e.municipio:null,this.entidad.nombre=e?e.nombre_completo:null},getRegistro:function(e){var t=this,a=this.$loading.show({container:this.$refs.cargar});this.axios.get("pr_entidad_resolucion/"+e).then(function(e){e.data.exists&&t.edit(e.data.data),a.hide()}).catch(function(e){t.$store.commit(l.a,{expression:" al traer el subgrupo. ",error:e})})},edit:function(e){this.ordenEdit=!0,this.entidad=e,this.codigosUsados=this.getCodigosUsados(),this.vigenciasRegistradas=this.getVigenciaRegistrada()}},computed:{toolTitle:function(){return(this.ordenEdit?"Edición":"Registro")+" de Entidad/Resolución"}},beforeCreate:function(){var e=this;this.axios.get("pr_entidad_resolucion").then(function(t){e.resoluciones=t.data.data,e.codigosUsados=e.getCodigosUsados(),e.vigenciasRegistradas=e.getVigenciaRegistrada()}).catch(function(t){e.$store.commit(l.b,{msg:"Hay un error al traer los registros. "+t.response,color:"danger"})})},beforeMount:function(){this.formReset()},mounted:function(){null!==this.parametros.entidad&&this.getRegistro(this.parametros.entidad.id);var e={custom:{codigo:{not_in:"Este código ya fue registrado."},vigencia:{not_in:"Ya se encuentra registrada la vigencia."}}};this.$validator.localize("es",e)}}},2101:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card",{staticClass:"transparent elevation-0"},[a("v-card-text",[a("v-form",{attrs:{"data-vv-scope":"formRegistroEntidadResolucion"}},[a("toolbar-list",{staticClass:"elevation-1 grey lighten-4",attrs:{title:e.toolTitle,subtitle:"Entidad"}}),e._v(" "),a("v-container",{staticClass:"pa-1",attrs:{fluid:"","grid-list-xl":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"pa-2",attrs:{xs12:"",sm12:"",md4:""}},[a("v-card",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|length:4|not_in:"+e.vigenciasRegistradas,expression:"'required|length:4|not_in:' + vigenciasRegistradas"}],key:"vigencia",attrs:{label:"Vigencia",maxlength:"4",name:"vigencia","error-messages":e.errors.collect("vigencia")},model:{value:e.entidad.periodo,callback:function(t){e.$set(e.entidad,"periodo",t)},expression:"entidad.periodo"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm8:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:16|not_in:"+e.codigosUsados,expression:"'required|max:16|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo","error-messages":e.errors.collect("codigo"),disabled:e.ordenEdit},model:{value:e.entidad.codigo,callback:function(t){e.$set(e.entidad,"codigo",t)},expression:"entidad.codigo"}})],1)],1)],1)],1)],1),e._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:"",sm12:"",md8:""}},[a("v-card",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"no-data":"Busqueda por código o nombre.",hint:"identificacion_completa","item-text":"nombre_completo","data-title":"identificacion_completa","data-subtitle":"nombre_completo",label:"Tercero",entidad:"terceros",preicon:"person",name:"nit","no-btn-create":"",rules:"required","error-messages":e.errors.collect("nit"),clearable:"","min-characters-search":2},on:{changeid:function(t){return e.entidad.gn_tercero_id=t}},model:{value:e.entidad.tercero,callback:function(t){e.$set(e.entidad,"tercero",t)},expression:"entidad.tercero"}})],1)],1)],1)],1)],1),e._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("loading",{model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),e._v(" "),a("v-slide-y-transition",[e.entidad.tercero?a("v-card",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md8:"",lg8:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombre",attrs:{label:"Nombre",name:"Nombre","error-messages":e.errors.collect("Nombre"),required:""},model:{value:e.entidad.nombre,callback:function(t){e.$set(e.entidad,"nombre",t)},expression:"entidad.nombre"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md4:"",lg4:""}},[a("v-text-field",{attrs:{label:"Ciudad",value:e.entidad.tercero&&e.entidad.tercero.municipio?e.entidad.tercero.municipio.nombre+" - "+e.entidad.tercero.municipio.nombre_departamento:null,readonly:""}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"resolucion",attrs:{label:"Resolucion",name:"Resolucion","error-messages":e.errors.collect("Resolucion"),required:""},model:{value:e.entidad.resolucion,callback:function(t){e.$set(e.entidad,"resolucion",t)},expression:"entidad.resolucion"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"Valor",attrs:{label:"Valor",name:"Valor",prefix:"$","error-messages":e.errors.collect("Valor"),required:""},model:{value:e.entidad.valor,callback:function(t){e.$set(e.entidad,"valor",t)},expression:"entidad.valor"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md6:"",lg6:""}},[a("v-text-field",{attrs:{label:"Direccion",value:e.entidad.tercero?e.entidad.tercero.direccion:null,readonly:""}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md2:"",lg2:""}},[a("v-text-field",{attrs:{label:"Telefono",value:e.entidad.tercero?e.entidad.tercero.telefono_fijo:null,readonly:""}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md4:"",lg4:""}},[a("v-text-field",{attrs:{label:"E-Mail",value:e.entidad.tercero?e.entidad.tercero.correo_electronico:null,readonly:""}})],1)],1)],1)],1):e._e()],1)],1),e._v(" "),a("v-flex",{staticClass:"pa-2",attrs:{xs12:""}},[a("v-card",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md5:"",lg5:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"docRepresLegal",attrs:{label:"N° documento representante legal",name:"N° documento representante legal","error-messages":e.errors.collect("N° documento representante legal"),required:""},model:{value:e.entidad.identificacion_rep_legal,callback:function(t){e.$set(e.entidad,"identificacion_rep_legal",t)},expression:"entidad.identificacion_rep_legal"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md7:"",lg7:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombreRepLegal",attrs:{label:"Nombre del representante legal",name:"Nombre del representante legal","error-messages":e.errors.collect("Nombre del representante legal"),required:""},model:{value:e.entidad.representante_legal,callback:function(t){e.$set(e.entidad,"representante_legal",t)},expression:"entidad.representante_legal"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md5:"",lg5:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"docJefePresupuesto",attrs:{label:"N° documento jefe de presupuesto",name:"N° documento jefe de presupuesto","error-messages":e.errors.collect("N° documento jefe de presupuesto"),required:""},model:{value:e.entidad.identificacion_jefe_pr,callback:function(t){e.$set(e.entidad,"identificacion_jefe_pr",t)},expression:"entidad.identificacion_jefe_pr"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md7:"",lg7:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombreJefePresupuesto",attrs:{label:"Nombre del jefe de presupuesto",name:"Nombre del jefe de presupuesto","error-messages":e.errors.collect("Nombre del jefe de presupuesto"),required:""},model:{value:e.entidad.jefe_presupuesto,callback:function(t){e.$set(e.entidad,"jefe_presupuesto",t)},expression:"entidad.jefe_presupuesto"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md5:"",lg5:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"docJefeFinaciero",attrs:{label:"N° documento jefe financiero",name:"N° documento jefe financiero","error-messages":e.errors.collect("N° documento jefe financiero"),required:""},model:{value:e.entidad.identificacion_jefe_financiero,callback:function(t){e.$set(e.entidad,"identificacion_jefe_financiero",t)},expression:"entidad.identificacion_jefe_financiero"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",sm12:"",md7:"",lg7:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"nombreJefeFinanciero",attrs:{label:"Nombre del jefe financiero",name:"Nombre del jefe financiero","error-messages":e.errors.collect("Nombre del jefe financiero"),required:""},model:{value:e.entidad.jefe_financiero,callback:function(t){e.$set(e.entidad,"jefe_financiero",t)},expression:"entidad.jefe_financiero"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:""}})],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"text-xs-right pr-3",attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[a("v-speed-dial",{attrs:{left:"",bottom:""}},[a("v-tooltip",{attrs:{slot:"activator",left:""},slot:"activator"},[a("v-btn",{attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:e.submit},slot:"activator"},[a("v-icon",[e._v("save")])],1),e._v(" "),a("span",[e._v("Guardar")])],1)],1)],1)],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.dialogCodigo,callback:function(t){e.dialogCodigo=t},expression:"dialogCodigo"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Codigo de la entidad/resolucion")]),e._v(" "),a("v-card-text",[e._v("El codigo de la entidad/resolucion ya esta siendo utilizado, desea cargar los datos para su actualizacion o utilizar otro codigo")]),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.editarByCodigo}},[e._v("Cargar datos")]),e._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.cerrarByCodigo}},[e._v("Cerrar")])],1)],1)],1)],1)},r=[],o={render:i,staticRenderFns:r};t.a=o},633:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(1178),r=a(2101),o=a(1),n=o(i.a,r.a,!1,null,null,null);t.default=n.exports}});
//# sourceMappingURL=252.743f1915dae29ba5117a.js.map