webpackJsonp([195],{1112:function(t,o,a){"use strict";var n=a(23),i=a.n(n),r=a(13),e=a.n(r),s=a(14),c=a.n(s),l=a(7),d=a.n(l),u=a(58),p=a(248),v=a(12);o.a={name:"RegistroContrato",props:["parametros"],components:{Loading:u.default,InputFile:function(){return a.e(288).then(a.bind(null,748))},Confirmar:function(){return a.e(289).then(a.bind(null,749))}},data:function(){return{dialogA:{loading:!1,visible:!1,content:null},floatMenu:!1,fabMenu:!1,loading:!1,loadingPrint:!1,procesoContractual:null,contratoOriginal:null,contrato:null,makeContrato:{id:null,ce_procontractuale_id:null,proceso_contractual:null,consecutivo:null,fecha_contrato:null,fecha_acta_inicio:null,fecha_finalizacion:null,numero_contrato:null,rs_entidad_id:null,entidad:null,tercero:null,gn_tercero_id:null,objeto:null,ce_tipocontrato_id:null,plazo_meses:null,plazo_dias:null,valor:null,valor_total:null,modificaciones_plazo:null,modificaciones_valor:null,pr_cdp_id:null,cdp:null,estado:"Registrado",gs_usuario_id:null,minuta:null,minuta_original:null,minuta_firmada:null,archivo_minuta:null,prcdps:[]},window:0,items:[{props:{icon:"info",ref:"basicos",avatarColor:"info",title:"Datos básicos",subTitle:"Datos básicos del contrato."},component:function(){return a.e(372).then(a.bind(null,1944))}}]}},computed:{verMinutaEditable:function(){return this.contrato&&this.contrato.proceso_contractual&&("Confirmado"===this.contrato.estado||"Legalizado"===this.contrato.estado)},verPlanes:function(){return this.contrato&&this.contrato.proceso_contractual&&this.contrato.proceso_contractual.servicios_salud&&("Confirmado"===this.contrato.estado||"Legalizado"===this.contrato.estado)}},watch:{verPlanes:function(t){t&&this.items.push({props:{icon:"wifi_tethering",ref:"planes",avatarColor:"purple",title:"Planes de Cobertura",subTitle:"Registro de planes de cobertura"},component:function(){return a.e(369).then(a.bind(null,1948))}})},verMinutaEditable:function(t){t&&(this.items.push({props:{icon:"receipt",ref:"minuta",avatarColor:"primary",title:"Minuta",subTitle:"Minuta contrato",buttons:"far fa-file-pdf"},component:function(){return a.e(371).then(a.bind(null,922))}}),this.items.push({props:{icon:"done_all",ref:"perfeccionamiento",avatarColor:"orange",title:"Perfeccionamiento",subTitle:"Items del perfeccionamiento"},component:function(){return a.e(313).then(a.bind(null,1959))}}),this.items.push({props:{icon:"how_to_vote",ref:"novedades",avatarColor:"teal",title:"Novedades",subTitle:"Registro de novedades"},component:function(){return a.e(370).then(a.bind(null,1963))}}))}},created:function(){null!==this.parametros.entidad&&null!==this.parametros.entidad.id?(this.refresh(),this.getRegistro(this.parametros.entidad.id)):this.parametros.procesoContractual?(this.refresh(),this.procesoContractual=JSON.parse(d()(this.parametros.procesoContractual)),this.contrato.valor=this.procesoContractual.estudios_previos?window.lodash.sumBy(this.procesoContractual.estudios_previos.imputacion_presupuestal,"valor"):0,this.contrato.plazo_meses=this.procesoContractual.estudios_previos?this.procesoContractual.estudios_previos.plazo_meses:null,this.contrato.plazo_dias=this.procesoContractual.estudios_previos?this.procesoContractual.estudios_previos.plazo_dias:null,this.contrato.objeto=this.procesoContractual.objeto,this.contrato.ce_procontractuale_id=this.procesoContractual.id,this.contrato.proceso_contractual=this.procesoContractual):(this.$store.commit(v.b,{msg:"No hay un proceso contractual seleccionado previamente.",color:"warning"}),this.$store.dispatch("NAV_RESPONSE_CONTENT_ITEM",{contexto:this,itemId:this.parametros.tabOrigin}))},methods:{confirm:function(){var t=this;return c()(e.a.mark(function o(){return e.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.$refs.basicos[0].validate();case 2:if(!o.sent){o.next=5;break}t.dialogA.content="Los datos del contrato serán confirmados, si decide continuar, los datos no se podran editar nuevamente.<br/> <strong>¿Está seguro de confirmar los datos?</strong>",t.dialogA.visible=!0;case 5:case"end":return o.stop()}},o,t)}))()},cancelaConfirmacion:function(){this.dialogA.loading=!1,this.dialogA.visible=!1,this.dialogA.content=null},aceptaConfirmacion:function(){var t=this;return c()(e.a.mark(function o(){return e.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t.dialogA.loading=!0,t.contrato.estado="Confirmado",o.next=4,t.enviar();case 4:if(!o.sent){o.next=6;break}t.cancelaConfirmacion();case 6:t.dialogA.loading=!1;case 7:case"end":return o.stop()}},o,t)}))()},submit:function(){var t=this;return c()(e.a.mark(function o(){return e.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.$refs.basicos[0].validate();case 2:if(!o.sent){o.next=4;break}t.enviar();case 4:case"end":return o.stop()}},o,t)}))()},imprimirMinuta:function(){var t=this;return c()(e.a.mark(function o(){return e.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t.loadingPrint=!0,o.next=3,t.$refs.minuta[0].save(!1);case 3:if(!o.sent){o.next=5;break}t.filePrint("minuta-pdf&id="+t.contrato.id);case 5:t.loadingPrint=!1;case 6:case"end":return o.stop()}},o,t)}))()},enviar:function(){var t=this,o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return c()(e.a.mark(function a(){var n,r;return e.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.loading=!0,t.contrato.proceso_contractual&&(t.contrato.proceso_contractual.servicios_salud?(t.contrato.tercero=null,t.contrato.gn_tercero_id=null):(t.contrato.entidad=null,t.contrato.rs_entidad_id=null)),n=t.clone(t.contrato),n.prcdps.length&&n.prcdps.forEach(function(t){return{ce_proconminuta_id:t.ce_proconminuta_id?t.ce_proconminuta_id:null,cdp:t.cdp,pr_cdp_id:t.pr_cdp_id}}),r=n.id?t.axios.put("minutas/"+n.id,n):t.axios.post("minutas",n),a.abrupt("return",new i.a(function(a){r.then(function(n){console.log("el respose del contrato",n.data.data),t.contratoOriginal=n.data.data,t.contrato=n.data.data,t.contrato.prcdps=n.data.data.prcdps,t.$store.commit(p.y,{item:n.data.data,estado:"reload",key:t.parametros.key}),o&&t.$store.commit(v.b,{msg:"Los datos del contrato se han guardado satisfactoriamente. ",color:"success"}),t.loading=!1,a(!0)}).catch(function(o){t.loading=!1,t.$store.commit(v.a,{expression:" al guardar los datos del contrato. ",error:o}),a(!1)})}));case 6:case"end":return a.stop()}},a,t)}))()},getRegistro:function(t){var o=this;this.loading=!0,this.axios.get("minutas/"+t).then(function(t){""!==t.data&&(t.data.data.fecha_contrato=t.data.data.fecha_contrato?o.moment(t.data.data.fecha_contrato).format("YYYY-MM-DD"):null,t.data.data.fecha_acta_inicio=t.data.data.fecha_acta_inicio?o.moment(t.data.data.fecha_acta_inicio).format("YYYY-MM-DD"):null,o.contratoOriginal=JSON.parse(d()(t.data.data)),o.contrato=t.data.data,o.contrato.prcdps=t.data.data.prcdps,o.loading=!1)}).catch(function(t){o.loading=!1,o.$store.commit(v.a,{expression:" al traer el contrato. ",error:t})})},refresh:function(){this.contratoOriginal=JSON.parse(d()(this.makeContrato)),this.contrato=JSON.parse(d()(this.makeContrato)),this.$validator.reset(),this.$refs.basicos&&this.$refs.basicos[0]&&this.$refs.basicos[0].reset()},assignCDP:function(t){this.contrato.prcdps.push(t)},eliminarCDP:function(t){this.contrato.prcdps.splice(this.contrato.prcdps.findIndex(function(o){return o.cdp.id===t.cdp.id}),1)}}}},1942:function(t,o,a){var n=a(1943);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(456)("2e0216a6",n,!0,{})},1943:function(t,o,a){o=t.exports=a(455)(!0),o.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroContrato.vue",sourceRoot:""}])},1967:function(t,o,a){"use strict";var n=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("v-container",{staticClass:"pa-0 ma-0",attrs:{fluid:"","grid-list-md":""}},[a("v-slide-x-reverse-transition",{attrs:{mode:"out-in"}},[t.floatMenu?a("v-speed-dial",{key:"btn1",staticClass:"ml-1",attrs:{left:"",direction:"bottom","open-on-hover":"",fixed:""},model:{value:t.fabMenu,callback:function(o){t.fabMenu=o},expression:"fabMenu"}},[a("v-tooltip",{attrs:{slot:"activator",right:""},slot:"activator"},[a("v-btn",{staticClass:"mt-1",attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:function(o){t.floatMenu=!1}},slot:"activator",model:{value:t.fabMenu,callback:function(o){t.fabMenu=o},expression:"fabMenu"}},[a("v-icon",[t._v("vertical_split")])],1),t._v(" "),a("span",[t._v("Activar menú vertical")])],1),t._v(" "),t._l(t.items,function(o,n){return t.window!==n?a("v-tooltip",{key:n,attrs:{right:""}},[a("v-btn",{class:t.window===n?"elevation-5":"",attrs:{slot:"activator",fab:"",dark:"",small:"",color:o.props.avatarColor},on:{click:function(o){t.window=n}},slot:"activator"},[a("v-icon",[t._v(t._s(o.props.icon))])],1),t._v(" "),a("span",[t._v(t._s(o.props.title))])],1):t._e()})],2):t._e()],1),t._v(" "),a("v-toolbar",{attrs:{dense:!t.contratoOriginal.id}},[t.contratoOriginal.id&&"Registrado"!==t.contratoOriginal.estado&&!t.floatMenu?a("v-tooltip",{staticClass:"mr-2",attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(o){t.floatMenu=!0}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[t._v("group_work")])],1),t._v(" "),a("span",[t._v("activar menú flotante")])],1):t._e(),t._v(" "),a("v-icon",[t._v("work")]),t._v(" "),t.contratoOriginal.id?t.contratoOriginal.proceso_contractual?a("v-list-tile",[1===t.contratoOriginal.proceso_contractual.servicios_salud&&t.contratoOriginal.entidad?a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(t.contratoOriginal.entidad.nombre)}}),t._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:t._s("Código de habilitación: "+(t.contratoOriginal.entidad.cod_habilitacion||"No registra"))}})],1):0===t.contratoOriginal.proceso_contractual.servicios_salud&&t.contratoOriginal.tercero?a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(t.contratoOriginal.tercero.nombre_completo)}}),t._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:t._s(t.contratoOriginal.tercero.identificacion_completa)}})],1):a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s("No registra contratista")}})],1)],1):a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s("No registra proceso contractual")}})],1)],1):a("v-toolbar-title",[t._v("Nuevo contrato")]),t._v(" "),[a("v-spacer"),t._v(" "),a("span",{staticClass:"pt-1 text-xs-right"},[a("span",{staticClass:"title text-capitalize"},[t._v("Contrato")]),t._v(" "),a("p",{staticClass:"mb-0 caption"},[t._v(t._s(t.contratoOriginal.estado))])]),t._v(" "),a("v-chip",{attrs:{label:"",color:"white","text-color":"red",dark:"",absolute:"",right:"",top:""}},[a("span",{staticClass:"subheading"},[t._v("N°")]),t._v(" \n        "),a("span",{staticClass:"subheading",domProps:{textContent:t._s(null==t.contratoOriginal.numero_contrato?"00":t.contratoOriginal.numero_contrato)}})])],t._v(" "),t.contratoOriginal.id?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",icon:"",large:""},on:{click:function(o){return t.getRegistro(t.contratoOriginal.id)}},slot:"activator"},[a("v-icon",{attrs:{color:"primary",large:""}},[t._v("\n          cached\n        ")])],1),t._v(" "),a("span",[t._v("Recargar contrato")])],1):t._e()],2),t._v(" "),a("loading",{model:{value:t.loading,callback:function(o){t.loading=o},expression:"loading"}}),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-slide-x-reverse-transition",[t.contratoOriginal.id&&"Registrado"!==t.contratoOriginal.estado&&!t.floatMenu?a("v-flex",{attrs:{sm12:"",md3:""}},[a("v-card",{staticClass:"content-list-p0"},[a("v-list",{attrs:{"two-line":""}},[t._l(t.items,function(o,n){return[a("v-list-tile",{key:"list"+n,class:t.window===n?"grey lighten-2":"",on:{click:function(o){t.window=n}}},[a("v-list-tile-avatar",{attrs:{color:o.props.avatarColor}},[a("v-icon",{attrs:{dark:""}},[t._v(t._s(o.props.icon))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n                    "+t._s(o.props.title)+"\n                  ")]),t._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:t._s(o.props.subTitle)}})],1)],1),t._v(" "),a("v-divider",{attrs:{inset:""}})]})],2)],1)],1):t._e()],1),t._v(" "),a("v-flex",{attrs:{md9:t.contratoOriginal.id&&"Registrado"!==t.contratoOriginal.estado&&!t.floatMenu}},[a("v-window",{staticClass:"elevation-1",attrs:{vertical:""},model:{value:t.window,callback:function(o){t.window=o},expression:"window"}},t._l(t.items,function(o,n){return a("v-window-item",{key:n,attrs:{lazy:""}},[a("v-card",{staticClass:"content-list-p0 pt-0",attrs:{flat:""}},[t.contratoOriginal.id?a("v-list",{attrs:{"two-line":"",dense:""}},[[a("v-list-tile",[a("v-list-tile-avatar",{attrs:{color:o.props.avatarColor}},[a("v-icon",{attrs:{dark:""}},[t._v(t._s(o.props.icon))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"subheading"},[t._v("\n                      "+t._s(o.props.title)+"\n                    ")]),t._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:t._s(o.props.subTitle)}})],1),t._v(" "),a("v-list-tile-action",[o.props.buttons&&"far fa-file-pdf"===o.props.buttons?a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",icon:"",large:"",loading:t.loadingPrint},on:{click:t.imprimirMinuta},slot:"activator"},[a("v-icon",{attrs:{medium:"",color:"success"}},[t._v("\n                          far fa-file-pdf\n                        ")])],1),t._v(" "),a("span",[t._v("Vista previa")])],1):t._e()],1)],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-divider")]],2):t._e(),t._v(" "),"basicos"===o.props.ref?a(o.component,{ref:o.props.ref,refInFor:!0,tag:"component",attrs:{parent:"primary",original:t.contratoOriginal},on:{clean:t.refresh,addCdp:function(o){return t.assignCDP(o)},deleteCDP:function(o){return t.eliminarCDP(o)}},model:{value:t.contrato,callback:function(o){t.contrato=o},expression:"contrato"}}):a(o.component,{ref:o.props.ref,refInFor:!0,tag:"component",attrs:{parent:"primary",original:t.contratoOriginal},on:{clean:t.refresh},model:{value:t.contrato,callback:function(o){t.contrato=o},expression:"contrato"}}),t._v(" "),0===n&&"Registrado"===t.contratoOriginal.estado?[a("v-divider"),t._v(" "),t.contratoOriginal.fecha_acta_inicio?t._e():a("v-card-actions",[a("v-btn",{attrs:{flat:""},on:{click:function(o){return o.stopPropagation(),t.refresh(o)}}},[t._v("Limpiar")]),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{flat:"",color:"primary",loading:t.loading},on:{click:function(o){return o.preventDefault(),t.confirm(o)}}},[t._v("Guardar y confirmar")]),t._v(" "),a("v-btn",{attrs:{flat:"",color:"primary",loading:t.loading},on:{click:function(o){return o.stopPropagation(),t.submit(o)}}},[t._v("Guardar")])],1)]:t._e()],2)],1)}),1)],1)],1),t._v(" "),a("confirmar",{attrs:{loading:t.dialogA.loading,value:t.dialogA.visible,content:t.dialogA.content,"requiere-motivo":!1},on:{cancelar:t.cancelaConfirmacion,aceptar:t.aceptaConfirmacion}})],1)},i=[],r={render:n,staticRenderFns:i};o.a=r},584:function(t,o,a){"use strict";function n(t){a(1942)}Object.defineProperty(o,"__esModule",{value:!0});var i=a(1112),r=a(1967),e=a(1),s=n,c=e(i.a,r.a,!1,s,"data-v-00db8ac4",null);o.default=c.exports}});
//# sourceMappingURL=195.ec21f1f0fa74dad944f6.js.map