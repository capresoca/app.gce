webpackJsonp([372],{1113:function(e,a,t){"use strict";var o=t(253),r=t(254),l=t(59);a.a={name:"RegistroContratoDatosBasicos",props:["value","original"],components:{InputDate:o.default,InputNumber:r.default,PostuladorV2:function(){return new Promise(function(e){e()}).then(t.bind(null,61))}},data:function(){return{detalleTercero:function(){return t.e(291).then(t.bind(null,768))},DetalleEntidad:function(){return t.e(294).then(t.bind(null,823))},minDate:"1900-01-01",maxDate:(new Date).toISOString().substr(0,10),okPoblacionObjetivo:!0,itemCDP:null,cdps:[],headersCdps:[{text:"CDP",align:"left",sortable:!1,value:"objecto"},{text:"Valor Descontado",align:"left",sortable:!1,value:"valor_descontado"},{text:"Disponible",align:"left",sortable:!1,value:"valor_cdp"},{text:"Eliminar",align:"center",sortable:!1,value:""}],totalDetalles:{totalDebito:0,totalCredito:0,sumasIguales:0,clase:null}}},created:function(){this.formReset()},computed:{valorDisponibleCDP:function(){var e=0;return this.value&&this.value.prcdps.length&&this.value.prcdps.forEach(function(a){var t=a.cdp?a.cdp.valor_cdp-a.cdp.suma_valores_ejecutados:0;e+=t}),e<0?0:e},complementos:function(){return l.b.getters.complementosContratoFormDatosBasica}},methods:{validate:function(){return this.$validator.validateAll()},reset:function(){return this.$validator.reset()},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},formReset:function(){this.itemCDP={id:null,ce_proconminuta_id:null,pr_cdp_id:null,valor_descontado:0,cdp:null,index:null}},add:function(e){var a=this.clone(e),t=this.value.prcdps.filter(function(e){return e.cdp&&e.cdp.id===a.cdp.id}).length,o=0;a.cdp&&(o=a.cdp.valor_cdp-a.cdp.suma_valores_ejecutados);var r=0;this.value.prcdps.map(function(e){return r+=e.valor_descontado}),console.log("ass",a,t,o,r),a.cdp&&a.pr_cdp_id&&a.valor_descontado>0&&0===t&&0!==o&&(r>=0||r<this.value.valor)?(this.$emit("addCdp",e),this.formReset()):(1===t&&this.$store.commit("SNACK_SHOW",{msg:"Ya existe registrado el CDP.",color:"danger"}),0===o&&this.$store.commit("SNACK_SHOW",{msg:"El CDP no cuenta con disponibilidad $.",color:"danger"}),(r<0||r>=this.value.valor)&&this.$store.commit("SNACK_SHOW",{msg:"El valor debe ser mayor a cero y no puede ser mayor al valor contratado.",color:"danger"}),(a.cdp||a.pr_cdp_id)&&0!==a.valor_descontado||this.$store.commit("SNACK_SHOW",{msg:"Existen campos vacios para registro del CDP.",color:"danger"}))},eliminarCDP:function(e,a){this.$emit("deleteCDP",a)}}}},1944:function(e,a,t){"use strict";function o(e){t(1945)}Object.defineProperty(a,"__esModule",{value:!0});var r=t(1113),l=t(1947),i=t(1),s=o,n=i(r.a,l.a,!1,s,"data-v-df47b190",null);a.default=n.exports},1945:function(e,a,t){var o=t(1946);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(456)("7af6d61a",o,!0,{})},1946:function(e,a,t){a=e.exports=t(455)(!0),a.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroDatosBasicos.vue",sourceRoot:""}])},1947:function(e,a,t){"use strict";var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-card-text",[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Tipo",items:e.value&&e.value.proceso_contractual&&null!==e.value.proceso_contractual.servicios_salud&&void 0!==e.value.proceso_contractual.servicios_salud&&e.complementos&&e.complementos.tiposContrato?e.complementos.tiposContrato.filter(function(a){return a.servicios_salud===e.value.proceso_contractual.servicios_salud}):[],"item-value":"id","item-text":"nombre",name:"Tipo","error-messages":e.errors.collect("Tipo"),readonly:!!e.value.actaInicio},model:{value:e.value.ce_tipocontrato_id,callback:function(a){e.$set(e.value,"ce_tipocontrato_id",a)},expression:"value.ce_tipocontrato_id"}},[t("template",{slot:"no-data"},[t("div",{staticClass:"px-3"},[t("v-icon",{attrs:{color:"danger"}},[e._v("warning")]),e._v(" El contrato no tiene proceso contractual\n          ")],1)])],2)],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Número",name:"Número","error-messages":e.errors.collect("Número"),readonly:!!e.value.actaInicio},model:{value:e.value.numero_contrato,callback:function(a){e.$set(e.value,"numero_contrato",a)},expression:"value.numero_contrato"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("input-date",{directives:[{name:"validate",rawName:"v-validate",value:"required|fechaValida|date_format:YYYY-MM-DD|date_between:"+e.minDate+","+e.maxDate+",true",expression:"'required|fechaValida|date_format:YYYY-MM-DD|date_between:' + minDate + ',' + maxDate + ',true'"}],attrs:{label:"Fecha (Año-Mes-Día)",format:"YYYY-MM-DD",name:"Fecha",min:e.minDate,max:e.maxDate,"error-messages":e.errors.collect("Fecha"),readonly:!!e.value.actaInicio},model:{value:e.value.fecha_contrato,callback:function(a){e.$set(e.value,"fecha_contrato",a)},expression:"value.fecha_contrato"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-card",{staticClass:"pa-0"},["Registrado"===e.value.estado?t("v-form",{attrs:{"data-vv-scope":"formCDP"}},[t("v-card-text",{staticClass:"pb-0 pt-1"},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm8:"",md8:""}},[t("postulador-v2",{attrs:{"no-data":"Busqueda por consecutivo, dependencia o valor.",hint:"objecto","item-text":"consecutivo","data-title":"dependencia.nombre","data-subtitle":"objecto","route-params":"estado_valor=Disponible,Comprometido Parcialmente",label:"CDP",entidad:"pr_cdps",preicon:"attach_money",name:"CDP",scope:"formCDP","error-messages":e.errors.collect("CDP"),"no-btn-create":"","no-btn-edit":"","slot-append":{template:'<span class="pt-2 caption">Disponible: {{currency(value.valor_cdp - value.suma_valores_ejecutados)}}</span>',props:["value"]},"slot-selection":{template:"\n                    <span>{{value.consecutivo}} - {{value.dependencia.nombre}}</span>\n                    ",props:["value"]},"slot-data":{template:'\n                    <v-list-tile>\n                      <v-list-tile-content>\n                        <v-list-tile-title>\n                          <span>{{value.consecutivo}} - {{value.dependencia.nombre}}</span>\n                          <v-chip\n                            class="mt-0 mb-2"\n                            color="indigo lighten-2"\n                            label\n                            small\n                            >\n                            Disponible: {{currency(value.valor_cdp - value.suma_valores_ejecutados)}}\n                          </v-chip>\n                        </v-list-tile-title>\n                        <v-list-tile-sub-title class="caption">{{ value.objecto }}</v-list-tile-sub-title>\n                      </v-list-tile-content>\n                    </v-list-tile>\n                    ',props:["value"]},readonly:!!e.value.actaInicio},on:{changeid:function(a){return e.itemCDP.pr_cdp_id=a}},model:{value:e.itemCDP.cdp,callback:function(a){e.$set(e.itemCDP,"cdp",a)},expression:"itemCDP.cdp"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required|min_value:0"+(0===e.value.valor?"":"|max_value:"+e.value.valor),expression:"'required|min_value:0' + (value.valor === 0 ? '' : '|max_value:' + value.valor)"}],attrs:{label:"Valor a Descontar","prepend-icon":"attach_money",precision:0,name:"valor a descontar","error-messages":e.errors.collect("valor a descontar"),readonly:!!e.value.actaInicio,disabled:!e.itemCDP.cdp},model:{value:e.itemCDP.valor_descontado,callback:function(a){e.$set(e.itemCDP,"valor_descontado",e._n(a))},expression:"itemCDP.valor_descontado"}})],1),e._v(" "),t("v-flex",{staticClass:"text-xs-right pa-1 grey lighten-3",attrs:{xs12:"",sm12:"",md12:""}},[t("v-tooltip",{attrs:{top:""}},[t("v-btn",{attrs:{slot:"activator",small:"",dark:"",color:"pink"},on:{click:function(a){return e.add(e.itemCDP)}},slot:"activator"},[t("span",{domProps:{textContent:e._s("Agregar")}})]),e._v(" "),t("span",{domProps:{textContent:e._s("Agregar CDP")}})],1)],1)],1)],1)],1):e._e(),e._v(" "),t("v-slide-y-transition",{attrs:{group:""}},[e.value.prcdps.length?t("v-data-table",{key:"table",staticClass:"elevation-1",attrs:{items:e.value.prcdps,headers:e.headersCdps,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(a){return[t("tr",{key:"tag-"+(a.item.id?a.index:a.item.id=a.index)},[t("td",{staticClass:"text-xs-justify truncate"},[e._v(e._s(a.item.cdp?a.item.cdp.consecutivo+" - "+a.item.cdp.objecto:null))]),e._v(" "),t("td",{staticClass:"text-xs-right"},[e._v(e._s(e.currency(a.item.valor_descontado)))]),e._v(" "),t("td",{staticClass:"text-xs-right"},[t("v-list-tile",[t("v-list-tile-content",[t("v-list-tile-sub-title",{staticClass:"caption"},[e._v("Anterior: "+e._s(a.item.cdp?e.currency("Registrado"!==e.value.estado?a.item.valor_cdp_anterior:a.item.cdp.valor_cdp-a.item.cdp.suma_valores_ejecutados):null))]),e._v(" "),a.item.valor_descontado>0?t("v-list-tile-sub-title",{staticClass:"caption"},[e._v("Actual: "+e._s(a.item.cdp?e.currency(("Registrado"!==e.value.estado?a.item.valor_cdp_anterior:a.item.cdp.valor_cdp-a.item.cdp.suma_valores_ejecutados)-a.item.valor_descontado):0))]):e._e()],1)],1)],1),e._v(" "),t("td",{staticClass:"text-xs-center"},[t("v-btn",{staticClass:"mx-0",attrs:{icon:"",disabled:"Registrado"!==e.value.estado,fab:"",small:""},on:{click:function(t){return e.eliminarCDP(a.index,a.item)}}},[t("v-icon",{attrs:{color:"accent"}},[e._v("delete")])],1)],1)])]}}],null,!1,486092111)},[e._v(" "),t("template",{staticClass:"error",slot:"no-data"},[t("div",{staticClass:"pa-1 pl-2 text--white text-xs-center"},[e._v("\n                Lo sentimos, no existen registros. "),t("v-icon",[e._v("sentiment_very_dissatisfied")])],1)])],2):e._e()],1)],1)],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[e.value.proceso_contractual&&e.value.proceso_contractual.servicios_salud?t("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"postuladorEntidad",attrs:{"no-data":"Busqueda por NIT, razon social u código de habilitación.",hint:"tercero.identificacion_completa","item-text":"nombre","data-title":"tercero.identificacion_completa","data-subtitle":"nombre",filter:"nombre,tercero.identificacion_completa,tercero.nombre_completo,cod_habilitacion",detail:e.DetalleEntidad,label:"Entidad",entidad:"entidades",preicon:"location_city",name:"Entidad",rules:"required","error-messages":e.errors.collect("Entidad"),"no-btn-create":"","no-btn-edit":"","min-characters-search":3,readonly:!!e.value.actaInicio},on:{changeid:function(a){return e.value.rs_entidad_id=a}},model:{value:e.value.entidad,callback:function(a){e.$set(e.value,"entidad",a)},expression:"value.entidad"}}):t("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"postuladorTercero",attrs:{"no-data":"Busqueda por nombre o número de documento.",hint:"identificacion_completa","item-text":"nombre_completo","data-title":"identificacion_completa","data-subtitle":"nombre_completo",label:"Tercero",detail:e.detalleTercero,entidad:"terceros",name:"Tercero",preicon:"person",rules:"required","error-messages":e.errors.collect("Tercero"),readonly:!!e.value.actaInicio,"no-btn-create":"","no-btn-edit":""},on:{changeid:function(a){return e.value.gn_tercero_id=a}},model:{value:e.value.tercero,callback:function(a){e.$set(e.value,"tercero",a)},expression:"value.tercero"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required|min_value:0|max_value:"+e.valorDisponibleCDP,expression:"'required|min_value:0|max_value:' + valorDisponibleCDP"}],attrs:{label:"Valor","prepend-icon":"attach_money",precision:0,name:"Valor","error-messages":e.errors.collect("Valor"),readonly:!!e.value.actaInicio,disabled:!e.value.prcdps.length},model:{value:e.value.valor,callback:function(a){e.$set(e.value,"valor",e._n(a))},expression:"value.valor"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"numeric|required|min_value:0",expression:"'numeric|required|min_value:0'"}],attrs:{label:"Plazo meses",min:"0",type:"number",name:"Plazo meses","error-messages":e.errors.collect("Plazo meses"),readonly:!!e.value.actaInicio},model:{value:e.value.plazo_meses,callback:function(a){e.$set(e.value,"plazo_meses",e._n(a))},expression:"value.plazo_meses"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"numeric|required|min_value:0",expression:"'numeric|required|min_value:0'"}],attrs:{label:"Plazo días",min:"0",type:"number",name:"Plazo días","error-messages":e.errors.collect("Plazo días"),readonly:!!e.value.actaInicio},model:{value:e.value.plazo_dias,callback:function(a){e.$set(e.value,"plazo_dias",e._n(a))},expression:"value.plazo_dias"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"auto-grow":"",label:"Objeto",rows:"1",name:"Objeto","error-messages":e.errors.collect("Objeto"),readonly:!!e.value.actaInicio},model:{value:e.value.objeto,callback:function(a){e.$set(e.value,"objeto",a)},expression:"value.objeto"}})],1)],1)],1)},r=[],l={render:o,staticRenderFns:r};a.a=l}});
//# sourceMappingURL=372.bd295278eeadf9a977ae.js.map