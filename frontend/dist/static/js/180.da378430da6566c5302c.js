webpackJsonp([180],{1541:function(o,e,t){var a=t(1542);"string"==typeof a&&(a=[[o.i,a,""]]),a.locals&&(o.exports=a.locals);t(456)("2be5f82a",a,!0,{})},1542:function(o,e,t){e=o.exports=t(455)(!0),e.push([o.i,"","",{version:3,sources:[],names:[],mappings:"",file:"ConPagos.vue",sourceRoot:""}])},1543:function(o,e,t){"use strict";var a=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",[t("v-dialog",{attrs:{width:"500px"},model:{value:o.dialog,callback:function(e){o.dialog=e},expression:"dialog"}},[t("v-form",{attrs:{"data-vv-scope":"formPago"}},[t("v-card",[t("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[t("span",{staticClass:"title"},[o._v(o._s(o.modalTitulo))])]),o._v(" "),t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:5|not_in:"+o.codigosUsados,expression:"'required|max:5|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo",required:"","error-messages":o.errors.collect("codigo")},model:{value:o.conPago.codigo,callback:function(e){o.$set(o.conPago,"codigo",e)},expression:"conPago.codigo"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:150|not_in:"+o.nombresUsados,expression:"'required|max:150|not_in:' + nombresUsados"}],key:"nombre",attrs:{label:"Nombre",name:"nombre",required:"","error-messages":o.errors.collect("nombre")},model:{value:o.conPago.nombre,callback:function(e){o.$set(o.conPago,"nombre",e)},expression:"conPago.nombre"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"tipo concepto",attrs:{items:o.tiposConcepto,label:"Tipo concepto",name:"tipo concepto","error-messages":o.errors.collect("tipo concepto"),required:""},model:{value:o.conPago.tipo_concepto,callback:function(e){o.$set(o.conPago,"tipo_concepto",e)},expression:"conPago.tipo_concepto"}})],1),o._v(" "),t("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t("postulador",{ref:"buscarCuenta",attrs:{nodata:"Busqueda por código o nombre.",required:"",hint:"codigo",itemtext:"nombre",datatitle:"codigo",datasubtitle:"nombre",filter:"codigo,nombre",label:o.conPago.nf_niif_id?"Cuenta":"cuenta",lite:"",scope:"formPago",entidad:"niifs",routeparams:"nivel:auxiliar=1",preicon:"fas fa-wallet",value:o.conPago.niif,clearable:""},on:{change:function(e){return o.conPago.nf_niif_id=e},objectReturn:function(e){return o.conPago.niif=e}}})],1)],1)],1),o._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-spacer"),o._v(" "),t("v-btn",{on:{click:o.close}},[o._v("Cancelar")]),o._v(" "),t("v-btn",{attrs:{color:"primary"},on:{click:o.save}},[o._v("Guardar")])],1)],1)],1)],1),o._v(" "),t("v-card",[t("v-toolbar",{staticClass:"elevation-0 toolbar--dense"},[t("v-toolbar-title",{staticClass:"title"},[o._v("Conceptos de Pagos ")]),o._v(" "),t("v-spacer"),o._v(" "),o.infoComponent&&o.infoComponent.permisos.agregar?t("v-btn",{attrs:{fab:"",small:"",color:"accent"},nativeOn:{click:function(e){o.dialog=!0}}},[t("v-icon",[o._v("add")])],1):o._e()],1),o._v(" "),t("v-card-title",[t("v-text-field",{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",flat:""},model:{value:o.search,callback:function(e){o.search=e},expression:"search"}})],1),o._v(" "),t("v-data-table",{staticClass:"elevation-1",attrs:{headers:o.headers,items:o.conPagos,loading:o.tableLoading,pagination:o.pagination,"hide-actions":"",search:o.search,"rows-per-page-text":"Registros por página","rows-per-page-items":[10,25,50,{text:"Todos",value:-1}]},on:{"update:pagination":function(e){o.pagination=e}},scopedSlots:o._u([{key:"items",fn:function(e){return[t("td",[o._v(o._s(e.item.codigo))]),o._v(" "),t("td",[o._v(o._s(e.item.nombre))]),o._v(" "),t("td",[o._v(o._s(e.item.tipo_concepto))]),o._v(" "),t("td",[o._v(o._s(e.item.niif?e.item.niif.nombre:""))]),o._v(" "),t("td",{staticClass:"text-xs-center"},[o.infoComponent&&o.infoComponent.permisos.agregar?t("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(t){return o.edit(e.item)}}},[t("v-icon",{attrs:{color:"accent"}},[o._v("edit")])],1):o._e()],1)]}},{key:"pageText",fn:function(e){return[o._v("\n        "+o._s(e.pageStart)+" - "+o._s(e.pageStop)+" de "+o._s(e.itemsLength)+"\n      ")]}}])},[o._v(" "),t("template",{slot:"no-data"},[o.tableLoading?t("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[o._v("\n          Lo sentimos, no tenemos registros para mostrar. "),t("v-icon",[o._v("sentiment_very_dissatisfied")])],1):t("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[o._v("\n          Estamos cargando los registros. "),t("v-icon",[o._v("sentiment_satisfied_alt")])],1)],1),o._v(" "),o._v(" "),t("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[o._v('\n        No se encontraron resultados de "'+o._s(o.search)+'"\n      ')])],2),o._v(" "),t("v-card-actions",{staticClass:"text-xs-center pt-2 d-block"},[t("v-pagination",{attrs:{length:o.pages},model:{value:o.pagination.page,callback:function(e){o.$set(o.pagination,"page",e)},expression:"pagination.page"}})],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};e.a=s},497:function(o,e,t){"use strict";function a(o){t(1541)}Object.defineProperty(e,"__esModule",{value:!0});var n=t(980),s=t(1543),i=t(1),r=a,c=i(n.a,s.a,!1,r,"data-v-69ad17e0",null);e.default=c.exports},980:function(o,e,t){"use strict";var a=t(13),n=t.n(a),s=t(14),i=t.n(s),r=t(7),c=t.n(r),l=t(12);e.a={name:"ConPagos",components:{Postulador:function(){return t.e(287).then(t.bind(null,747))}},data:function(){return{conPagos:[],conPago:{},search:"",dialog:!1,tableLoading:!1,pagination:{},codigosUsados:"",nombresUsados:"",tiposConcepto:["CXP","Notas","Traslado de Valores","Saldos Iniciales"],headers:[{text:"Código",align:"left",sortable:!1,value:"codigo"},{text:"Nombre",align:"left",sortable:!1,value:"nombre"},{text:"Tipo Concepto",align:"left",sortable:!1,value:"tipo_concepto"},{text:"Cuenta",align:"left",sortable:!1,value:"nf_niif_id"},{text:"Opciones",align:"center",sortable:!1,value:"id"}]}},beforeMount:function(){this.formReset()},mounted:function(){var o={custom:{codigo:{not_in:"Este código ya fue registrado."},nombre:{not_in:"Este nombre ya fue registrado."}}};this.$validator.localize("es",o)},watch:{dialog:function(o){!1===o&&this.close()}},beforeCreate:function(){var o=this;this.tableLoading=!0,this.axios.get("pg_conpagos").then(function(e){o.conPagos=e.data.data,o.pagination.totalItems=o.conPagos.length,o.tableLoading=!1,o.codigosUsados=o.getCodigosUsados(),o.nombresUsados=o.getNombresUsados()}).catch(function(o){return console.log("Hay un error. "+o),!1})},computed:{infoComponent:function(){return this.$store.getters.getInfoComponent("conPagos")},modalTitulo:function(){return this.conPago.id?"Edición del Concepto de Pago: "+this.conPago.nombre:"Nuevo Concepto de Pago"},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)}},methods:{formReset:function(){this.conPago={id:"",codigo:null,nombre:null,tipo_concepto:null,nf_niif_id:null,niif:null},this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},edit:function(o){this.dialog=!0,this.conPago=JSON.parse(c()(o)),this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},close:function(){this.dialog=!1,this.formReset(),this.$validator.reset(),this.$refs.buscarCuenta.reset()},getCodigosUsados:function(){var o=this;return this.conPagos.map(function(e){if(null==o.conPago.codigo||o.conPago.codigo!==e.codigo)return e.codigo})},getNombresUsados:function(){var o=this;return this.conPagos.map(function(e){if(null==o.conPago.nombre||o.conPago.nombre!==e.nombre)return e.nombre})},validador:function(o){return this.$validator.validateAll(o).then(function(o){return o})},save:function(){var o=this;return i()(n.a.mark(function e(){var t,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.$refs.buscarCuenta.validate();case 2:return t=e.sent,e.next=5,o.validador("formPago");case 5:if(e.t0=e.sent,!e.t0){e.next=8;break}e.t0=t;case 8:if(!e.t0){e.next=13;break}a=o.conPago.id?o.axios.put("pg_conpagos/"+o.conPago.id,o.conPago):o.axios.post("pg_conpagos",o.conPago),a.then(function(e){o.conPago.id?(o.$store.commit(l.b,{msg:"El concepto de pago actualizó correctamente",color:"success"}),o.conPagos.splice(o.conPagos.findIndex(function(o){return o.id===e.data.data.id}),1,e.data.data)):(o.$store.commit(l.b,{msg:"El concepto de pago se creó correctamente",color:"success"}),o.conPagos.splice(0,0,e.data.data)),o.dialog=!1,o.close()}).catch(function(e){o.$store.commit(l.b,{msg:"Hay un error al guardar el registro. "+e.response,color:"danger"})}),e.next=14;break;case 13:o.$store.commit(l.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 14:case"end":return e.stop()}},e,o)}))()}}}}});
//# sourceMappingURL=180.da378430da6566c5302c.js.map