webpackJsonp([31],{1075:function(e,t,o){"use strict";var r=o(7),s=o.n(r),i=o(1828),n=o.n(i),a=o(1833),l=o(12);t.a={name:"Roles",components:{RegistroRol:a.a},data:function(){return{activeNewRol:[!1],activeRegistros:[],itemActive:null,search:null,registros:null,registrosAll:null,rol:null,newRol:null,makeNewRol:{id:null,nombre:null,descripcion:null},makeModulos:null,modulos:null}},watch:{},computed:{infoComponent:function(){return this.$store.getters.getInfoComponent("roles")}},mounted:function(){this.reloadPage()},methods:{filtrando:function(){var e=this;this.registros=this.search?this.registrosAll.filter(function(t){return-1!==t.nombre.toLowerCase().search(e.search.toLowerCase())||-1!==t.descripcion.toLowerCase().search(e.search.toLowerCase())}):this.registrosAll},closePanelsRols:function(){this.activeNewRol=[!1],this.activeRegistros=[].concat(n()(Array(this.registros).keys())).map(function(e){return!1})},openPanel:function(e,t,o){this.goRol(e,!1),this.closePanelsRols(),this.activeRegistros[t]=o},createNewRol:function(){this.newRol=JSON.parse(s()(this.makeNewRol)),this.closePanelsRols(),this.activeNewRol=[!0]},insertRol:function(e,t){-1===t?(this.activeNewRol=[!1],this.registros.unshift(e)):(this.registros.splice(this.registros.findIndex(function(t){return t.id===e.id}),1,e),this.closePanelsRols()),this.goRol(e.id,!0)},changePermiso:function(e,t){var o=this;e.disabled=!0;var r={gs_componente_id:e.permisos[0].gs_componente_id,gs_role_id:e.permisos[0].gs_role_id,id:e.permisos[0].id};e.permisos.forEach(function(o){r[o.propiedad]=1===t?e.selectAll:o[o.propiedad]}),("editar"==(r.id?"editar":"crear")?this.axios.put("gs_permiso_roles/"+r.id,r):this.axios.post("gs_permiso_roles",r)).then(function(t){var o=0;e.permisos.forEach(function(e){e[e.propiedad]=t.data.permisoRole[e.propiedad],e.id=t.data.permisoRole.id,0===e[e.propiedad]&&o++}),e.disabled=!1,e.selectAll=0===o?1:0}).catch(function(e){o.$store.commit(l.a,{expression:" al intentar guardar los permisos. ",error:e})})},reloadPage:function(){var e=this;this.axios.get("gs_roles").then(function(t){e.registrosAll=t.data.data.roles,e.registros=e.registrosAll,t.data.data.modulos.forEach(function(e){e.componentes.forEach(function(e){e.selectAll=!1,e.disabled=!1})}),e.makeModulos=t.data.data.modulos}).catch(function(t){e.$store.commit(l.a,{expression:" al intentar cargar los roles. ",error:t})})},goRol:function(e,t){var o=this;this.itemActive=e,this.axios.get("gs_roles/"+e).then(function(r){o.modulos=JSON.parse(s()(o.makeModulos)),o.modulos.forEach(function(t){t.componentes.forEach(function(t){var o=r.data.data.permisos.find(function(e){return e.gs_componente_id===t.id}),s=0;t.permisos.forEach(function(t){t[t.propiedad]=void 0!==o?o[t.propiedad]:0,t.id=void 0!==o?o.id:null,t.gs_role_id=e,0===t[t.propiedad]&&s++}),t.selectAll=0===s?1:0})}),o.rol=r.data.data,t&&(o.closePanelsRols(),o.$vuetify.goTo("#flag-permisos",{selector:"#flag-permisos",duration:300,offset:-120,easing:"easeInOutQuad"}))}).catch(function(e){o.$store.commit(l.a,{expression:" al intentar cargar los datos del rol. ",error:e})})}}}},1076:function(e,t,o){"use strict";var r=o(7),s=o.n(r),i=o(12);t.a={name:"registroRol",props:["value"],data:function(){return{loadingBtnRol:!1,rol:null}},components:{},watch:{value:function(e){e&&(this.rol=JSON.parse(s()(this.value)),this.$validator.reset())}},mounted:function(){this.rol=JSON.parse(s()(this.value)),this.$validator.reset()},computed:{},methods:{submitRol:function(){var e=this;this.$validator.validateAll("formNewRol").then(function(t){if(t){e.loadingBtnRol=!0;var o=e.rol.id?"editar":"crear";("editar"===o?e.axios.put("gs_roles/"+e.rol.id,e.rol):e.axios.post("gs_roles",e.rol)).then(function(t){e.$store.commit(i.b,{msg:"El rol se ha "+("editar"===o?"editado":"creado")+" satisfactoriamente.",color:"success"}),e.loadingBtnRol=!1,e.$emit("return",t.data.data)}).catch(function(t){e.loadingBtnRol=!1,e.$store.commit(i.a,{expression:" al intentar guardar los datos del rol. ",error:t})})}})}}}},1826:function(e,t,o){var r=o(1827);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(456)("cb7855bc",r,!0,{})},1827:function(e,t,o){t=e.exports=o(455)(!0),t.push([e.i,"#flex-create-rol div.v-expansion-panel__header{cursor:default!important;padding:0!important}.check-title-componente .v-icon{display:initial!important}","",{version:3,sources:["/home/capresoca/projects/Capresoca-Frontend/src/components/general/seguridad/roles/Roles.vue"],names:[],mappings:"AACA,+CACE,yBAA2B,AAC3B,mBAAsB,CACvB,AACD,gCACE,yBAA4B,CAC7B",file:"Roles.vue",sourcesContent:["\n#flex-create-rol div.v-expansion-panel__header{\n  cursor: default !important;\n  padding: 0 !important;\n}\n.check-title-componente .v-icon {\n  display: initial !important;\n}\n"],sourceRoot:""}])},1828:function(e,t,o){"use strict";t.__esModule=!0;var r=o(1829),s=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return(0,s.default)(e)}},1829:function(e,t,o){e.exports={default:o(1830),__esModule:!0}},1830:function(e,t,o){o(42),o(1831),e.exports=o(2).Array.from},1831:function(e,t,o){"use strict";var r=o(28),s=o(9),i=o(41),n=o(261),a=o(262),l=o(63),c=o(1832),d=o(65);s(s.S+s.F*!o(263)(function(e){Array.from(e)}),"Array",{from:function(e){var t,o,s,v,u=i(e),p="function"==typeof this?this:Array,m=arguments.length,f=m>1?arguments[1]:void 0,_=void 0!==f,g=0,h=d(u);if(_&&(f=r(f,m>2?arguments[2]:void 0,2)),void 0==h||p==Array&&a(h))for(t=l(u.length),o=new p(t);t>g;g++)c(o,g,_?f(u[g],g):u[g]);else for(v=h.call(u),o=new p;!(s=v.next()).done;g++)c(o,g,_?n(v,f,[s.value,g],!0):s.value);return o.length=g,o}})},1832:function(e,t,o){"use strict";var r=o(24),s=o(62);e.exports=function(e,t,o){t in e?r.f(e,t,s(0,o)):e[t]=o}},1833:function(e,t,o){"use strict";function r(e){o(1834)}var s=o(1076),i=o(1836),n=o(1),a=r,l=n(s.a,i.a,!1,a,"data-v-7bc34277",null);t.a=l.exports},1834:function(e,t,o){var r=o(1835);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o(456)("60c0fda0",r,!0,{})},1835:function(e,t,o){t=e.exports=o(455)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroRol.vue",sourceRoot:""}])},1836:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.rol?o("v-card",{staticClass:"grey lighten-4"},[o("v-divider"),e._v(" "),o("v-subheader",[e._v(e._s(e.rol.id?"Edición del rol: "+e.rol.nombre:"nuevo Rol"))]),e._v(" "),o("v-divider"),e._v(" "),o("v-container",{attrs:{fluid:"","grid-list-xl":""}},[e.value?o("v-form",{attrs:{"data-vv-scope":"formNewRol"}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Nombre",name:"Nombre","error-messages":e.errors.collect("Nombre")},model:{value:e.rol.nombre,callback:function(t){e.$set(e.rol,"nombre",t)},expression:"rol.nombre"}})],1),e._v(" "),o("v-flex",[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Descripción",name:"Descripción","error-messages":e.errors.collect("Descripción")},model:{value:e.rol.descripcion,callback:function(t){e.$set(e.rol,"descripcion",t)},expression:"rol.descripcion"}})],1)],1)],1):e._e()],1),e._v(" "),o("v-divider"),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{loading:e.loadingBtnRol,small:"",flat:""},nativeOn:{click:function(t){return e.$emit("cancelar")}}},[e._v("Cancelar")]),e._v(" "),o("v-btn",{attrs:{loading:e.loadingBtnRol,small:"",color:"primary"},nativeOn:{click:function(t){return e.submitRol(t)}}},[e._v("Registrar")])],1)],1):e._e()},s=[],i={render:r,staticRenderFns:s};t.a=i},1837:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",[o("v-container",{staticClass:"pt-0 pl-0 mt-0 ml-0",attrs:{fluid:"","grid-list-xl":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{sm12:"",md4:e.rol,md12:!e.rol,id:"flex-create-rol"}},[o("v-expansion-panel",{key:"panel1",attrs:{expand:"",readonly:""},model:{value:e.activeNewRol,callback:function(t){e.activeNewRol=t},expression:"activeNewRol"}},[o("v-expansion-panel-content",{attrs:{"hide-actions":""}},[o("v-toolbar",{staticClass:"transparent py-3",attrs:{slot:"header",flat:""},slot:"header"},[o("v-icon",{attrs:{color:"green darken-4"}},[e._v(e._s(e.infoComponent?e.infoComponent.icono:""))]),e._v(" "),o("v-toolbar-title",{domProps:{innerHTML:e._s("Roles")}}),e._v(" "),o("small",{staticClass:"mt-2 ml-1"},[e._v(" Registro y gestión")]),e._v(" "),o("v-spacer"),e._v(" "),o("v-tooltip",{attrs:{top:""}},[e.infoComponent&&e.infoComponent.permisos.agregar?o("v-btn",{attrs:{slot:"activator",fab:"",right:"",small:"",color:"accent"},on:{click:function(t){return t.stopPropagation(),e.createNewRol(t)}},slot:"activator"},[o("v-icon",[e._v("add")])],1):e._e(),e._v(" "),o("span",[e._v("Crear rol")])],1)],1),e._v(" "),o("registro-rol",{key:"registroRolNew",on:{cancelar:function(t){e.activeNewRol=[!1]},return:function(t){return e.insertRol(t,-1)}},model:{value:e.newRol,callback:function(t){e.newRol=t},expression:"newRol"}})],1)],1),e._v(" "),o("v-divider"),e._v(" "),o("v-container",{staticClass:"py-0 my-0",attrs:{"grid-list-xl":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",[o("v-text-field",{attrs:{"prepend-icon":"search",placeholder:"Buscar...",clearable:"",disabled:!e.registros},on:{input:e.filtrando},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1)],1),e._v(" "),o("v-divider"),e._v(" "),null!==e.registros&&e.registros.length?o("v-expansion-panel",{key:"panel2",attrs:{expand:"",readonly:""},model:{value:e.activeRegistros,callback:function(t){e.activeRegistros=t},expression:"activeRegistros"}},e._l(e.registros,function(t,r){return o("v-expansion-panel-content",{key:"expancionsRoles"+r,attrs:{"hide-actions":""}},[o("v-layout",{attrs:{slot:"header",row:"",wrap:"",fluid:""},slot:"header"},[o("v-flex",[o("v-list",{key:"listRoles"+r,staticClass:"py-0 my-0",attrs:{dense:"","two-line":""}},[o("v-list-tile",{key:"internalListRoles"+r,class:e.itemActive===t.id?"grey lighten-2":"",attrs:{ripple:""},on:{click:function(o){return e.goRol(t.id,!0)}}},[o("v-list-tile-action",[e.itemActive===t.id?o("v-icon",{attrs:{color:"accent"}},[e._v("check_box")]):o("v-icon",[e._v("check_box_outline_blank")])],1),e._v(" "),o("v-list-tile-content",[o("v-list-tile-title",[e._v(e._s(t.nombre))]),e._v(" "),o("v-list-tile-sub-title",[e._v(e._s(t.descripcion))])],1),e._v(" "),o("v-list-tile-action",[e.infoComponent&&e.infoComponent.permisos.agregar?o("v-btn",{attrs:{flat:"",icon:"",color:"orange"},on:{click:function(o){return o.stopPropagation(),e.openPanel(t.id,r,!0)}}},[o("v-icon",[e._v("edit")])],1):e._e()],1)],1)],1),e._v(" "),e.activeRegistros[r]?o("registro-rol",{key:"componente"+r,attrs:{value:t},on:{cancelar:function(o){return e.openPanel(t.id,r,!1)},return:function(t){return e.insertRol(t,r)}}}):e._e()],1)],1)],1)}),1):e._e(),e._v(" "),e.registros?e._e():o("v-progress-linear",{attrs:{indeterminate:!0}}),e._v(" "),e.registros&&0===e.registros.length?o("v-container",{staticClass:"py-0 my-0",attrs:{"grid-list-xl":""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",[o("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n                Lo sentimos, no encontramos roles ("+e._s(this.search)+"). "),o("v-icon",[e._v("sentiment_very_dissatisfied")])],1)],1)],1)],1):e._e(),e._v(" "),o("v-divider")],1),e._v(" "),o("v-flex",{attrs:{sm12:"",md8:e.rol,md12:!e.rol}},[o("div",{attrs:{id:"flag-permisos"}}),e._v(" "),o("v-layout",{attrs:{column:"","justify-center":"",row:"",wrap:""}},[e.rol?o("div",[o("v-subheader",[e._v("Permisos del rol: "),o("strong",[e._v(e._s(e.rol.nombre))])]),e._v(" "),o("v-expansion-panel",{attrs:{focusable:""}},e._l(e.modulos,function(t,r){return o("v-expansion-panel-content",{key:r,attrs:{"hide-actions":""}},[o("v-layout",{attrs:{slot:"header","align-center":"",row:"",spacer:""},slot:"header"},[o("v-flex",{attrs:{xs4:"",sm2:"",md1:""}},[o("v-avatar",{attrs:{slot:"activator",size:"36px"},slot:"activator"},[o("v-icon",{attrs:{color:t.color},domProps:{textContent:e._s("extension")}})],1)],1),e._v(" "),o("v-flex",{attrs:{sm5:"",md3:""}},[o("strong",{domProps:{innerHTML:e._s(t.nombre)}})]),e._v(" "),o("v-flex",{attrs:{"no-wrap":"",xs5:"",sm3:""}},[o("v-chip",{staticClass:"ml-0",attrs:{color:t.color+" lighten-2",label:"",small:""}},[e._v("\n                      "+e._s(t.componentes.length)+" Componentes\n                    ")])],1)],1),e._v(" "),o("v-card",[o("v-divider"),e._v(" "),o("v-card-text",[o("v-list",{staticClass:"pt-0",attrs:{"two-line":""}},[e._l(t.componentes,function(r,s){return[o("v-list-tile",{key:r.id,attrs:{disabled:r.disabled},on:{click:function(e){}}},[o("v-list-tile-action",[r.disabled?o("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):o("v-icon",{attrs:{color:t.color}},[e._v(e._s(r.icono))])],1),e._v(" "),o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{staticClass:"mx-0 px-0 mb-3",attrs:{xs12:"",sm5:"",md3:""}},[o("v-list-tile-content",[o("v-tooltip",{attrs:{top:"",disabled:r.disabled}},[o("v-list-tile-title",{staticClass:"check-title-componente mb-1",attrs:{slot:"activator"},slot:"activator"},[o("v-checkbox",{key:"checkComponente"+s,attrs:{ripple:!1,disabled:r.disabled,"false-value":0,"true-value":1,color:t.color,label:r.nombre},on:{change:function(t){return e.changePermiso(r,1)}},model:{value:r.selectAll,callback:function(t){e.$set(r,"selectAll",t)},expression:"item.selectAll"}})],1),e._v(" "),o("span",[e._v(e._s((r.selectAll?"Deseleccionar":"Seleccionar")+" todos los permisos"))])],1),e._v(" "),o("v-list-tile-sub-title",[e._v(e._s(r.descripcion))])],1)],1),e._v(" "),o("v-flex",{attrs:{xs12:"",sm7:"",md9:""}},[o("v-toolbar",{staticClass:"transparent",attrs:{flat:""}},e._l(r.permisos,function(s,i){return o("v-checkbox",{key:"checkPermiso"+i,attrs:{disabled:r.disabled,color:t.color,"false-value":0,"true-value":1,label:s.propiedad},on:{change:function(t){return e.changePermiso(r,0)}},model:{value:s[s.propiedad],callback:function(t){e.$set(s,s.propiedad,t)},expression:"permiso[permiso.propiedad]"}})}),1)],1)],1)],1),e._v(" "),o("v-divider",{key:"x"+s})]})],2)],1)],1)],1)}),1)],1):e._e()])],1)],1)],1)],1)},s=[],i={render:r,staticRenderFns:s};t.a=i},557:function(e,t,o){"use strict";function r(e){o(1826)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(1075),i=o(1837),n=o(1),a=r,l=n(s.a,i.a,!1,a,null,null);t.default=l.exports}});
//# sourceMappingURL=31.d0b66b44b9ba1ae35516.js.map