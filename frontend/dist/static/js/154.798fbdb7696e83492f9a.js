webpackJsonp([154],{1582:function(e,a,t){var o=t(1583);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(456)("eee449c4",o,!0,{})},1583:function(e,a,t){a=e.exports=t(455)(!0),a.push([e.i,".v-subheader[data-v-1af22f3c]{height:28px}","",{version:3,sources:["/home/capresoca/projects/Capresoca-Frontend/src/components/administrativo/tesoreria/Cajas.vue"],names:[],mappings:"AACA,8BACE,WAAa,CACd",file:"Cajas.vue",sourcesContent:["\n.v-subheader[data-v-1af22f3c] {\n  height: 28px;\n}\n"],sourceRoot:""}])},1584:function(e,a,t){"use strict";var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-dialog",{attrs:{width:"720px"},model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t("v-form",{attrs:{"data-vv-scope":"formCajas"}},[t("v-card",[t("v-card-title",{staticClass:"grey lighten-3 elevation-0"},[t("span",{staticClass:"title"},[e._v(e._s(e.modalTitulo))])]),e._v(" "),t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:5|not_in:"+e.codigosUsados,expression:"'required|max:5|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo",required:"","error-messages":e.errors.collect("codigo")},model:{value:e.caja.codigo,callback:function(a){e.$set(e.caja,"codigo",a)},expression:"caja.codigo"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:150|not_in:"+e.nombresUsados,expression:"'required|max:150|not_in:'  + nombresUsados"}],key:"nombre",attrs:{label:"Nombre",name:"nombre",required:"","error-messages":e.errors.collect("nombre")},model:{value:e.caja.nombre,callback:function(a){e.$set(e.caja,"nombre",a)},expression:"caja.nombre"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.tiposCaja,name:"tipo de caja",label:"Tipo","error-messages":e.errors.collect("tipo de caja"),required:""},model:{value:e.caja.tipo,callback:function(a){e.$set(e.caja,"tipo",a)},expression:"caja.tipo"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:e.menuDate,callback:function(a){e.menuDate=a},expression:"menuDate"}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],attrs:{slot:"activator",label:"Fecha Apertura","prepend-icon":"event",readonly:"",name:"fecha","error-messages":e.errors.collect("fecha")},slot:"activator",model:{value:e.computedDateFormatted,callback:function(a){e.computedDateFormatted=a},expression:"computedDateFormatted"}}),e._v(" "),t("v-date-picker",{attrs:{locale:"es","no-title":"",max:e.maxDate},on:{input:function(a){e.menuDate=!1},change:function(){var a=e.$validator.errors.items.findIndex(function(e){return"fecha"===e.field});e.$validator.errors.items.splice(-1!==a?a:0,-1!==a?1:0)}},model:{value:e.caja.fecha_apertura,callback:function(a){e.$set(e.caja,"fecha_apertura",a)},expression:"caja.fecha_apertura"}})],1)],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|numeric",expression:"'required|numeric'"}],key:"saldoInicial",attrs:{label:"Saldo Inicial",name:"saldoInicial",required:"","error-messages":e.errors.collect("saldoInicial")},model:{value:e.caja.saldo_inicial,callback:function(a){e.$set(e.caja,"saldo_inicial",a)},expression:"caja.saldo_inicial"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("postulador",{ref:"buscarCuenta",attrs:{nodata:"Busqueda por código o nombre.",required:"",hint:"codigo",itemtext:"nombre",datatitle:"codigo",datasubtitle:"nombre",filter:"codigo,nombre",label:"cuenta auxiliar",scope:"formDetalle",entidad:"niifs",routeparams:"nivel:auxiliar=1",preicon:"person",btnplustruncate:"",value:e.caja.niif,clearable:""},on:{click:function(a){return e.openNuevaNiif()},change:function(a){return e.caja.nf_niif_id=a},objectReturn:function(a){return e.caja.niif=a}}})],1),e._v(" "),t("registro-niif",{attrs:{value:e.dialogFormNiif,cue:e.cuentaNiff},on:{cancelar:function(a){e.dialogFormNiif=!1},crear:function(a){return e.goNiif(a)}}}),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Centro de Costo",items:e.complementos.cencostos,"item-value":"id","item-text":"nombre",name:"centro de costo",required:"","error-messages":e.errors.collect("centro de costo"),"return-object":"",clearable:""},on:{change:function(a){return e.caja.nf_cencosto_id=a?a.id:null}},scopedSlots:e._u([{key:"item",fn:function(a){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:e._s(a.item.nombre)}})],1)]]}}]),model:{value:e.caja.cencosto,callback:function(a){e.$set(e.caja,"cencosto",a)},expression:"caja.cencosto"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm6:""}},[t("v-subheader",{staticClass:"pa-0 ma-0"},[e._v("Estado")]),e._v(" "),t("v-switch",{staticClass:"ma-0 pa-0",attrs:{color:"accent",label:e.caja.estado,"true-value":"Activo","false-value":"Inactivo"},model:{value:e.caja.estado,callback:function(a){e.$set(e.caja,"estado",a)},expression:"caja.estado"}})],1)],1)],1),e._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-spacer"),e._v(" "),t("v-btn",{on:{click:e.close}},[e._v("Cancelar")]),e._v(" "),t("v-btn",{attrs:{color:"primary",disabled:e.errors.any()},on:{click:e.save}},[e._v("Guardar")])],1)],1)],1)],1),e._v(" "),t("v-card",[t("toolbar-list",{attrs:{info:e.infoComponent,title:"Cajas",subtitle:"Registro y gestión",btnplus:"",btnplustitle:"Crear Caja",btnplustruncate:""},on:{click:function(a){e.dialog=!0}}}),e._v(" "),t("v-card-title",[t("v-text-field",{attrs:{"append-icon":"search",label:"Buscar","single-line":"","hide-details":"",flat:""},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}})],1),e._v(" "),t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.cajas,loading:e.tableLoading,pagination:e.pagination,"hide-actions":"",search:e.search,"rows-per-page-text":"Registros por página","rows-per-page-items":[10,25,50,{text:"Todos",value:-1}]},on:{"update:pagination":function(a){e.pagination=a}},scopedSlots:e._u([{key:"items",fn:function(a){return[t("td",[e._v(e._s(a.item.codigo))]),e._v(" "),t("td",[e._v(e._s(a.item.nombre))]),e._v(" "),t("td",[e._v(e._s(a.item.tipo))]),e._v(" "),t("td",[e._v(e._s(a.item.estado))]),e._v(" "),t("td",[e._v(e._s(a.item.fecha_apertura))]),e._v(" "),t("td",[e._v(e._s(a.item.saldo_inicial))]),e._v(" "),t("td",[e._v(e._s(a.item.niif.nombre))]),e._v(" "),t("td",[e._v(e._s(a.item.cencosto.nombre))]),e._v(" "),t("td",{staticClass:"text-xs-center"},[t("v-tooltip",{attrs:{top:""}},[t("v-btn",{staticClass:"mx-0",attrs:{slot:"activator",icon:""},on:{click:function(t){return e.edit(a.item)}},slot:"activator"},[t("v-icon",{attrs:{color:"accent"}},[e._v("edit")])],1),e._v(" "),t("span",[e._v("Editar")])],1)],1)]}},{key:"pageText",fn:function(a){return[e._v("\n        "+e._s(a.pageStart)+" - "+e._s(a.pageStop)+" de "+e._s(a.itemsLength)+"\n      ")]}}])},[e._v(" "),t("template",{slot:"no-data"},[e.tableLoading?t("v-alert",{attrs:{value:!0,color:"error",icon:"warning"}},[e._v("\n          Lo sentimos, no tenemos registros para mostrar. "),t("v-icon",[e._v("sentiment_very_dissatisfied")])],1):t("v-alert",{attrs:{value:!0,color:"info",icon:"info"}},[e._v("\n          Estamos cargando los registros. "),t("v-icon",[e._v("sentiment_satisfied_alt")])],1)],1),e._v(" "),e._v(" "),t("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[e._v('\n        No se encontraron resultados de "'+e._s(e.search)+'"\n      ')])],2),e._v(" "),t("v-card-actions",{staticClass:"text-xs-center pt-2 d-block"},[t("v-pagination",{attrs:{length:e.pages},model:{value:e.pagination.page,callback:function(a){e.$set(e.pagination,"page",a)},expression:"pagination.page"}})],1)],1)],1)},i=[],n={render:o,staticRenderFns:i};a.a=n},508:function(e,a,t){"use strict";function o(e){t(1582)}Object.defineProperty(a,"__esModule",{value:!0});var i=t(993),n=t(1584),s=t(1),r=o,c=s(i.a,n.a,!1,r,"data-v-1af22f3c",null);a.default=c.exports},993:function(e,a,t){"use strict";var o=t(13),i=t.n(o),n=t(14),s=t.n(n),r=t(249),c=t.n(r),l=t(7),d=t.n(l),u=t(12),m=t(59);a.a={name:"cajas",components:{RegistroNiif:function(){return t.e(0).then(t.bind(null,457))},Postulador:function(){return t.e(287).then(t.bind(null,747))},ToolbarList:function(){return new Promise(function(e){e()}).then(t.bind(null,247))}},data:function(){return{cajas:[],caja:{},search:"",dialog:!1,tableLoading:!1,pagination:{},tiposCaja:["Mayor","Menor"],menuDate:!1,maxDate:this.moment().format("YYYY-MM-DD"),codigosUsados:"",nombresUsados:"",dialogFormNiif:!1,cuentaNiff:null,headers:[{text:"Código",align:"left",sortable:!1,value:"codigo"},{text:"Nombre",align:"left",sortable:!1,value:"nombre"},{text:"Tipo",align:"left",sortable:!1,value:"tipo"},{text:"Estado",align:"left",sortable:!1,value:"estado"},{text:"Fecha Apertura",align:"left",sortable:!1,value:"fechaApertura"},{text:"Saldo Inicial",align:"left",sortable:!1,value:"saldoInicial"},{text:"Cuenta NIIF",align:"left",sortable:!1,value:"cuentaNIIF"},{text:"Centro de Costos",align:"left",sortable:!1,value:"centroDeCostos"},{text:"Opciones",align:"center",sortable:!1,value:"id"}]}},beforeMount:function(){this.formReset()},mounted:function(){var e={custom:{codigo:{not_in:"Este código ya fue registrado."},nombre:{not_in:"Este nombre ya fue registrado."}}};this.$validator.localize("es",e)},beforeCreate:function(){var e=this;this.tableLoading=!0,this.axios.get("cajas").then(function(a){e.cajas=a.data.data,e.pagination.totalItems=e.cajas.length,e.tableLoading=!1,e.codigosUsados=e.getCodigosUsados(),e.nombresUsados=e.getNombresUsados()}).catch(function(e){return console.log("Hay un error. "+e),!1})},computed:{complementos:function(){return m.b.getters.complementosFormComDiario},infoComponent:function(){return this.$store.getters.getInfoComponent("cajas")},modalTitulo:function(){return this.caja.id?"Edición de la caja: "+this.caja.nombre:"Nueva Caja"},pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.pagination.totalItems/this.pagination.rowsPerPage)},computedDateFormatted:function(){return this.formDate(this.caja.fecha_apertura)}},methods:{formReset:function(){this.caja={id:"",codigo:null,nombre:null,tipo:null,estado:"Inactivo",fecha_apertura:null,saldo_inicial:null,nf_niif_id:null,nf_cencosto_id:null,niif:null,cencosto:null},this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},edit:function(e){this.dialog=!0,this.caja=JSON.parse(d()(e)),this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},close:function(){this.dialog=!1,this.formReset(),this.$validator.reset()},getCodigosUsados:function(){var e=this;return this.cajas.map(function(a){if(null==e.caja.codigo||e.caja.codigo!==a.codigo)return a.codigo})},getNombresUsados:function(){var e=this;return this.cajas.map(function(a){if(null==e.caja.nombre||e.caja.nombre!==a.nombre)return a.nombre})},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},formDate:function(e){if(!e)return null;var a=e.split("-"),t=c()(a,3);return t[0]+"/"+t[1]+"/"+t[2]},openNuevaNiif:function(){this.dialogFormNiif=!0},goNiif:function(e){console.log("GoVal",e),this.caja.niif=e,this.dialogFormNiif=!1},save:function(){var e=this;return s()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.validador("formCajas");case 2:if(!a.sent){a.next=7;break}t=e.caja.id?e.axios.put("cajas/"+e.caja.id,e.caja):e.axios.post("cajas",e.caja),t.then(function(a){e.caja.id?(e.$store.commit(u.b,{msg:"La caja se actualizó correctamente",color:"success"}),e.cajas.splice(e.cajas.findIndex(function(e){return e.id===a.data.data.id}),1,a.data.data)):(e.$store.commit(u.b,{msg:"La caja se creó correctamente",color:"success"}),e.cajas.splice(0,0,a.data.data)),e.dialog=!1,e.close()}).catch(function(a){e.$store.commit(u.b,{msg:"Hay un error al guardar el registro. "+a.response,color:"danger"})}),a.next=8;break;case 7:e.$store.commit(u.b,{msg:"Los campos no pueden estar vacios.",color:"danger"});case 8:case"end":return a.stop()}},a,e)}))()}}}}});
//# sourceMappingURL=154.798fbdb7696e83492f9a.js.map