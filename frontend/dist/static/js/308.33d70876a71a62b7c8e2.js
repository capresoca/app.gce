webpackJsonp([308],{851:function(i,e,a){"use strict";var t=a(12),r=a(905);e.a={name:"RegistroBeneficiarios",props:["value","rootPath"],inject:{$validator:"$validator"},data:function(){return{dialogBorrarBeneficiario:!1,showFormBeneficiario:!1,beneficiario:null}},components:{RegistroBeneficiario:r.a},watch:{showFormBeneficiario:function(i){!1===i&&(this.beneficiario=null)}},computed:{property:function(){switch(this.rootPath){case"formtrasmovs":return"as_formtrasmov_id";case"formafiliaciones":return"as_formafiliacion_id"}}},methods:{asignarBeneficiario:function(i){this.showFormBeneficiario=!0,this.beneficiario=i,this.$vuetify.goTo("#form-beneficiario")},confirmaBorrarBeneficiario:function(i){this.beneficiario=i,this.dialogBorrarBeneficiario=!0},cancelarBorrarBeneficiario:function(){var i=this;this.dialogBorrarBeneficiario=!1,setTimeout(function(){i.beneficiario=null},400)},borrarBeneficiario:function(){var i=this;this.axios.delete("/beneficiarios/"+this.beneficiario.id).then(function(e){if(200===e.status){var a=i.value.nucleo_familiar.findIndex(function(e){return e.id===i.beneficiario.id});i.value.nucleo_familiar.splice(a,1),i.cancelarBorrarBeneficiario()}}).catch(function(e){i.$store.commit(t.a,{expression:" al intentar desvincular el beneficiario. ",error:e})})},returnBeneficiario:function(i){var e=this.value.nucleo_familiar.findIndex(function(e){return e.id===i.id});this.value.nucleo_familiar.splice(-1===e?0:e,-1===e?0:1,i),this.showFormBeneficiario=!1}}}},852:function(i,e,a){"use strict";var t=a(7),r=a.n(t),n=a(23),o=a.n(n),s=a(59),c=a(12),l=a(251);e.a={props:["entidad","afitramiteid","objeto","property","afilliatum"],name:"RegistroBeneficiario",components:{PostuladorV2:function(){return new Promise(function(i){i()}).then(a.bind(null,61))}},data:function(){return{detalleAfiliado:function(){return a.e(290).then(a.bind(null,750))},title:"",loading:!1,nucfamiliar:{},ipsB:{nombre_razon_social:null,identificacion:null},idAfiliadoValido:null,make:{as_beneficiario_id:null,as_formafiliacion_id:null,as_formtrasmov_id:null,as_parentesco_id:null,beneficiario:null,id:null,ips:null,parentesco:null,rs_entidade_id:null,upc:null}}},watch:{objeto:function(i){i?this.asignaObjeto(i):this.reset()}},computed:{complementos:function(){return s.b.getters.complementosFormBeneficiario}},beforeMount:function(){l.a.extend("beneficiarioValido",{validate:function(i){return new o.a(function(e){if(null!==i&&void 0!==i&&""!==i){var a={valido:!0,mensaje:null};return e({valid:a.valido,data:{message:a.mensaje}})}})},getMessage:function(i,e,a){return a.message}})},mounted:function(){console.log(this.entidad,this.afitramiteid,this.objeto,this.property),this.reset(),this.objeto&&this.asignaObjeto(this.objeto)},methods:{asignaObjeto:function(i){this.idAfiliadoValido=JSON.parse(r()(i.beneficiario.id)),this.nucfamiliar=JSON.parse(r()(i))},asignaIPS:function(i){this.nucfamiliar.rs_entidade_id=i.id,this.nucfamiliar.ips=i},reset:function(){this.idAfiliadoValido=null,this.$validator.reset(),this.nucfamiliar=JSON.parse(r()(this.make)),this.ipsB=this.nucfamiliar.ips,void 0!==this.entidad&&this.entidad.id&&this.asignaIPS(this.entidad),this.afitramiteid&&(this.nucfamiliar[this.property]=this.afitramiteid)},submit:function(){var i=this;this.$validator.validateAll("formBeneficiario").then(function(e){e&&(delete i.nucfamiliar.beneficiario,delete i.nucfamiliar.ips,delete i.nucfamiliar.parentesco,i.axios.post("/beneficiarios",i.nucfamiliar).then(function(e){i.$emit("registrar",e.data.nucfamiliar)}).catch(function(e){i.$store.commit(c.a,{expression:" al registrar el beneficiario. ",error:e})}))})}}}},902:function(i,e,a){"use strict";function t(i){a(903)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(851),n=a(909),o=a(1),s=t,c=o(r.a,n.a,!1,s,"data-v-20fa1628",null);e.default=c.exports},903:function(i,e,a){var t=a(904);"string"==typeof t&&(t=[[i.i,t,""]]),t.locals&&(i.exports=t.locals);a(456)("28f7f253",t,!0,{})},904:function(i,e,a){e=i.exports=a(455)(!0),e.push([i.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroBeneficiarios.vue",sourceRoot:""}])},905:function(i,e,a){"use strict";function t(i){a(906)}var r=a(852),n=a(908),o=a(1),s=t,c=o(r.a,n.a,!1,s,"data-v-40a28bec",null);e.a=c.exports},906:function(i,e,a){var t=a(907);"string"==typeof t&&(t=[[i.i,t,""]]),t.locals&&(i.exports=t.locals);a(456)("3dc28d38",t,!0,{})},907:function(i,e,a){e=i.exports=a(455)(!0),e.push([i.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroBeneficiario.vue",sourceRoot:""}])},908:function(i,e,a){"use strict";var t=function(){var i=this,e=i.$createElement,a=i._self._c||e;return a("v-card",{attrs:{color:"blue lighten-4"}},[a("v-card-title",[a("strong",[i._v("\n        "+i._s(i.nucfamiliar.id?"actualización beneficiario":"nuevo beneficiario")+"\n      ")])]),i._v(" "),a("v-divider"),i._v(" "),a("v-container",{attrs:{fluid:"","grid-list-lg":""}},[a("v-form",{attrs:{"data-vv-scope":"formBeneficiario"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required|beneficiarioValido",expression:"'required|beneficiarioValido'"}],attrs:{"no-data":"Busqueda por nombre o número de documento.",hint:"identificacion_completa","item-text":"nombre_completo","data-title":"identificacion_completa","data-subtitle":"nombre_completo",label:"Beneficiario",detail:i.detalleAfiliado,entidad:"afiliados",preicon:"person",name:"Beneficiario",rules:"required|beneficiarioValido","error-messages":i.errors.collect("Beneficiario"),"slot-append":{template:'<span class="pt-2 caption">Estado: {{value.estado_afiliado.codigo}} - {{value.estado_afiliado.nombre}}</span>',props:["value"]},"slot-prepend":i.nucfamiliar.beneficiario?{template:'<mini-card-detail :data="value.mini_afiliado" alone-icon/>',props:["value"]}:null,"pros-datos":i.afilliatum?i.afilliatum:null},on:{changeid:function(e){return i.nucfamiliar.as_beneficiario_id=e}},model:{value:i.nucfamiliar.beneficiario,callback:function(e){i.$set(i.nucfamiliar,"beneficiario",e)},expression:"nucfamiliar.beneficiario"}})],1),i._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Parentesco",items:i.complementos.parentescos,"item-value":"id","item-text":"nombre",name:"Parentesco",required:"","error-messages":i.errors.collect("Parentesco")},model:{value:i.nucfamiliar.as_parentesco_id,callback:function(e){i.$set(i.nucfamiliar,"as_parentesco_id",e)},expression:"nucfamiliar.as_parentesco_id"}})],1),i._v(" "),a("v-flex",{attrs:{xs12:"",sm6:""}},[a("postulador-v2",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"no-data":"Busqueda por NIT, razon social u código de habilitación.",hint:"identificacion","item-text":"nombre_razon_social","data-title":"identificacion","data-subtitle":"nombre_razon_social",label:"IPS",entidad:"entidades_contrato",preicon:"location_city",name:"ips",rules:"required","error-messages":i.errors.collect("ips"),"route-params":"rs_tipentidade_id=1&afiliado="+i.nucfamiliar.as_beneficiario_id,"no-btn-create":"","min-characters-search":3},on:{changeid:function(e){return i.nucfamiliar.rs_entidade_id=e}},model:{value:i.ipsB,callback:function(e){i.ipsB=e},expression:"ipsB"}})],1)],1)],1)],1),i._v(" "),a("v-card-actions",[a("v-spacer"),i._v(" "),a("v-btn",{attrs:{flat:""},nativeOn:{click:function(e){return i.$emit("cancelar")}}},[i._v("Cancelar")]),i._v(" "),a("v-btn",{attrs:{flat:"",color:"primary"},nativeOn:{click:function(e){return i.submit(e)}}},[i._v("Registrar")])],1)],1)},r=[],n={render:t,staticRenderFns:r};e.a=n},909:function(i,e,a){"use strict";var t=function(){var i=this,e=i.$createElement,a=i._self._c||e;return i.value?a("v-card",{staticClass:"ma-0 pa-0",attrs:{color:"grey lighten-1"}},[a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"400"},model:{value:i.dialogBorrarBeneficiario,callback:function(e){i.dialogBorrarBeneficiario=e},expression:"dialogBorrarBeneficiario"}},[i.beneficiario?a("v-card",[a("v-card-text",{staticClass:"title font-weight-light"},[i._v("\n          ¿Esta seguro de desvincular a "),a("strong",[i._v(i._s(i.beneficiario.beneficiario.nombre_completo))]),i._v(" de su lista de beneficiarios.?\n        ")]),i._v(" "),a("v-card-actions",[a("v-spacer"),i._v(" "),a("v-btn",{attrs:{flat:""},on:{click:i.cancelarBorrarBeneficiario}},[i._v("Cancelar")]),i._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){return e.stopPropagation(),i.borrarBeneficiario(e)}}},[i._v("Aceptar")])],1)],1):i._e()],1)],1),i._v(" "),a("v-toolbar",{attrs:{dense:""}},[a("v-icon",[i._v("face")]),i._v(" "),a("v-toolbar-title",[i._v("Beneficiarios registrados")]),i._v(" "),a("v-spacer"),i._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",fab:"",right:"",small:"",color:"accent"},nativeOn:{click:function(e){return i.asignarBeneficiario(null)}},slot:"activator"},[a("v-icon",[i._v("add")])],1),i._v(" "),a("span",[i._v("Agregar beneficiario")])],1)],1),i._v(" "),a("v-slide-y-transition",[i.showFormBeneficiario?a("registro-beneficiario",{ref:"rBeneficiario",attrs:{property:i.property,entidad:i.value.ips,afilliatum:i.value.afiliado,afitramiteid:i.value.id,objeto:i.beneficiario},on:{cancelar:function(e){i.showFormBeneficiario=!1},registrar:function(e){return i.returnBeneficiario(e)}}}):i._e()],1),i._v(" "),a("v-list",{attrs:{"two-line":"",subheader:""}},[i.value.nucleo_familiar&&0===i.value.nucleo_familiar.length?a("v-subheader",{attrs:{inset:""}},[i._v("Sin beneficiarios")]):i._l(i.value.nucleo_familiar,function(e,t){return[a("v-divider",{attrs:{inset:""}}),i._v(" "),a("v-list-tile",{key:t,attrs:{avatar:""}},[a("v-list-tile-avatar",{attrs:{color:"primary"}},[a("span",{staticClass:"white--text headline"},[i._v(i._s(t+1))])]),i._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:i._s(e.beneficiario.nombre_completo)}}),i._v(" "),a("v-list-tile-sub-title",{domProps:{innerHTML:i._s(e.beneficiario.identificacion_completa+" - "+e.parentesco.nombre)}})],1),i._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",small:"",ripple:"",icon:""},on:{click:function(a){return i.asignarBeneficiario(e)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[i._v("mode_edit")])],1),i._v(" "),a("span",[i._v("Editar")])],1),i._v(" "),a("v-tooltip",{attrs:{top:""}},[a("v-btn",{attrs:{slot:"activator",small:"",icon:"",ripple:""},on:{click:function(a){return i.confirmaBorrarBeneficiario(e)}},slot:"activator"},[a("v-icon",{attrs:{color:"accent"}},[i._v("close")])],1),i._v(" "),a("span",[i._v("Desvincular")])],1)],1)]})],2)],1):i._e()},r=[],n={render:t,staticRenderFns:r};e.a=n}});
//# sourceMappingURL=308.33d70876a71a62b7c8e2.js.map