webpackJsonp([151],{1588:function(e,a,t){var n=t(1589);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t(456)("f56f8af6",n,!0,{})},1589:function(e,a,t){a=e.exports=t(455)(!0),a.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"RegistroCuentaBancaria.vue",sourceRoot:""}])},1590:function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.dialogConfirm,callback:function(a){e.dialogConfirm=a},expression:"dialogConfirm"}},[t("v-card",[t("v-card-title",{staticClass:"headline grey lighten-3"},[e._v("Alerta")]),e._v(" "),t("v-card-text",[e._v("¿Está seguro que desea eliminar este registro?")]),e._v(" "),t("v-card-actions",[t("v-spacer"),e._v(" "),t("v-btn",{attrs:{color:"green darken-1",flat:""},nativeOn:{click:function(a){e.dialogConfirm=!1}}},[e._v("Cancelar")]),e._v(" "),t("v-btn",{attrs:{color:"primary",flat:""},nativeOn:{click:function(a){return e.eliminarDetalle(a)}}},[e._v("Aceptar")])],1)],1)],1),e._v(" "),t("v-card",{ref:"formCuentaBancaria"},[t("v-toolbar",{staticClass:"grey lighten-3 elevation-0 toolbar--dense"},[t("v-toolbar-title",[e._v(" "+e._s(e.tapTitulo)+" ")])],1),e._v(" "),t("v-container",{staticStyle:{"max-width":"inherit"},attrs:{"grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:""}},[t("v-form",{attrs:{"data-vv-scope":"formCuentasBancarias"}},[t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|max:5|not_in:"+e.codigosUsados,expression:"'required|max:5|not_in:' + codigosUsados"}],key:"codigo",attrs:{label:"Código",name:"codigo",required:"","error-messages":e.errors.collect("codigo"),disabled:!!e.cuentaBancaria.id},model:{value:e.cuentaBancaria.codigo,callback:function(a){e.$set(e.cuentaBancaria,"codigo",a)},expression:"cuentaBancaria.codigo"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Entidad bancaria",items:e.complementosBanco.bancos,"item-value":"id","item-text":"nombre",name:"Entidad bancaria",required:"","error-messages":e.errors.collect("Entidad bancaria")},scopedSlots:e._u([{key:"item",fn:function(a){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:e._s(a.item.nombre)}}),e._v(" "),t("v-list-tile-sub-title",{domProps:{innerHTML:e._s(a.item.codigo)}})],1)]]}}]),model:{value:e.cuentaBancaria.ts_banco_id,callback:function(a){e.$set(e.cuentaBancaria,"ts_banco_id",a)},expression:"cuentaBancaria.ts_banco_id"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Ciudad Origen",items:e.complementos.municipios,"item-value":"id","item-text":"nombre",name:"Ciudad Origen",required:"","error-messages":e.errors.collect("Ciudad Origen"),filter:e.filterMunicipios},scopedSlots:e._u([{key:"item",fn:function(a){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:e._s(a.item.nombre)}}),e._v(" "),t("v-list-tile-sub-title",{domProps:{innerHTML:e._s(a.item.nombre_departamento)}})],1)]]}}]),model:{value:e.cuentaBancaria.gn_municipio_id,callback:function(a){e.$set(e.cuentaBancaria,"gn_municipio_id",a)},expression:"cuentaBancaria.gn_municipio_id"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],key:"numeroDeCuenta",attrs:{label:"Número de cuenta",name:"Numero de cuenta",required:"","error-messages":e.errors.collect("Numero de cuenta")},model:{value:e.cuentaBancaria.numero_cuenta,callback:function(a){e.$set(e.cuentaBancaria,"numero_cuenta",a)},expression:"cuentaBancaria.numero_cuenta"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-menu",{ref:"menuDate",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","max-width":"290px","min-width":"290px"},model:{value:e.menuDate,callback:function(a){e.menuDate=a},expression:"menuDate"}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|date_format:YYYY/MM/DD",expression:"'required|date_format:YYYY/MM/DD'"}],attrs:{slot:"activator",label:"Fecha Apertura","prepend-icon":"event",readonly:"",name:"fecha","error-messages":e.errors.collect("fecha")},slot:"activator",model:{value:e.computedDateFormatted,callback:function(a){e.computedDateFormatted=a},expression:"computedDateFormatted"}}),e._v(" "),t("v-date-picker",{attrs:{locale:"es","no-title":"",max:e.maxDate},on:{input:function(a){e.menuDate=!1},change:function(){var a=e.$validator.errors.items.findIndex(function(e){return"fecha"===e.field});e.$validator.errors.items.splice(-1!==a?a:0,-1!==a?1:0)}},model:{value:e.cuentaBancaria.fecha_apertura,callback:function(a){e.$set(e.cuentaBancaria,"fecha_apertura",a)},expression:"cuentaBancaria.fecha_apertura"}})],1)],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|numeric",expression:"'required|numeric'"}],key:"saldoInicial",attrs:{label:"Saldo Inicial",name:"saldoInicial",required:"","error-messages":e.errors.collect("saldoInicial")},model:{value:e.cuentaBancaria.saldo_inicial,callback:function(a){e.$set(e.cuentaBancaria,"saldo_inicial",a)},expression:"cuentaBancaria.saldo_inicial"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("postulador",{ref:"buscarCuenta",attrs:{nodata:"Busqueda por código o nombre.",required:"",hint:"codigo",itemtext:"nombre",datatitle:"codigo",datasubtitle:"nombre",filter:"codigo,nombre",label:"cuenta auxiliar",scope:"formDetalle",entidad:"niifs",routeparams:"nivel:auxiliar=1",preicon:"person",btnplustruncate:"",value:e.cuentaBancaria.niif,clearable:""},on:{click:function(a){return e.openNuevaNiif()},change:function(a){return e.cuentaBancaria.nf_niif_id=a},objectReturn:function(a){return e.cuentaBancaria.niif=a}}})],1),e._v(" "),t("registro-niif",{attrs:{value:e.dialogFormNiif,cue:e.cuentaNiff},on:{cancelar:function(a){e.dialogFormNiif=!1},crear:function(a){return e.goNiif(a)}}}),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{label:"Centro de Costo",items:e.complementosCentroDeCosto.cencostos,"item-value":"id","item-text":"nombre",name:"centro de costo",required:"","error-messages":e.errors.collect("centro de costo"),"return-object":"",clearable:""},on:{change:function(a){return e.cuentaBancaria.nf_cencosto_id=a?a.id:null}},scopedSlots:e._u([{key:"item",fn:function(a){return[[t("v-list-tile-content",[t("v-list-tile-title",{domProps:{innerHTML:e._s(a.item.nombre)}})],1)]]}}]),model:{value:e.cuentaBancaria.cencosto,callback:function(a){e.$set(e.cuentaBancaria,"cencosto",a)},expression:"cuentaBancaria.cencosto"}})],1),e._v(" "),t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.tiposCuenta,name:"tipo de cuenta",label:"Tipo","error-messages":e.errors.collect("tipo de cuenta"),required:""},model:{value:e.cuentaBancaria.tipo_cuenta,callback:function(a){e.$set(e.cuentaBancaria,"tipo_cuenta",a)},expression:"cuentaBancaria.tipo_cuenta"}})],1),e._v(" "),e.cuentaBancaria.id?t("v-flex",{attrs:{xs12:"",sm4:"",md4:""}},[t("v-subheader",{staticClass:"pa-0 ma-0"},[e._v("Estado")]),e._v(" "),t("v-switch",{staticClass:"ma-0 pa-0",attrs:{color:"accent",label:e.cuentaBancaria.estado,"true-value":"Activo","false-value":"Inactivo"},model:{value:e.cuentaBancaria.estado,callback:function(a){e.$set(e.cuentaBancaria,"estado",a)},expression:"cuentaBancaria.estado"}})],1):e._e()],1)],1)],1)],1)],1)],1),e._v(" "),t("v-divider"),e._v(" "),t("v-card-actions",{staticClass:"grey lighten-4"},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{staticClass:"text-xs-left",attrs:{xs6:""}},[t("v-btn",{attrs:{loading:e.loadingSubmit},on:{click:e.formReset}},[e._v("Limpiar")])],1),e._v(" "),t("v-flex",{staticClass:"text-xs-right",attrs:{xs6:""}},[t("v-btn",{on:{click:function(a){return e.close()}}},[e._v("Cancelar")]),e._v(" "),t("v-btn",{attrs:{color:"primary",loading:e.loadingSubmit,disabled:e.errors.any()},on:{click:function(a){return a.preventDefault(),e.submit(a)}}},[e._v("Guardar")])],1)],1)],1)],1)],1)},i=[],r={render:n,staticRenderFns:i};a.a=r},510:function(e,a,t){"use strict";function n(e){t(1588)}Object.defineProperty(a,"__esModule",{value:!0});var i=t(995),r=t(1590),o=t(1),s=n,c=o(i.a,r.a,!1,s,"data-v-23270cc6",null);a.default=c.exports},995:function(e,a,t){"use strict";var n=t(13),i=t.n(n),r=t(14),o=t.n(r),s=t(249),c=t.n(s),l=t(7),u=t.n(l),d=t(12),m=t(40),v=t(248),f=t(59);a.a={name:"RegistroCuentaBancaria",components:{RegistroNiif:function(){return t.e(0).then(t.bind(null,457))},Postulador:function(){return t.e(287).then(t.bind(null,747))}},props:["parametros"],data:function(){return{cuentasBancarias:[],cuentaBancaria:{},detalle:{},detalleAEliminar:null,tiposCuenta:["Ahorros","Corriente"],controlDeCheques:["Si","No"],estadosConsecutivoCheque:["Activa","Bloqueada","Terminada"],menuDate:!1,maxDate:this.moment().format("YYYY-MM-DD"),codigosUsados:"",nombresUsados:"",dialogFormNiif:!1,cuentaNiff:null,loadingSubmit:!1,tableLoading:!1,dialogConfirm:!1,headers:[{text:"Valor Inicial",align:"left",sortable:!1,value:"valorInicial"},{text:"Valor Final",align:"left",sortable:!1,value:"valorFinal"},{text:"Estado",align:"left",sortable:!1,value:"estado"},{text:"Opciones",align:"center",sortable:!1,value:"id"}]}},beforeMount:function(){this.formReset()},mounted:function(){var e={custom:{codigo:{not_in:"Este código ya fue registrado."},nombre:{not_in:"Este nombre ya fue registrado."}}};this.$validator.localize("es",e),null!==this.parametros.entidad&&this.getRegisto(this.parametros.entidad.id)},beforeCreate:function(){var e=this;this.axios.get("cuentas").then(function(a){e.cuentasBancarias=a.data.data,e.codigosUsados=e.getCodigosUsados(),e.nombresUsados=e.getNombresUsados()}).catch(function(e){return console.log("Hay un error. "+e),!1})},computed:{tapTitulo:function(){return this.cuentaBancaria.id?"Edición de la cuenta: "+this.cuentaBancaria.numero_cuenta:"Nueva Cuenta"},complementos:function(){return JSON.parse(u()(f.b.getters.complementosTercerosFormBasicos))},complementosCentroDeCosto:function(){return f.b.getters.complementosFormComDiario},complementosBanco:function(){return f.b.getters.complementosFormBancos},computedDateFormatted:function(){return this.formDate(this.cuentaBancaria.fecha_apertura)}},methods:{getRegisto:function(e){var a=this,t=this.$loading.show({container:this.$refs.formCuentaBancaria.$el});this.axios.get("cuentas/"+e).then(function(e){""!==e.data&&(a.cuentaBancaria=e.data.data),t.hide()}).catch(function(e){t.hide(),a.$store.commit(d.b,{msg:"Hay un error al traer la Cuenta Bancaria. "+e.response,color:"danger"})})},formReset:function(){this.cuentaBancaria={id:"",ts_banco_id:null,codigo:null,tipo_cuenta:null,estado:"Inactivo",numero_cuenta:null,fecha_apertura:null,saldo_inicial:null,control_auto:null,nf_niif_id:null,nf_cencosto_id:null,gn_municipio_id:null,cheque_inicial:null,cheque_final:null,chequeEstado:null,detalles:[]},this.$validator.reset(),this.codigosUsados=this.getCodigosUsados(),this.nombresUsados=this.getNombresUsados()},formChequesReset:function(){this.detalle={cheque_inicial:null,cheque_final:null,estado:null}},filterMunicipios:function(e,a){var t=function(e){return null!=e?e:""},n=t(e.nombre+" "+e.nombre_departamento),i=t(a);return n.toString().toLowerCase().indexOf(i.toString().toLowerCase())>-1},getCodigosUsados:function(){var e=this;return this.cuentasBancarias.map(function(a){if(null==e.cuentaBancaria.codigo||e.cuentaBancaria.codigo!==a.codigo)return a.codigo})},getNombresUsados:function(){var e=this;return this.cuentasBancarias.map(function(a){if(null==e.cuentaBancaria.nombre||e.cuentaBancaria.nombre!==a.nombre)return a.nombre})},validador:function(e){return this.$validator.validateAll(e).then(function(e){return e})},formDate:function(e){if(!e)return null;var a=e.split("-"),t=c()(a,3);return t[0]+"/"+t[1]+"/"+t[2]},openNuevaNiif:function(){this.dialogFormNiif=!0},goNiif:function(e){this.cuentaBancaria.niif=e,this.dialogFormNiif=!1},close:function(){this.formReset(),this.$validator.reset(),this.$store.dispatch(m.c,{contexto:this,itemId:this.parametros.tabOrigin})},cargarDetalleAEliminar:function(e){this.dialogConfirm=!0,this.detalleAEliminar=e},eliminarDetalle:function(){this.cuentaBancaria.detalles.splice(this.detalleAEliminar,1),this.dialogConfirm=!1},agregarDetalle:function(e){var a=this;return o()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.validador("formRango");case 2:if(!t.sent){t.next=8;break}a.cuentaBancaria.detalles.push(e),a.$validator.reset(),a.formChequesReset(),t.next=9;break;case 8:a.$store.commit(d.b,{msg:"Hay un error al registrar el rango",color:"danger"});case 9:case"end":return t.stop()}},t,a)}))()},submit:function(){var e=this;return o()(i.a.mark(function a(){var t,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.validador("formCuentasBancarias");case 2:if(!a.sent){a.next=7;break}e.loadingSubmit=!0,t=e.cuentaBancaria.id?"editar":"crear",n=e.cuentaBancaria.id?e.axios.put("cuentas/"+e.cuentaBancaria.id,e.cuentaBancaria):e.axios.post("cuentas",e.cuentaBancaria),n.then(function(a){e.cuentaBancaria.id?(e.$store.commit(d.b,{msg:"Cuenta actualizada satisfactoriamente",color:"success"}),e.$store.commit(v.z,{item:a.data.data,estado:t,key:e.parametros.key}),e.$store.dispatch(m.c,{contexto:e,itemId:e.parametros.tabOrigin})):(e.$store.commit(d.b,{msg:"Cuenta creada satisfactoriamente",color:"success"}),e.$store.commit(v.z,{item:a.data.data,estado:t,key:e.parametros.key}),e.$store.dispatch(m.c,{contexto:e,itemId:e.parametros.tabOrigin}))}).catch(function(a){e.loadingSubmit=!1,e.$store.commit(d.b,{msg:"Hay un error al guardar el registro. "+a.response,color:"danger"})});case 7:case"end":return a.stop()}},a,e)}))()}}}}});
//# sourceMappingURL=151.4dc2e96673e3c5cc92fc.js.map