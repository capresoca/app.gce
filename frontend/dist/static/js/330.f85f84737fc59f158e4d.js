webpackJsonp([330],{1294:function(a,e,t){"use strict";var s=t(8),o=t.n(s),i=t(6);e.a={name:"EnvioCuentas",props:{value:{type:Array,default:[]}},data:function(){return{loading:!1,dialog:{show:!1,accion:null,observaciones:null}}},watch:{"dialog.show":function(a){var e=this;a||setTimeout(function(){e.resetDialog()},400)}},computed:o()({},Object(i.c)({currentUser:function(a){return a.user.profile}}),{accesoAuditoria:function(){return!!(this.currentUser&&this.currentUser.roles&&this.currentUser.roles.find(function(a){return 1===a.id||41===a.id||48===a.id||39===a.id}))},accesoContabilidad:function(){return this.currentUser&&this.currentUser.roles&&this.currentUser.roles.find(function(a){return 1===a.id||24===a.id||25===a.id})},accesoCxP:function(){return this.currentUser&&this.currentUser.roles&&this.currentUser.roles.find(function(a){return 1===a.id||24===a.id||25===a.id})},accesoTesoreria:function(){return this.currentUser&&this.currentUser.roles&&this.currentUser.roles.find(function(a){return 1===a.id||22===a.id||23===a.id})},errorEstado:function(){if(this&&this.value&&this&&this.value.length){var a=this.lodash.uniqBy(this.value,"estadolote.estado");return 1===a.length&&1===this.lodash.uniq(this.value.filter(function(e){return e.estadolote.estado===a[0].estadolote.estado}).map(function(a){return a.estadolote.aceptado})).length?"":"El estado debe ser el mismo para los items seleccionados"}return""},accionesDisponibles:function(){if(this&&this.value&&this.value.length){var a=[];switch(this.value[0].estadolote.estado){case"Radicado":this.accesoAuditoria&&a.push({color:"error",title:"Devolver",icon:"fas fa-backward",text:"¿Esta seguro de hacer la devolución de las cuentas seleccionadas?",data:{ids:[],descripcion:null,cm_estadosrad_id:7,aceptado:1}});break;case"Auditoria":this.accesoAuditoria&&a.push({color:"white",title:"Enviar a contabilidad",icon:"fas fa-paper-plane",text:"¿Esta seguro de enviar las cuentas seleccionadas a contabilidad?",data:{ids:[],descripcion:null,cm_estadosrad_id:3,aceptado:3}});break;case"Contabilidad":this.accesoContabilidad&&"1"!==this.value[0].estadolote.aceptado?(a.push({color:"error",title:"Devolver a auditoría",icon:"fas fa-arrow-circle-left",text:"¿Esta seguro de hacer la devolución de las cuentas seleccionadas a Auditoría?",data:{ids:[],descripcion:null,cm_estadosrad_id:2,aceptado:1}}),a.push({color:"white",title:"Aceptar en contabilidad",icon:"fas fa-thumbs-up",text:"¿Esta seguro de aceptar las cuentas seleccionadas en contabilidad?",data:{ids:[],descripcion:null,cm_estadosrad_id:3,aceptado:1}})):"1"===this.value[0].estadolote.aceptado&&a.push({color:"white",title:"Enviar a CxP",icon:"fas fa-paper-plane",text:"¿Esta seguro de enviar las cuentas seleccionadas a cuentas por pagar?",data:{ids:[],descripcion:null,cm_estadosrad_id:8,aceptado:3}});break;case"CXP":this.accesoCxP&&"1"!==this.value[0].estadolote.aceptado?(a.push({color:"error",title:"Devolver a contabilidad",icon:"fas fa-arrow-circle-left",text:"¿Esta seguro de hacer la devolución de las cuentas seleccionadas a Contabilidad?",data:{ids:[],descripcion:null,cm_estadosrad_id:3,aceptado:1}}),a.push({color:"white",title:"Aceptar en CxP",icon:"fas fa-thumbs-up",text:"¿Esta seguro de aceptar las cuentas seleccionadas en cuentas por pagar?",data:{ids:[],descripcion:null,cm_estadosrad_id:8,aceptado:1}})):"1"===this.value[0].estadolote.aceptado&&a.push({color:"white",title:"Enviar a tesorería",icon:"fas fa-paper-plane",text:"¿Esta seguro de enviar las cuentas seleccionadas a tesorería?",data:{ids:[],descripcion:null,cm_estadosrad_id:4,aceptado:3}});break;case"Tesoreria":this.accesoTesoreria&&"1"!==this.value[0].estadolote.aceptado?(a.push({color:"error",title:"Devolver a CxP",icon:"fas fa-arrow-circle-left",text:"¿Esta seguro de hacer la devolución de las cuentas seleccionadas a cuentas por pagar?",data:{ids:[],descripcion:null,cm_estadosrad_id:8,aceptado:1}}),a.push({color:"white",title:"Aceptar en tesorería",icon:"fas fa-thumbs-up",text:"¿Esta seguro de aceptar las cuentas seleccionadas en tesorería?",data:{ids:[],descripcion:null,cm_estadosrad_id:4,aceptado:1}})):"1"===this.value[0].estadolote.aceptado&&a.push({color:"white",title:"Pagado",icon:"fas fa-file-invoice-dollar",text:"¿Esta seguro de marcar las cuentas seleccionadas como pagas?",data:{ids:[],descripcion:null,cm_estadosrad_id:5,aceptado:1}})}return a}return[]}}),methods:{confirmar:function(a){this.dialog.accion=a,this.dialog.show=!0},enviar:function(a){var e=this;a.ids=this.value.map(function(a){return a.id}),a.descripcion=this.dialog.observaciones,this.loading=!0,this.axios.post("cm_radcambios",a).then(function(a){e.$store.commit("reloadTable","tableCuentasMedicas"),e.$emit("enviado"),e.dialog.show=!1,e.loading=!1}).catch(function(){e.loading=!1,e.$store.commit("SNACK_SHOW",{msg:"Error al enviar los datos de las cuentas seleccionadas.",color:"danger"})})},resetDialog:function(){this.dialog.show=!1,this.dialog.accion=null,this.dialog.observaciones=null}}}},2455:function(a,e,t){"use strict";function s(a){t(2456)}Object.defineProperty(e,"__esModule",{value:!0});var o=t(1294),i=t(2458),r=t(1),c=s,n=r(o.a,i.a,!1,c,"data-v-2fe0d619",null);e.default=n.exports},2456:function(a,e,t){var s=t(2457);"string"==typeof s&&(s=[[a.i,s,""]]),s.locals&&(a.exports=s.locals);t(456)("406dd22a",s,!0,{})},2457:function(a,e,t){e=a.exports=t(455)(!0),e.push([a.i,"","",{version:3,sources:[],names:[],mappings:"",file:"EnvioCuentas.vue",sourceRoot:""}])},2458:function(a,e,t){"use strict";var s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("v-bottom-nav",{attrs:{mandatory:"",fixed:"",dark:"",color:a.errorEstado?"error":"blue",value:a.value.length}},[t("v-list-tile",{staticClass:"white--text"},[t("v-list-tile-content",[t("v-list-tile-title",{staticClass:"title"},[a._v("Cuentas seleccionadas: "),t("strong",[a._v(a._s(a.value.length))])]),a._v(" "),a.value.length?t("v-list-tile-title",[a._v("estado: "+a._s(a.errorEstado||a.value[0].estadolote.estado))]):a._e()],1)],1),a._v(" "),a.errorEstado?a._e():[a._l(a.accionesDisponibles,function(e,s){return[t("v-divider",{attrs:{vertical:""}}),a._v(" "),t("v-btn",{key:"btn"+s,attrs:{dark:""},on:{click:function(t){return t.stopPropagation(),a.confirmar(e)}}},[t("span",{class:e.color+"--text"},[a._v(a._s(e.title))]),a._v(" "),t("v-icon",{attrs:{color:e.color}},[a._v(a._s(e.icon))])],1)]})]],2),a._v(" "),t("v-dialog",{attrs:{persistent:"","max-width":"320"},model:{value:a.dialog.show,callback:function(e){a.$set(a.dialog,"show",e)},expression:"dialog.show"}},[a.dialog.accion?t("v-card",[t("v-card-title",{staticClass:"headline align-center"},[a._v(a._s(a.dialog.accion.text))]),a._v(" "),t("v-card-text",[t("v-textarea",{attrs:{label:"Observaciones","auto-grow":"",rows:"1"},model:{value:a.dialog.observaciones,callback:function(e){a.$set(a.dialog,"observaciones",e)},expression:"dialog.observaciones"}})],1),a._v(" "),t("v-card-actions",[t("v-spacer"),a._v(" "),t("v-btn",{attrs:{flat:""},on:{click:function(e){a.dialog.show=!1}}},[a._v("Cancelar")]),a._v(" "),t("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(e){return e.stopPropagation(),a.enviar(a.dialog.accion.data)}}},[a._v("\n          Aceptar\n        ")])],1),a._v(" "),t("loading",{model:{value:a.loading,callback:function(e){a.loading=e},expression:"loading"}})],1):a._e()],1)],1)},o=[],i={render:s,staticRenderFns:o};e.a=i}});
//# sourceMappingURL=330.f85f84737fc59f158e4d.js.map