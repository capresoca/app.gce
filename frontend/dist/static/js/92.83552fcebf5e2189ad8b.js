webpackJsonp([92],{1229:function(t,a,o){"use strict";var i=o(7),r=o.n(i),e=o(258),n=o.n(e),s=o(257),l=o.n(s),c=o(13),v=o.n(c),d=o(14),u=o.n(d),p=o(58),h=o(248),b=o(12);a.a={name:"RegistroPlanCobertura",props:["parametros"],components:{Loading:p.default,InputFile:function(){return o.e(288).then(o.bind(null,748))}},data:function(){return{floatMenu:!1,fabMenu:!1,loading:!1,planCoberturaOriginal:null,planCobertura:null,contratoLectura:!1,makePlanCobertura:{id:null,portabilidad:0,estado:"Registrado",ce_proconminuta_id:null,regimen_atendido:null,pr_detrp_id:null,nombre:null,contrato:null,actaInicio:!1},window:0,items:[{props:{icon:"work",avatarColor:"primary",title:"Información básica",subTitle:"Datos básicos de la contrato."},component:function(){return o.e(323).then(o.bind(null,2238))}},{props:{icon:"verified_user",avatarColor:"success",title:"Servicios contratados",subTitle:"Registro de servicios contratados"},component:function(){return o.e(319).then(o.bind(null,2242))}},{props:{icon:"healing",avatarColor:"danger",title:"Procedimientos",subTitle:"Registro de CUPS"},component:function(){return o.e(304).then(o.bind(null,2246))}},{props:{icon:"colorize",avatarColor:"purple",title:"Medicamentos",subTitle:"Registro de CUMS"},component:function(){return o.e(321).then(o.bind(null,2250))}},{props:{icon:"category",avatarColor:"orange",title:"Otros bienes y servicios",subTitle:"Otros bienes y servicios"},component:function(){return o.e(320).then(o.bind(null,2254))}},{props:{icon:"settings_input_composite",avatarColor:"accent",title:"Interfaz contable",subTitle:"Configuración interfaz contable"},component:function(){return o.e(322).then(o.bind(null,2258))}}],archivoMasivo:null,makeArchivoMasivo:{loading:!1,visible:!1,index:null,tipo:null,ruta:null,label:null,archivo:null,invalido:{headers:[],items:[]}}}},watch:{"archivoMasivo.visible":function(t){t||this.refreshArchivoMasivo()},"archivoMasivo.archivo":function(){this.archivoMasivo.invalido.headers=[],this.archivoMasivo.invalido.items=[]}},created:function(){var t=this;return u()(v.a.mark(function a(){return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.refresh();case 2:!t.parametros.entidad&&t.parametros.contrato&&(t.planCoberturaOriginal.contrato=t.parametros.contrato,t.planCoberturaOriginal.ce_proconminuta_id=t.parametros.contrato.id,t.planCobertura.contrato=t.parametros.contrato,t.planCobertura.ce_proconminuta_id=t.parametros.contrato.id),null!==t.parametros.entidad&&null!==t.parametros.entidad.id&&t.getRegistro(t.parametros.entidad.id);case 4:case"end":return a.stop()}},a,t)}))()},methods:{submitArchivo:function(){var t=this;return u()(v.a.mark(function a(){var o;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$refs.archivoMasivo.validate();case 2:if(!a.sent){a.next=7;break}t.archivoMasivo.loading=!0,o=new FormData,o.append("archivo",t.archivoMasivo.archivo),t.axios.post("contratos/"+t.planCobertura.id+"/"+t.archivoMasivo.ruta,o).then(function(a){a.data.guardado.length&&t.reloadSection(t.archivoMasivo.index),a.data.invalido.length?(t.archivoMasivo.invalido.headers.push({text:"Fila",align:"left",sortable:!1}),l()(a.data.invalido[0].row).forEach(function(a){t.archivoMasivo.invalido.headers.push({text:a,align:"left",sortable:!1})}),t.archivoMasivo.invalido.headers.push({text:"Error",align:"left",sortable:!1}),a.data.invalido.forEach(function(a){var o=[];o.push(a.fila),n()(a.row).forEach(function(t){o.push(t)}),o.push(window.lodash.flattenDeep(a.errors).join(", ")),t.archivoMasivo.invalido.items.push(o)}),t.$store.commit(b.b,{msg:"El archivo de "+t.archivoMasivo.tipo+" se ha subido con "+a.data.invalido.length+" "+(1===a.data.invalido.length?"registro invalido":"Registros invalidos")+".",color:"warning"}),t.archivoMasivo.loading=!1):(t.$store.commit(b.b,{msg:"El archivo de "+t.archivoMasivo.tipo+" se ha subido correctamente. ",color:"success"}),t.archivoMasivo.visible=!1)}).catch(function(a){t.archivoMasivo.loading=!1,t.$store.commit(b.a,{expression:" al subir el archivo de "+t.archivoMasivo.tipo+". ",error:a})});case 7:case"end":return a.stop()}},a,t)}))()},cargarArchivo:function(t){switch(this.archivoMasivo.index=t,console.log("index",t),t){case 2:this.archivoMasivo.label="Archivo de procedimientos",this.archivoMasivo.tipo="procedimientos",this.archivoMasivo.ruta="importcups";break;case 3:this.archivoMasivo.label="Archivo de medicamentos",this.archivoMasivo.tipo="medicamentos",this.archivoMasivo.ruta="importcums";break;case 4:this.archivoMasivo.label="Archivo de otros bienes y servicios",this.archivoMasivo.tipo="otros bienes y servicios",this.archivoMasivo.ruta="importotros"}this.archivoMasivo.visible=!0},reloadSection:function(t){switch(t){case 2:this.$refs["dataComponent"+t][0].reloadAll();break;case 3:case 4:this.$refs["dataComponent"+t][0].$refs[3===t?"tablaMedicamentos":"tablaOtros"].reloadPage();break;default:this.getRegistro(this.planCobertura.id)}},submit:function(){var t=this;return u()(v.a.mark(function a(){var o,i;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("llegando"),a.next=3,t.$refs.dataComponent0[0].validate();case 3:if(!a.sent){a.next=8;break}t.loading=!0,o=t.planCobertura.id?"editar":"crear",i="editar"===o?t.axios.put("contratos/"+t.planCobertura.id,t.planCobertura):t.axios.post("contratos",t.planCobertura),i.then(function(a){console.log("el respose del contrato",a),t.planCobertura=a.data.data,t.planCoberturaOriginal=a.data.data,t.$store.commit(h.J,{item:{},estado:"reload",key:t.parametros.key}),t.$store.commit("PLAN_COBERTURA_RELOAD_ITEM",{item:JSON.parse(r()(a.data.data)),estado:o,key:t.parametros.key}),t.$store.commit(b.b,{msg:"Los datos del plan de cobertura se han guardado correctamente. ",color:"success"}),t.loading=!1}).catch(function(a){t.$store.commit(b.a,{expression:" al guardar los datos del plan de cobertura. ",error:a}),t.loading=!1});case 8:case"end":return a.stop()}},a,t)}))()},getRegistro:function(t){var a=this;this.loading=!0,this.axios.get("contratos/"+t).then(function(t){""!==t.data&&(console.log("el plan de cobertura",t),t.data.data.actaInicio="Registrado"!==t.data.data.estado,a.planCoberturaOriginal=JSON.parse(r()(t.data.data)),a.planCobertura=t.data.data,a.loading=!1)}).catch(function(t){a.$store.commit(b.a,{expression:" al traer el plan de cobertura. ",error:t})})},refresh:function(){this.refreshArchivoMasivo(),this.planCoberturaOriginal=JSON.parse(r()(this.makePlanCobertura)),this.planCobertura=JSON.parse(r()(this.makePlanCobertura)),this.$validator.reset(),this.$refs.dataComponent0&&this.$refs.dataComponent0[0]&&this.$refs.dataComponent0[0].reset()},refreshArchivoMasivo:function(){this.archivoMasivo=JSON.parse(r()(this.makeArchivoMasivo)),this.$refs.archivoMasivo&&this.$refs.archivoMasivo.reset()}}}},2236:function(t,a,o){var i=o(2237);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(456)("35b8408c",i,!0,{})},2237:function(t,a,o){a=t.exports=o(455)(!0),a.push([t.i,".content-list-p0 .v-list[data-v-23c62794]{padding:0!important}","",{version:3,sources:["/home/capresoca/projects/Capresoca-Frontend/src/components/misional/redservicios/planesCobertura/RegistroPlanCobertura.vue"],names:[],mappings:"AACA,0CACE,mBAAsB,CACvB",file:"RegistroPlanCobertura.vue",sourcesContent:["\n.content-list-p0 .v-list[data-v-23c62794]{\n  padding: 0 !important;\n}\n"],sourceRoot:""}])},2262:function(t,a,o){"use strict";var i=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("v-container",{staticClass:"pa-0 ma-0",attrs:{fluid:"","grid-list-md":""}},[o("v-slide-x-reverse-transition",{attrs:{mode:"out-in"}},[t.floatMenu?o("v-speed-dial",{key:"btn1",staticClass:"ml-1",attrs:{left:"",direction:"bottom","open-on-hover":"",fixed:""},model:{value:t.fabMenu,callback:function(a){t.fabMenu=a},expression:"fabMenu"}},[o("v-tooltip",{attrs:{slot:"activator",right:""},slot:"activator"},[o("v-btn",{staticClass:"mt-1",attrs:{slot:"activator",color:"blue darken-2",dark:"",fab:""},on:{click:function(a){t.floatMenu=!1}},slot:"activator",model:{value:t.fabMenu,callback:function(a){t.fabMenu=a},expression:"fabMenu"}},[o("v-icon",[t._v("vertical_split")])],1),t._v(" "),o("span",[t._v("Activar menú vertical")])],1),t._v(" "),t._l(t.items,function(a,i){return t.window!==i?o("v-tooltip",{key:i,attrs:{right:""}},[o("v-btn",{class:t.window===i?"elevation-5":"",attrs:{slot:"activator",fab:"",dark:"",small:"",color:a.props.avatarColor},on:{click:function(a){t.window=i}},slot:"activator"},[o("v-icon",[t._v(t._s(a.props.icon))])],1),t._v(" "),o("span",[t._v(t._s(a.props.title))])],1):t._e()})],2):t._e()],1),t._v(" "),o("v-toolbar",{attrs:{dense:!t.planCoberturaOriginal.id}},[t.planCoberturaOriginal.id&&!t.floatMenu?o("v-tooltip",{staticClass:"mr-2",attrs:{top:""}},[o("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(a){t.floatMenu=!0}},slot:"activator"},[o("v-icon",{attrs:{color:"accent"}},[t._v("group_work")])],1),t._v(" "),o("span",[t._v("activar menú flotante")])],1):t._e(),t._v(" "),o("v-icon",[t._v("wifi_tethering")]),t._v(" "),t.planCoberturaOriginal.id?o("v-list-tile",[o("v-list-tile-content",[o("v-list-tile-title",{domProps:{innerHTML:t._s(t.planCoberturaOriginal.nombre)}}),t._v(" "),t.planCoberturaOriginal.contrato.entidad?o("v-list-tile-sub-title",{domProps:{innerHTML:t._s(t.planCoberturaOriginal.contrato.entidad.tercero.nombre_completo)}}):t._e()],1)],1):o("v-toolbar-title",[t._v("Nuevo plan de cobertura")]),t._v(" "),[o("v-spacer"),t._v(" "),o("span",{staticClass:"pt-1 text-xs-right"},[o("span",{staticClass:"title text-capitalize"},[t._v("Contrato")]),t._v(" "),o("p",{staticClass:"mb-0 caption"},[t._v(t._s(t.planCoberturaOriginal.contrato&&t.planCoberturaOriginal.contrato.estado))])]),t._v(" "),o("v-chip",{attrs:{label:"",color:"white","text-color":"red",dark:"",absolute:"",right:"",top:""}},[o("span",{staticClass:"subheading"},[t._v("N°")]),t._v(" \n        "),o("span",{staticClass:"subheading",domProps:{textContent:t._s(t.planCoberturaOriginal.contrato&&t.planCoberturaOriginal.contrato.numero_contrato?t.planCoberturaOriginal.contrato.numero_contrato:"00")}})])]],2),t._v(" "),o("loading",{model:{value:t.loading,callback:function(a){t.loading=a},expression:"loading"}}),t._v(" "),o("v-layout",{attrs:{row:"",wrap:""}},[o("v-slide-x-reverse-transition",[t.planCoberturaOriginal.id&&!t.floatMenu?o("v-flex",{attrs:{sm12:"",md3:""}},[o("v-card",{staticClass:"content-list-p0"},[o("v-list",{attrs:{"two-line":""}},[t._l(t.items,function(a,i){return[o("v-list-tile",{key:"list"+i,class:t.window===i?"grey lighten-2":"",on:{click:function(a){t.window=i}}},[o("v-list-tile-avatar",{attrs:{color:a.props.avatarColor}},[o("v-icon",{attrs:{dark:""}},[t._v(t._s(a.props.icon))])],1),t._v(" "),o("v-list-tile-content",[o("v-list-tile-title",[t._v("\n                    "+t._s(a.props.title)+"\n                  ")]),t._v(" "),o("v-list-tile-sub-title",{domProps:{innerHTML:t._s(a.props.subTitle)}})],1)],1),t._v(" "),o("v-divider",{attrs:{inset:""}})]})],2)],1)],1):t._e()],1),t._v(" "),o("v-flex",{attrs:{md9:t.planCoberturaOriginal.id&&!t.floatMenu}},[o("v-window",{staticClass:"elevation-1",attrs:{vertical:""},model:{value:t.window,callback:function(a){t.window=a},expression:"window"}},t._l(t.items,function(a,i){return o("v-window-item",{key:i,attrs:{lazy:""}},[o("v-card",{staticClass:"content-list-p0 pt-0",attrs:{flat:""}},[t.planCoberturaOriginal.id?o("v-list",{attrs:{"two-line":""}},[[o("v-list-tile",[o("v-list-tile-avatar",{attrs:{color:a.props.avatarColor}},[o("v-icon",{attrs:{dark:""}},[t._v(t._s(a.props.icon))])],1),t._v(" "),o("v-list-tile-content",[o("v-list-tile-title",[t._v("\n                      "+t._s(a.props.title)+"\n                    ")]),t._v(" "),o("v-list-tile-sub-title",{domProps:{innerHTML:t._s(a.props.subTitle)}})],1),t._v(" "),i>1&&i<5&&!t.planCoberturaOriginal.actaInicio?o("v-list-tile-action",{staticStyle:{width:"120px !important"}},[o("v-layout",{attrs:{"align-center":"","justify-space-around":"",row:"","fill-height":""}},[o("v-tooltip",{attrs:{left:""}},[o("v-btn",{attrs:{slot:"activator",icon:"",large:""},on:{click:function(a){return t.reloadSection(i)}},slot:"activator"},[o("v-icon",{attrs:{color:"primary",large:""}},[t._v("\n                            cached\n                          ")])],1),t._v(" "),o("span",[t._v("Recargar sección")])],1),t._v(" "),o("v-divider",{attrs:{vertical:""}}),t._v(" "),o("v-tooltip",{attrs:{left:""}},[o("v-btn",{attrs:{slot:"activator",icon:"",href:t.axios.defaults.baseURL+"/../files/Plantilla_importacion_"+(2===i?"cups":3===i?"cums":"otros")+"_contrato.xlsx"},slot:"activator"},[o("v-icon",{attrs:{color:"blue-grey"}},[t._v("archive")])],1),t._v(" "),o("span",[t._v("Descargar plantilla")])],1),t._v(" "),o("v-tooltip",{attrs:{left:""}},[o("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(a){return t.cargarArchivo(i)}},slot:"activator"},[o("v-icon",{attrs:{color:"blue-grey"}},[t._v("publish")])],1),t._v(" "),o("span",[t._v("Carga masiva")])],1)],1)],1):o("v-list-tile-action",[o("v-tooltip",{attrs:{left:""}},[o("v-btn",{attrs:{slot:"activator",icon:"",large:""},on:{click:function(a){return t.reloadSection(i)}},slot:"activator"},[o("v-icon",{attrs:{color:"primary",large:""}},[t._v("\n                          cached\n                        ")])],1),t._v(" "),o("span",[t._v("Recargar sección")])],1)],1)],1),t._v(" "),o("v-spacer"),t._v(" "),o("v-divider")]],2):t._e(),t._v(" "),o("v-card-text",[o(a.component,{ref:"dataComponent"+i,refInFor:!0,tag:"component",attrs:{contrato:t.parametros.contrato},on:{clean:t.refresh},model:{value:t.planCobertura,callback:function(a){t.planCobertura=a},expression:"planCobertura"}})],1),t._v(" "),0===i?[o("v-divider"),t._v(" "),t.planCoberturaOriginal.actaInicio?t._e():o("v-card-actions",[o("v-btn",{attrs:{flat:""},on:{click:function(a){return a.stopPropagation(),t.refresh(a)}}},[t._v("Limpiar")]),t._v(" "),o("v-spacer"),t._v(" "),o("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(a){return a.stopPropagation(),t.submit(a)}}},[t._v("Registrar")])],1)]:t._e()],2)],1)}),1)],1)],1),t._v(" "),o("v-dialog",{attrs:{persistent:"","max-width":"700px"},model:{value:t.archivoMasivo.visible,callback:function(a){t.$set(t.archivoMasivo,"visible",a)},expression:"archivoMasivo.visible"}},[o("v-card",[o("v-toolbar",{attrs:{dense:""}},[o("v-toolbar-title",[o("v-icon",[t._v("publish")]),t._v("\n          Cargar archivo\n        ")],1)],1),t._v(" "),o("v-container",{attrs:{"grid-list-md":""}},[o("v-layout",{attrs:{wrap:""}},[o("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[t.archivoMasivo.visible?o("input-file",{ref:"archivoMasivo",attrs:{label:t.archivoMasivo.label,required:"",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",hint:"Extenciones aceptadas: xls, xlsx","prepend-icon":"description",clearable:""},model:{value:t.archivoMasivo.archivo,callback:function(a){t.$set(t.archivoMasivo,"archivo",a)},expression:"archivoMasivo.archivo"}}):t._e()],1),t._v(" "),o("v-slide-y-reverse-transition",{attrs:{mode:"out-in"}},[this.archivoMasivo.invalido.items.length?o("v-flex",{attrs:{xs12:"",sm12:"",md12:""}},[o("v-card",[o("v-toolbar",{staticClass:"elevation-0",attrs:{dense:""}},[o("v-toolbar-title",[o("v-icon",[t._v("label_off")]),t._v("\n                    Registros invalidos\n                  ")],1)],1),t._v(" "),o("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.archivoMasivo.invalido.headers,items:t.archivoMasivo.invalido.items,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(a){return[o("tr",t._l(a.item,function(a,i){return o("td",{key:"registro"+i,staticStyle:{height:"10px !important"}},[t._v("\n                        "+t._s(a)+"\n                      ")])}),0)]}}],null,!1,1702274602)})],1)],1):t._e()],1)],1)],1),t._v(" "),o("v-divider"),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{disabled:t.archivoMasivo.loading},on:{click:function(a){t.archivoMasivo.visible=!1}}},[t._v("Cerrar")]),t._v(" "),o("v-spacer"),t._v(" "),o("v-btn",{staticClass:"white--text",attrs:{loading:t.archivoMasivo.loading,disabled:t.archivoMasivo.loading,color:"blue darken-1"},on:{click:t.submitArchivo}},[t._v("\n          Subir archivo\n          "),o("v-icon",{attrs:{right:"",dark:""}},[t._v("cloud_upload")])],1)],1)],1)],1)],1)},r=[],e={render:i,staticRenderFns:r};a.a=e},674:function(t,a,o){"use strict";function i(t){o(2236)}Object.defineProperty(a,"__esModule",{value:!0});var r=o(1229),e=o(2262),n=o(1),s=i,l=n(r.a,e.a,!1,s,"data-v-23c62794",null);a.default=l.exports}});
//# sourceMappingURL=92.83552fcebf5e2189ad8b.js.map